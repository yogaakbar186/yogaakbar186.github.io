// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
/*
 Sortable 1.8.4 - MIT | git://github.com/SortableJS/Sortable.git */
require({cache:{"widgets/Bookmark/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/html dojox/html/entities jimu/utils ./ItemNode libs/storejs/store jimu/LayerInfos/LayerInfos".split(" "),function(F,B,v,y,u,p,z,C){var x={_uID:0,getUID:function(){return x._uID++},findBookMark:function(m,h){var d=-1,f=null;B.some(h,function(c,w){if(parseInt(c._uID,10)===parseInt(m._uID,10))return d=w,f=c,!0},this);return-1!==d?{bookmark:f,idx:d}:null},findBookMarkByUID:function(m,h){var d=-1,f=
null;B.some(h,function(c,w){if(parseInt(c._uID,10)===parseInt(m,10))return d=w,f=c,!0},this);return-1!==d?{bookmark:f,idx:d}:null},findNextBookMarkByIdx:function(m,h){var d=null;m+1<=h.length-1&&(d=h[m+1]);return d},findBookMarkByNameAndExtent:function(m,h){var d=-1,f=null;B.some(h,function(c,w){if(c.name===m.name&&c.extent&&m.extent&&c.extent.xmax===m.extent.xmax&&c.extent.xmin===m.extent.xmin&&c.extent.ymax===m.extent.ymax&&c.extent.ymin===m.extent.ymin)return d=w,f=c,!0},this);return-1!==d?{bookmark:f,
idx:d}:null},isBookmarksDataEmpty:function(m){return Array.isArray(m)&&0===m.length?!0:!1},empty:function(m,h){var d=m;B.forEach(m,function(f){f&&f.itemNode&&f.itemNode.destroy()},this);m=[];m=d;h&&v.empty(h)},createBookMarkNode:function(m,h,d,f,c){if(m.thumbnail||"undefined"!==typeof m.thumbnail&&""!==m.thumbnail){var w=m.thumbnail;m.thumbnail&&m.thumbnail.url&&(w=m.thumbnail.url);d=u.processUrlInWidgetConfig(w,d)}else d=u.processUrlInWidgetConfig("images/thumbnail_default.png",d);w=x.getUID();m._uID=
w;return new p({dataId:w,img:d,label:m.displayName||m.name,display:f,nls:h,a11y:c})},cloneBookmarksDataWithOutDom:function(m){var h=[];if("undefined"===typeof m)return h;m.forEach(F.hitch(this,function(d){d.itemNode&&d.itemNode.domNode&&(d=F.clone(d),delete d.itemNode,h.push(d))}));return h},readBookmarksInWebmap:function(m){var h=[];if(!m.itemInfo||!m.itemInfo.itemData||!m.itemInfo.itemData.bookmarks)return h;B.forEach(m.itemInfo.itemData.bookmarks,function(d){d=F.mixin({},d);d.isInWebmap=!0;d.name=
y.decode(d.name);h.push(d)},this);return h},filterBookmarkFromTarget:function(m,h){for(var d=[],f=0,c=m.length;f<c;f++){var w=m[f];x.findBookmarkByNameOrExtent(w,h)||d.push(w)}return d},findBookmarkByNameOrExtent:function(m,h){var d=-1,f=null;B.some(h,function(c,w){if((c.displayName||c.name)===(m.displayName||m.name)||c.extent&&m.extent&&c.extent.xmax===m.extent.xmax&&c.extent.xmin===m.extent.xmin&&c.extent.ymax===m.extent.ymax&&c.extent.ymin===m.extent.ymin)return d=w,f=c,!0},this);return-1!==d?
{bookmark:f,idx:d}:null},filter:function(m,h){h.forEach(function(d){"undefined"!==typeof m&&""!==m?-1!==(d.displayName||d.name).indexOf(m)?p.show(d):p.hide(d):p.show(d)})},getKeysKey:function(){return this.appConfig.map["3D"]?this.name+".3D":this.name+".2D"},getAutoRenameBeforeAdd:function(m,h,d){var f=0,c=new RegExp(/\((\d+)\){1}$/g);B.forEach(h,function(w){w&&"undefined"!==typeof w.name&&-1!==w.name.indexOf(m)&&("undefined"===typeof d||!0===d&&m.length===w.name.length)&&(w=c.exec(w.displayName),
null===w&&0===f?f=1:w&&"undefined"!==typeof w[1]&&w[1]>=f&&(f=parseInt(w[1],10)+1))});return 0===f?m:m+"("+f+")"},processDuplicateName:function(m){for(var h=[],d={},f=m.length-1;0<=f;f--){var c=m[f];if(!c||"undefined"===typeof c.name)return;var w=c.name;w in d?d[w]++:d[w]=0;if(0<d[w]){var G=w+"("+d[w]+")";G in d?(d[G]++,d[w]++):d[G]=0;c.displayName=0<d[G]?w+"("+d[w]+")":G;c._autoRename=!0}else c.displayName=w;h.push(c)}m=h},toogleCheckboxChecked:function(m){m&&m.setValue&&m.setValue(!m.checked)},
setCheckboxWithoutEvent:function(m,h){m&&m.check&&m.uncheck&&(!0===h?m.check(!0):m.uncheck(!0))},layerInfosRestoreState:function(m,h){var d=C.getInstanceSync(),f={};if(h&&m){for(var c in h)if(h.hasOwnProperty(c)){m=h[c];var w=!1;w="undefined"===typeof m.visible?m.selected:m.visible;f[c]={visible:w}}d.restoreState({layerOptions:f})}},getlayerInfos:function(){var m={},h=C.getInstanceSync();h&&h.traversal&&h.traversal(F.hitch(this,function(d){m[d.id]={visible:d.isVisible()}}));return m},isWithLayerInfos:function(m){return m.layerOptions&&
!1!==m.isSaveLayers?!0:!1},stringifyBookmarks:function(m){var h=[];B.forEach(m,function(d){d=F.mixin({},d);d.itemNode&&delete d.itemNode;h.push(d)},this);return h},parseBookmarks:function(m){return F.clone(m)},getKey:function(m){return"Bookmark.2D."+encodeURIComponent(u.getAppIdFromUrl())+"."+m},isConfigBefore5_3:function(m){return"undefined"===typeof m.syncMode||!0===m.needToUpdateFlag?!0:!1},getUpdateCacheKey:function(m){return"bookmark_cache_updated_"+encodeURIComponent(x.getKey(m))},setUpdateCacheKey:function(m){z.set(x.getUpdateCacheKey(m),
!0)},isCacheKeyUpdatedy:function(m){return z.get(x.getUpdateCacheKey(m))},setDefaultConfigForUpdate:function(m){m.needToUpdateFlag=!0;m.layout={cards:!0,list:!1,defaultMode:"cards"};m.editable=!0;Array.isArray(m.bookmarks2D)&&0<m.bookmarks2D.length?m.syncMode={webmap:!1,custom:!0}:m.syncMode={webmap:!0,custom:!0}},completeUpdateConfig:function(m){m.needToUpdateFlag&&delete m.needToUpdateFlag},updateBookmarks:function(m){for(var h=0;h<m.length;h++)"undefined"===typeof m[h]&&(m.splice(h,1),h--);var d=
RegExp("/widgets/Bookmark/images/thumbnail_default.png$");B.forEach(m,function(f){"undefined"===typeof f.isSaveExtent&&(f.isSaveExtent=!0);f.thumbnail&&d.test(f.thumbnail)&&delete f.thumbnail},this)},getLayoutRecorderKey:function(){return"bookMarkLayout_"+encodeURIComponent(u.getAppIdFromUrl())},cleanLayoutRecorder:function(m){z.remove(x.getLayoutRecorderKey(m))},setLastLayout:function(m){z.set(x.getLayoutRecorderKey(),m)},getLastLayout:function(){return z.get(x.getLayoutRecorderKey())},oldBookmarksBackup:'[{"displayName":"Greater Manchester or Greater Lincolnshire HAHAHAHA","name":"Greater Manchester or Greater Lincolnshire HAHAHAHA","extent":{"type":"extent","xmin":8997982.70263581,"ymin":2110475.6293307655,"xmax":14672667.682525788,"ymax":6024051.4775307495,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"Peterborough and Cambridgeshire HEHEHEHEHEH","name":"Peterborough and Cambridgeshire HEHEHEHEHEH","extent":{"type":"extent","xmin":9055621.33977054,"ymin":445965.34674161975,"xmax":14730306.319660518,"ymax":4359541.194941604,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"mentougou biejing china","name":"mentougou biejing china","extent":{"type":"extent","xmin":9502343.119353313,"ymin":3151483.465165457,"xmax":15177028.09924329,"ymax":7065059.313365442,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"\u51e4\u51f0\u7f6e\u5730\u4e09\u5143\u6865\u5317\u4eac\u4e2d\u56fd\u4e16\u754c\u592a\u9633\u7cfb\u5b87\u5b99","name":"\u51e4\u51f0\u7f6e\u5730\u4e09\u5143\u6865\u5317\u4eac\u4e2d\u56fd\u4e16\u754c\u592a\u9633\u7cfb\u5b87\u5b99","extent":{"type":"extent","xmin":-22698739.91955998,"ymin":-13654303.392799985,"xmax":22698739.91955998,"ymax":17654303.39279999,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"\u77ed\u4e2d\u6587","name":"\u77ed\u4e2d\u6587","extent":{"type":"extent","xmin":-22698739.91955998,"ymin":-13654303.392799985,"xmax":22698739.91955998,"ymax":17654303.39279999,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"short","name":"short","extent":{"type":"extent","xmin":-22698739.91955998,"ymin":-13654303.392799985,"xmax":22698739.91955998,"ymax":17654303.39279999,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"\u4e2d\u6587 English","name":"\u4e2d\u6587 English","extent":{"type":"extent","xmin":-22698739.91955998,"ymin":-13654303.392799985,"xmax":22698739.91955998,"ymax":17654303.39279999,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"Underneath the icons","name":"Underneath the icons","extent":{"type":"extent","xmin":-22698739.91955998,"ymin":-13654303.392799985,"xmax":22698739.91955998,"ymax":17654303.39279999,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"\u4e2d\u6587\u4e2d\u6587 \u5475\u5475","name":"\u4e2d\u6587\u4e2d\u6587 \u5475\u5475","extent":{"type":"extent","xmin":-22698739.91955998,"ymin":-13654303.392799985,"xmax":22698739.91955998,"ymax":17654303.39279999,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false},{"displayName":"eee RTL","name":"eee RTL","extent":{"type":"extent","xmin":-22698739.91955998,"ymin":-13654303.392799985,"xmax":22698739.91955998,"ymax":17654303.39279999,"spatialReference":{"wkid":102100}},"thumbnail":"","isInWebmap":false}]',
_testUpdateOldConfig:function(){return{bookmarks2D:[{extent:{spatialReference:{wkid:102100},xmax:-1656069.6628128502,xmin:-1.0861390956860503E7,ymax:1.510258315961978E7,ymin:-1119447.7364922247},name:"bm1",isInWebmap:!0,displayName:"bm1"},{extent:{spatialReference:{wkid:102100},xmax:-1656069.6628128502,xmin:-1.0861390956860503E7,ymax:1.510258315961978E7,ymin:-1119447.7364922247},name:"bm1",isInWebmap:!0,displayName:"bm1(1)"},{extent:{spatialReference:{wkid:102100},xmax:-3197863.7584074493,xmin:-1.3112899816301128E7,
ymax:1.1466459916526379E7,ymin:-4859686.568575533},name:"bm2",isInWebmap:!0,displayName:"bm2"},{extent:{spatialReference:{wkid:102100},xmax:-3767577.3201611056,xmin:-1.430429896767071E7,ymax:1.5120033300894285E7,ymin:-4622246.062418217},name:"Untitled",isInWebmap:!0,displayName:"Untitled"},{extent:{spatialReference:{wkid:102100},xmax:-4334684.982862408,xmin:-1.6556089386187213E7,ymax:1.6750523655935397E7,ymin:-5666212.383958025},name:"Untitled",isInWebmap:!0,displayName:"Untitled(1)"}],bookmarks3D:[],
flyTime:3E3}},_testSetOldCache:function(m){var h=[];B.forEach(m,function(d){var f="Bookmark.2D."+d.displayName;h.push(f);d=F.mixin({},d);d.itemNode&&delete d.itemNode;d._uID&&delete d._uID;try{z.set(f,d)}catch(c){alert("store error\x3d\x3d\x3e")}},this);z.set("Bookmark.2D",h)},_testSetOldCacheBookmark:function(){return JSON.parse('[{"extent":{"spatialReference":{"wkid":102100,"latestWkid":3857},"xmax":-8273877.24778316,"xmin":-14295892.084200885,"ymax":6466269.8495007465,"ymin":2983187.344602761},"name":"bm1","isInWebmap":true,"displayName":"bm1"},{"extent":{"spatialReference":{"wkid":102100,"latestWkid":3857},"xmax":-8004818.908219411,"xmin":-11015826.326428276,"ymax":5527011.645932751,"ymin":3785470.393483758},"name":"bm1","isInWebmap":true,"displayName":"bm1(1)"},{"extent":{"spatialReference":{"wkid":102100,"latestWkid":3857},"xmax":-12874774.854323175,"xmin":-13627526.708875552,"ymax":4655629.523482032,"ymin":4220244.210369689},"name":"bm2","isInWebmap":true,"displayName":"bm2"},{"extent":{"spatialReference":{"wkid":102100,"latestWkid":3857},"xmax":-11618761.605541585,"xmin":-14629769.023750449,"ymax":6691911.956998556,"ymin":4950370.704549563},"name":"bm3","isInWebmap":true,"displayName":"bm3"},{"extent":{"spatialReference":{"wkid":102100,"latestWkid":3857},"xmax":-4317189.3003047705,"xmin":-16361218.973140221,"ymax":10449906.504800193,"ymin":3483741.495004222},"name":"bm4","isInWebmap":true,"displayName":"bm4"},{"name":"add-inRT-1","displayName":"add-inRT-1","extent":{"xmin":-14714155.502977258,"ymin":2694561.125798012,"xmax":-7855613.8290067855,"ymax":6754896.068305495,"spatialReference":{"wkid":102100,"latestWkid":3857}}},{"name":"add-inRT-2","displayName":"add-inRT-2","extent":{"xmin":-14714155.502977258,"ymin":2694561.125798012,"xmax":-7855613.8290067855,"ymax":6754896.068305495,"spatialReference":{"wkid":102100,"latestWkid":3857}}}]')}};
return x})},"widgets/Bookmark/ItemNode":function(){define("dojo/Evented dojo/_base/declare dojo/_base/lang dojo/_base/html dijit/a11yclick jimu/BaseWidget dijit/_WidgetsInTemplateMixin ./a11y/ItemNode dojo/on dojo/query jimu/utils dojo/text!./ItemNode.html dojo/mouse dijit/form/ValidationTextBox".split(" "),function(F,B,v,y,u,p,z,C,x,m,h,d){var f={};f=B([p,z,F],{templateString:d,isSelected:!1,postMixInProperties:function(){this.nls=v.mixin(this.nls,window.jimuNls.common)},postCreate:function(){y.setAttr(this.domNode,
"data-id",h.sanitizeHTML(this.dataId));this.img&&y.setAttr(this.thumbnail,"src",this.img);this.nls&&(y.setAttr(this.deleteBtn,"title",this.nls.deleteBtnTip),y.setAttr(this.editBtn,"title",this.nls.editBtnTip),y.setAttr(this.changeImgBtn,"title",this.nls.changeThumbnailTip),y.setAttr(this.renameBtn,"title",this.nls.editBtnTip),y.setAttr(this.thumbnail,"title",this.nls.dragReorderTip),y.setAttr(this.layerInfosIcon,"title",this.nls.withVisibility));this.display&&(!1===this.display.selectedBtn&&y.addClass(this.selectedBtn,
"hide"),!1===this.display.editBtn&&y.addClass(this.editBtn,"hide"),!1===this.display.deleteBtn&&y.addClass(this.deleteBtn,"hide"),!1===this.display.renameBtn&&y.addClass(this.renameBtn,"hide"),!0===this.display.selectedBtn&&y.removeClass(this.selectedBtn,"hide"),!0===this.display.changeImgBtn&&y.removeClass(this.changeImgBtn,"hide"),!0===this.display.layerInfosIcon&&(y.removeClass(this.layerInfosIcon,"hide"),y.addClass(this.nodeBox,"with-layer-visibility")));this.a11y_display();this.nodeLabel.setValue(this.label);
this._updateLabelTooltips(this.label);this.own(x(this.selectedBtn,u,v.hitch(this,this.onSelected)));this.own(x(this.deleteBtn,u,v.hitch(this,this.onDelete)));this.own(x(this.editBtn,u,v.hitch(this,this.onEdit)));this.own(x(this.changeImgBtn,u,v.hitch(this,this.onChangeImg)));this.own(x(this.renameBtn,u,v.hitch(this,this.onRenameClick)));this.own(x(this.nodeBox,u,v.hitch(this,this.onNodeBoxClick)));this.own(x(this.dragMasker,"click",v.hitch(this,this.onNodeBoxClick)));!0===this.display.enableEditLabel?
(this.own(x(this.nodeLabel,u,v.hitch(this,this.onLabelClick))),this.own(x(this.nodeLabel,"change",v.hitch(this,this.onLabelChange))),this.own(x(this.nodeLabel,"blur",v.hitch(this,this.onLabelBlur)))):this.nodeLabel.setDisabled(!0);this.own(x(this.nodeLabel,"contextmenu",v.hitch(this,function(c){c.preventDefault()})));this.own(x(this.nodeBox,"contextmenu",v.hitch(this,function(c){c.preventDefault()})));this.a11y_initEvents()},onClick:function(){m(".jimu-img-node",this.getParent().domNode).removeClass("jimu-state-selected");
m(this.domNode).addClass("jimu-state-selected");this.emit("click")},onNodeBoxClick:function(c){c&&c.stopPropagation&&c.preventDefault&&(c.stopPropagation(),c.preventDefault());this.emit("thumbnail-click")},onLabelClick:function(c){c&&c.stopPropagation&&c.preventDefault&&(c.stopPropagation(),c.preventDefault());this.emit("label-click")},onLabelChange:function(c){this._updateLabelTooltips(c)},onLabelBlur:function(c){c&&c.stopPropagation&&c.preventDefault&&(c.stopPropagation(),c.preventDefault());c=
this.nodeLabel.get("value");this._updateLabelTooltips(c);this.emit("label-blur")},onSelected:function(c){c&&c.stopPropagation&&c.preventDefault&&(c.stopPropagation(),c.preventDefault());y.hasClass(this.domNode,"selected")?(y.removeClass(this.domNode,"selected"),this.isSelected=!1,!1!==c&&this.emit("unselected")):(y.addClass(this.domNode,"selected"),this.isSelected=!0,!1!==c&&this.emit("selected"))},onDelete:function(c){c&&c.stopPropagation&&c.preventDefault&&(c.stopPropagation(),c.preventDefault());
this.emit("delete")},onEdit:function(c){c&&c.stopPropagation&&c.preventDefault&&(c.stopPropagation(),c.preventDefault());this.emit("edit")},onChangeImg:function(c){c&&c.stopPropagation&&c.preventDefault&&(c.stopPropagation(),c.preventDefault());this.emit("change-img")},changeImg:function(c){y.setAttr(this.thumbnail,"src",c)},onRenameClick:function(c){c&&c.stopPropagation&&c.preventDefault&&(c.stopPropagation(),c.preventDefault());this.emit("rename")},highLight:function(){m(".jimu-img-node",this.getParent().domNode).removeClass("jimu-state-selected");
m(this.domNode).addClass("jimu-state-selected")},startup:function(){this.inherited(arguments)},destroy:function(){this.inherited(arguments);y.destroy(this.domNode)},_updateLabelTooltips:function(c){c&&(y.setAttr(this.nodeLabel,"title",c),this.dragMasker&&y.setAttr(this.dragMasker,"title",c),this.a11y_updateItemLabel(c))}});f.addFloatLeading=function(c){c.itemNode&&c.itemNode.domNode&&(m(".selected-btn",c.itemNode.domNode).forEach(function(w){y.addClass(w,"jimu-float-leading")}),m(".node-box",c.itemNode.domNode).forEach(function(w){y.addClass(w,
"jimu-float-leading")}),m(".node-label",c.itemNode.domNode).forEach(function(w){y.addClass(w,"jimu-float-leading")}),m(".close-btn",c.itemNode.domNode).forEach(function(w){y.addClass(w,"jimu-float-leading")}))};f.removeFloatLeading=function(c){c.itemNode&&c.itemNode.domNode&&(m(".selected-btn",c.itemNode.domNode).forEach(function(w){y.removeClass(w,"jimu-float-leading")}),m(".node-box",c.itemNode.domNode).forEach(function(w){y.removeClass(w,"jimu-float-leading")}),m(".node-label",c.itemNode.domNode).forEach(function(w){y.removeClass(w,
"jimu-float-leading")}),m(".close-btn",c.itemNode.domNode).forEach(function(w){y.removeClass(w,"jimu-float-leading")}))};f.toggleEditable=function(c){c.itemNode&&c.itemNode.nodeLabel&&(c.itemNode.nodeLabel.disabled?f.enableEditable(c):f.disableEditable(c))};f.disableEditable=function(){};f.enableEditable=function(){};f.focusLabel=function(c){c.itemNode&&c.itemNode.nodeLabel&&(c.itemNode.nodeLabel.focus(),c.itemNode.domNode&&y.addClass(c.itemNode.domNode,"a11y_hover"))};f.focusItem=function(c){c&&
c.itemNode&&c.itemNode.domNode&&c.itemNode.domNode.focus()};f.unSelected=function(c){c.itemNode&&c.itemNode&&(c=c.itemNode,y.removeClass(c.domNode,"selected"),c.isSelected=!1)};f.show=function(c){c&&c.itemNode&&(c=c.itemNode,y.removeClass(c.domNode,"hide"),c.isShow=!0)};f.hide=function(c){c&&c.itemNode&&(c=c.itemNode,y.addClass(c.domNode,"hide"),c.isShow=!1)};f.extend(C);return f})},"widgets/Bookmark/a11y/ItemNode":function(){define(["dojo/_base/lang","dojo/on","dojo/_base/html","dojo/keys"],function(F,
B,v,y){return{a11y_removeTabindex:function(u){v.removeAttr(u,"tabindex")},a11y_setTabindex:function(u,p){v.setAttr(u,"tabindex",p||0)},a11y_display:function(){this.a11y&&(!1===this.a11y.selectedBtn&&this.a11y_removeTabindex(this.selectedBtn),!1===this.a11y.editBtn&&this.a11y_removeTabindex(this.editBtn),!1===this.a11y.deleteBtn&&this.a11y_removeTabindex(this.deleteBtn),!1===this.a11y.renameBtn&&this.a11y_removeTabindex(this.renameBtn),!1===this.a11y.changeImgBtn&&this.a11y_removeTabindex(this.changeImgBtn))},
a11y_updateItemLabel:function(u){v.setAttr(this.domNode,"aria-label",u)},a11y_initEvents:function(){this.own(B(this.domNode,"keydown",F.hitch(this,function(u){var p=v.hasClass(u.target,"jimu-img-node");if(u.keyCode===y.ENTER&&p)this.onNodeBoxClick();this.a11y_checkFocus()})));this.own(B(this.domNode,"mouseout",F.hitch(this,function(){v.removeClass(this.domNode,"a11y_hover")})));this.own(B(this.domNode,"focus",F.hitch(this,function(){v.addClass(this.domNode,"a11y_hover")})))},a11y_focusToLabel:function(u){setTimeout(function(){u.focus()},
0)},a11y_focusToBtns:function(u){setTimeout(function(){u.focus()},0)},a11y_checkFocus:function(){setTimeout(F.hitch(this,function(){v.isDescendant(document.activeElement,this.domNode)||v.removeClass(this.domNode,"a11y_hover")}),50)}}})},"widgets/Bookmark/setting/Layout":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html jimu/BaseWidgetSetting dijit/_WidgetsInTemplateMixin dojo/on dojo/text!./Layout.html ../utils".split(" "),function(F,B,v,y,u,p,z,C){return F([y,u],{templateString:z,
startup:function(){this.own(p(this.layoutCards_checkBox,"change",B.hitch(this,function(){this._fixLayoutModeByCheckBoxChanged("cards");this._keepLayoutSelected(this.layoutCards_checkBox)})));this.own(p(this.layoutList_checkBox,"change",B.hitch(this,function(){this._fixLayoutModeByCheckBoxChanged("list");this._keepLayoutSelected(this.layoutList_checkBox)})));this.own(p(this.layoutCards,"click",B.hitch(this,function(){C.toogleCheckboxChecked(this.layoutCards_checkBox);this._keepLayoutSelected(this.layoutCards_checkBox)})));
this.own(p(this.layoutList,"click",B.hitch(this,function(){C.toogleCheckboxChecked(this.layoutList_checkBox);this._keepLayoutSelected(this.layoutList_checkBox)})));this.own(p(this.layoutCards,"mouseover",B.hitch(this,function(){this._isCardAndListChecked()&&v.removeClass(this.cardsDefaultSetting,"transparent")})));this.own(p(this.layoutCards,"mouseout",B.hitch(this,function(){"list"===this.config.layout.defaultMode&&v.addClass(this.cardsDefaultSetting,"transparent")})));this.own(p(this.layoutList,
"mouseover",B.hitch(this,function(){this._isCardAndListChecked()&&v.removeClass(this.listDefaultSetting,"transparent")})));this.own(p(this.layoutList,"mouseout",B.hitch(this,function(){"cards"===this.config.layout.defaultMode&&v.addClass(this.listDefaultSetting,"transparent")})));this.own(p(this.cardsDefaultSetting,"click",B.hitch(this,function(x){x&&x.stopPropagation&&x.preventDefault&&(x.stopPropagation(),x.preventDefault());this._whetherToggleDefaultLayout("cards")&&(this.config.layout.defaultMode=
"cards",this._setDefault("cards"))})));this.own(p(this.listDefaultSetting,"click",B.hitch(this,function(x){x&&x.stopPropagation&&x.preventDefault&&(x.stopPropagation(),x.preventDefault());this._whetherToggleDefaultLayout("list")&&(this.config.layout.defaultMode="list",this._setDefault("list"))})));this.inherited(arguments)},setConfig:function(x){this.config.layout=x.layout;this.config.layout&&(!0===this.config.layout.cards&&this.layoutCards_checkBox.setValue(!0),!0===this.config.layout.list&&this.layoutList_checkBox.setValue(!0));
this._setDefault(this.config.layout.defaultMode)},getConfig:function(){this.config.layout.cards=!0===this.layoutCards_checkBox.checked?!0:!1;this.config.layout.list=!0===this.layoutList_checkBox.checked?!0:!1;return this.config.layout},_keepLayoutSelected:function(x){!1===this.layoutCards_checkBox.checked&&!1===this.layoutList_checkBox.checked&&C.toogleCheckboxChecked(x)},_setDefault:function(x){var m="";m="cards"===x?"list":"cards";v.removeClass(this[x+"DefaultSetting"],"transparent");var h=this[x+
"_makeAsDefault"];h&&v.addClass(h,"hide");(h=this[x+"_default"])&&v.removeClass(h,"hide");v.addClass(this[m+"DefaultSetting"],"transparent");(h=this[m+"_makeAsDefault"])&&v.removeClass(h,"hide");(h=this[m+"_default"])&&v.addClass(h,"hide");this._isCardAndListChecked()||(v.addClass(this[x+"DefaultSetting"],"transparent"),v.addClass(this[m+"DefaultSetting"],"transparent"))},_whetherToggleDefaultLayout:function(x){var m="cards"===x?this.layoutCards_checkBox:this.layoutList_checkBox;return("cards"===
x?"list":"cards")===this.config.layout.defaultMode&&!0===m.checked?!0:!1},_fixLayoutModeByCheckBoxChanged:function(x){this._isCardAndListChecked()?"list"===this.config.layout.defaultMode?v.removeClass(this.listDefaultSetting,"transparent"):v.removeClass(this.cardsDefaultSetting,"transparent"):(v.addClass(this.listDefaultSetting,"transparent"),v.addClass(this.cardsDefaultSetting,"transparent"));"cards"===x?!1===this.layoutCards_checkBox.checked&&!0===this.layoutList_checkBox.checked&&"cards"===this.config.layout.defaultMode&&
(this.config.layout.defaultMode="list",this._setDefault("list")):!1===this.layoutList_checkBox.checked&&!0===this.layoutCards_checkBox.checked&&"list"===this.config.layout.defaultMode&&(this.config.layout.defaultMode="cards",this._setDefault("cards"))},_isCardAndListChecked:function(){return!0===this.layoutCards_checkBox.getValue()&&!0===this.layoutList_checkBox.getValue()?!0:!1}})})},"widgets/Bookmark/setting/Sync":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/keys jimu/BaseWidgetSetting dijit/_WidgetsInTemplateMixin dojo/on dojo/_base/html jimu/dijit/Popup jimu/dijit/Message ./Edit ./Import dojo/text!./Sync.html ../utils jimu/dijit/CheckBox libs/Sortable".split(" "),
function(F,B,v,y,u,p,z,C,x,m,h,d,f,c,w,G){return F([u,p],{templateString:f,map:null,edit:null,popup:null,popupState:"",editIndex:null,startup:function(){this.webMapBookmarksNodes=G.create(this.webMapBookMarkerContainer,{sort:!1,disabled:!0,animation:100});this.sortableBookMarkerNodes=G.create(this.custombookMarkerContainer,{handle:".drag-masker",sort:!0,disabled:!1,animation:100,onSort:B.hitch(this,function(){this.saveBookMarkersBySortable()})});this.isSyncWebmapCheckBox=new w({label:this.nls.alwaysSync,
checked:!1},this.isSyncWebmapNode);this.isSyncWebmapCheckBox.startup();this.isSyncCustomCheckBox=new w({label:this.nls.configCustom,checked:!1},this.isSyncCustomNode);this.isSyncCustomCheckBox.startup();this.own(z(this.isSyncWebmapCheckBox,"change",B.hitch(this,function(){!0===this.isSyncWebmapCheckBox.getValue()?this.showWebmapBookmarks():this.hideWebmapBookmarks()})));this.own(z(this.isSyncCustomCheckBox,"change",B.hitch(this,function(){!0===this.isSyncCustomCheckBox.getValue()?this.showCustomBookmarks():
this.hideCustomBookmarks()})));this.own(z(this.createNewBtn,"click",B.hitch(this,function(){this.onAddBookmarkClick()})));this.hideWebmapBookmarks();this.hideCustomBookmarks();this.inherited(arguments)},showWebmapBookmarks:function(){C.removeClass(this.webMapBookMarkerContainer,"hide");c.empty(this._bookmarksInWebmap);this._bookmarksInWebmap=c.readBookmarksInWebmap(this.map);this._bookmarksInWebmap=this.displayBookmarks({bookmarks:this._bookmarksInWebmap,syncMode:"webmap",bookmarksContainerNode:this.webMapBookMarkerContainer})},
hideWebmapBookmarks:function(){C.addClass(this.webMapBookMarkerContainer,"hide")},showCustomBookmarks:function(){C.removeClass(this.customBtns,"hide");C.removeClass(this.custombookMarkerContainer,"hide");"undefined"===typeof this._customBookmarks&&(c.empty(this._customBookmarks),this._customBookmarks=this.config.bookmarks2D,this._customBookmarks=this.displayBookmarks({bookmarks:this._customBookmarks,syncMode:"custom",bookmarksContainerNode:this.custombookMarkerContainer}))},hideCustomBookmarks:function(){C.addClass(this.customBtns,
"hide");C.addClass(this.custombookMarkerContainer,"hide")},destroy:function(){this.webMapBookmarksNodes&&this.webMapBookmarksNodes.destroy&&(this.webMapBookmarksNodes.destroy(),this.webMapBookmarksNodes=null);this.sortableBookMarkerNodes&&(this.sortableBookMarkerNodes.destroy(),this.sortableBookMarkerNodes=null);v.forEach(this._bookmarksInWebmap,function(M){M.itemNode&&M.itemNode.destroy()},this);this._bookmarksInWebmap=[];v.forEach(this._customBookmarks,function(M){M.itemNode&&M.itemNode.destroy()},
this);this._customBookmarks=[];this.inherited(arguments)},setConfig:function(M){this.config=M;!0===this.config.syncMode.webmap&&this.isSyncWebmapCheckBox.setValue(!0);!0===this.config.syncMode.custom&&this.isSyncCustomCheckBox.setValue(!0)},getConfig:function(){!0===this.isSyncWebmapCheckBox.getValue()?this.config.syncMode.webmap=!0:this.config.syncMode.webmap=!1;!0===this.isSyncCustomCheckBox.getValue()?this.config.syncMode.custom=!0:this.config.syncMode.custom=!1;var M=[];M=M.concat(this._customBookmarks);
return{syncMode:this.config.syncMode,bookmarks:M}},displayBookmarks:function(M){var A=M.bookmarks,O=M.syncMode,D=M.bookmarksContainerNode||this.custombookMarkerContainer;c.empty(A);var J={};J="webmap"===O?{editBtn:!1,selectedBtn:!1,deleteBtn:!1,renameBtn:!1}:{editBtn:!0,selectedBtn:!1,deleteBtn:!0,renameBtn:!1};v.forEach(A,function(N){if(N){J.layerInfosIcon=c.isWithLayerInfos(N);var S=c.createBookMarkNode(N,this.nls,this.folderUrl,J);N.itemNode=S;this.own(z(S,"thumbnail-click",B.hitch(this,B.partial(this._onBookmarkClick,
N))));this.own(z(S,"delete",B.hitch(this,B.partial(this._onBookmarkDeleteImmediately,N))));this.own(z(S,"edit",B.hitch(this,B.partial(this._onBookmarkEdit,N))))}},this);A.forEach(B.hitch(this,function(N){N&&N.itemNode&&N.itemNode.domNode&&C.place(N.itemNode.domNode,D,"last")}));return A},saveBookMarkersBySortable:function(){for(var M=this.sortableBookMarkerNodes.toArray(),A=[],O=0,D=M.length;O<D;O++){var J=c.findBookMarkByUID(M[O],this._customBookmarks);J&&A.push(J.bookmark)}this._customBookmarks=
A;this.displayBookmarks({bookmarks:this._customBookmarks,syncMode:"custom"})},getBookmarkByName:function(M){for(var A=this._customBookmarks.length,O=0;O<A;O++)if(this._customBookmarks[O].displayName===M)return this.editIndex=O,this._customBookmarks[O]},onAddBookmarkClick:function(){this.popupState="ADD";this._openEdit(this.nls.addBookmark,{name:"",thumbnail:"",extent:this.map.extent.toJson()})},_onBookmarkEdit:function(M){this.popupState="EDIT";this._openEdit(this.nls.edit,M)},_onBookmarkDeleteImmediately:function(M){(M=
c.findBookMark(M,this._customBookmarks))&&M.bookmark&&(M.bookmark.itemNode&&M.bookmark.itemNode.destroy(),this._customBookmarks.splice(M.idx,1))},_openEdit:function(M,A){this.edit=new h({nls:this.nls,folderUrl:this.folderUrl,portalUrl:this.appConfig.map.portalUrl,itemId:this.appConfig.map.itemId,mapOptions:this.appConfig.map.mapOptions});this.edit.setConfig(A||{});this.popup=new x({titleLabel:M,autoHeight:!0,content:this.edit,container:"main-page",width:600,buttons:[{label:this.nls.ok,key:y.ENTER,
disable:!0,onClick:B.hitch(this,"_onEditOk",A)},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],key:y.ESCAPE}],onClose:B.hitch(this,"_onEditClose")});C.addClass(this.popup.domNode,"widget-setting-popup");this.edit.startup()},_onEditOk:function(M){var A=this.edit.getConfig(),O=null;if(A.name&&A.extent){"EDIT"===this.popupState&&(M=B.mixin(M,A));M=A.name;var D=c.getAutoRenameBeforeAdd(M,this._customBookmarks,!0);A.name=M;A.displayName=D;"ADD"===this.popupState?(this.addBookmark(A),O=!0):"EDIT"===
this.popupState&&(this.saveBookMarkersBySortable(),O=!0);O?(this.popup.close(),this.popupState="",this.editIndex=null,O=!1):(A=v.mark(O.repeatFields,B.hitch(this,function(J){return J&&J.name})),new m({message:this.nls[O.errorCode]+A.toString()}))}else new m({message:this.nls.warning})},_onEditClose:function(){this.popup=this.edit=null},addBookmark:function(M){var A=c.createBookMarkNode(M,this.nls,this.folderUrl,{editBtn:!0,changeImgBtn:!1});M.itemNode=A;this._customBookmarks.unshift(M);M.itemNode&&
M.itemNode.domNode&&C.place(M.itemNode.domNode,this.custombookMarkerContainer,"last");this.saveBookMarkersBySortable()},onImport:function(){this.importWidget=new d({nls:this.nls,map:this.map,folderUrl:this.folderUrl});this.popup=new x({titleLabel:this.nls.importTitle,autoHeight:!0,content:this.importWidget,container:"main-page",width:640,buttons:[{label:this.nls.ok,key:y.ENTER,disable:!0,onClick:B.hitch(this,"_onImportOk")},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],key:y.ESCAPE}],onClose:B.hitch(this,
"_onImportClose")});C.addClass(this.popup.domNode,"widget-setting-popup");this.importWidget.startup()},_onImportOk:function(){var M=this.importWidget.getConfig();v.forEach(M,function(A){this.addBookmark(A)},this);this.popup.close()},_onImportClose:function(){this.importWidget.destroy()}})})},"widgets/Bookmark/setting/Edit":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting esri/geometry/Extent jimu/dijit/ImageChooser ./ExtentAndLayersChooser jimu/dijit/LayerChooserFromMapLite jimu/utils ../utils dojo/text!./Edit.html jimu/dijit/CheckBox".split(" "),
function(F,B,v,y,u,p,z,C,x,m,h,d,f,c){return F([p,u],{baseClass:"jimu-Bookmark-Edit",ImageChooser:null,templateString:f,extent:{},portalUrl:null,itemId:null,isInWebmap:!1,mapOptions:null,layerOptions:null,postCreate:function(){this.inherited(arguments);this.imageChooser=new C({cropImage:!0,defaultSelfSrc:this.folderUrl+"images/thumbnail_default.png",showSelfImg:!0,format:[C.GIF,C.JPEG,C.PNG],goldenWidth:100,goldenHeight:60});this.saveLayers=new c({label:this.nls.savelayers,checked:!1},this.saveLayers);
this.own(y(this.saveLayers,"change",B.hitch(this,"_changeSetBtnStyle")));this.own(y(this.displayName,"change",B.hitch(this,"_onNameChange")));this.own(y(this.displayName,"keyUp",B.hitch(this,"_onNameChange")));v.addClass(this.imageChooser.domNode,"img-chooser");v.place(this.imageChooser.domNode,this.imageChooserBase,"replace")},startup:function(){this.displayName&&this.displayName.focusNode&&this.displayName.focusNode.focus&&this.displayName.focusNode.focus();this.inherited(arguments)},_changeSetBtnStyle:function(){this.saveLayers.getValue()?
v.removeClass(this.layerChooserContainer,"hide"):v.addClass(this.layerChooserContainer,"hide")},setConfig:function(w){w.displayName&&this.displayName.set("value",w.displayName);if(w.thumbnail){var G=h.processUrlInWidgetConfig(w.thumbnail,this.folderUrl);this.imageChooser.setDefaultSelfSrc(G)}w.isInWebmap&&(this.isInWebmap=!0);"undefined"===typeof w.isSaveExtent&&(w.isSaveExtent=!0);"undefined"===typeof w.isSaveLayers&&(w.isSaveLayers=!1);d.setCheckboxWithoutEvent(this.saveLayers,w.isSaveLayers);this._changeSetBtnStyle();
w.layerOptions&&(this.layerOptions=w.layerOptions);this.extentChooser||(G={portalUrl:this.portalUrl,itemId:this.itemId},this.config&&this.config.bookmark.extent&&(G.initExtent=new z(w.extent)),this.mapOptions&&this.mapOptions.lods&&(G.lods=this.mapOptions.lods),this.extentChooser=new x(G,this.extentChooserNode),this.extentChooser.createMap().then(B.hitch(this,function(M){this.layersChooser=new m({map:M,layerState:this.layerOptions,layerStateController:m.layerVisibilityStateController},this.layerChooser)})))},
getConfig:function(){var w=this.layersChooser.getState();return{displayName:this.displayName.get("value"),name:this.displayName.get("value"),extent:this.extentChooser.getExtent(),thumbnail:this.imageChooser.imageData,isInWebmap:this.isInWebmap,isSaveLayers:this.saveLayers.getValue(),layerOptions:w}},_onNameChange:function(){this._checkRequiredField()},_onExtentChange:function(w){this.currentExtent=w},_checkRequiredField:function(){this.displayName.get("value")?this.popup&&this.popup.enableButton(0):
this.popup&&this.popup.disableButton(0)}})})},"widgets/Bookmark/setting/ExtentAndLayersChooser":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/Deferred dijit/_WidgetBase dojo/Evented esri/geometry/Extent jimu/portalUrlUtils esri/dijit/Search jimu/dijit/LoadingShelter jimu/utils".split(" "),function(F,B,v,y,u,p,z,C,x,m,h,d){return F([p,z],{baseClass:"bookmark-extent-chooser",declaredClass:"bookmark.ExtentChooser",portalUrl:null,itemId:null,initExtent:null,bingMapsKey:"",
geometryServiceURL:null,shelter:null,postCreate:function(){this.inherited(arguments);!this.geometryServiceURL&&esriConfig.defaults.geometryService&&(this.geometryServiceURL=esriConfig.defaults.geometryService.url);this.geometryServiceURL||(this.geometryServiceURL=d.getServices().geometryService);this.shelter=new h({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this.shelter.show();this.mapNode=v.create("div",{style:{width:"100%",height:"100%"}},this.domNode);this.search=v.create("div",
{style:{position:"absolute",right:0,top:0}},this.mapNode);this.portalUrl&&this.itemId&&(this.portalUrl=x.getStandardPortalUrl(this.portalUrl))},createMap:function(){var f=new u,c={geometryServiceURL:this.geometryServiceURL,bingMapsKey:this.bingMapsKey};this.initExtent&&("esri.geometry.Extent"!==this.initExtent.declaredClass&&(this.initExtent=new C(this.initExtent)),c.mapOptions={extent:this.initExtent});this.lods&&("object"===typeof c.mapOptions?c.mapOptions.lods=this.lods:c.mapOptions={lods:this.lods});
d.createWebMap(this.portalUrl,this.itemId,this.mapNode,c).then(B.hitch(this,function(w){this.map=w.map;this.map.itemInfo=w.itemInfo;this.own(y(this.map,"extent-change",B.hitch(this,function(G){this.onExtentChange(G.extent)})));w=new m({map:this.map,enableLabel:!1,enableHighlight:!1,enableInfoWindow:!1},this.search);w.startup();this.own(y(w,"search-results",B.hitch(this,function(G){if(G&&G.results&&G.results[0]&&G.results[0][0]&&G.results[0][0].extent)this.onExtentChange(G.results[0][0].extent)})));
if(this.initExtent)this.onExtentChange(this.initExtent);else this.onExtentChange(this.map.extent);this.shelter.hide();this.emit("map-load",this.map);f.resolve(this.map)}),B.hitch(this,function(w){f.resolve(null);console.error(w)}));return f},getExtent:function(){return this.map&&this.map.extent},setExtent:function(f){if(this.map)return this.map.setExtent(f);var c=new u;setTimeout(B.hitch(this,function(){c.reject("map is null.")}),0);return c},restoreToDefaultWebMapExtent:function(){d.restoreToDefaultWebMapExtent(this.map,
this.map.webMapResponse,this.geometryServiceURL)},onExtentChange:function(f){this.emit("extent-change",f)}})})},"esri/dijit/Search":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Evented dojo/Deferred dojo/keys dojo/on dojo/query dojo/uacss dojo/regexp dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-style dojo/dom-construct dojo/date/locale dojo/i18n!../nls/jsapi dojo/text!./Search/templates/Search.html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_FocusMixin dijit/a11yclick dijit/focus ../lang ../InfoTemplate ../kernel ../SpatialReference ../graphic ../promiseList ../symbols/PictureMarkerSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/TextSymbol ../symbols/Font ../geometry/Point ../geometry/Extent ../geometry/normalizeUtils ../geometry/scaleUtils ../tasks/locator ../tasks/query ../Color ../styles/basic".split(" "),
function(F,B,v,y,u,p,z,C,x,m,h,d,f,c,w,G,M,A,O,D,J,N,S,aa,E,ka,T,ca,Y,ta,Ka,Pa,Ua,Ya,ua,na,Ea,sa,k,r,R,U,ba,Fa){function la(a,e){a&&e&&(a._layer=e,a._sourceLayer=e)}B=B([D,J,N,u],{declaredClass:"esri.dijit.Search",templateString:O,reHostedFS:/https?:\/\/services.*\.arcgis\.com/i,constructor:function(a,e){this.css={searchGroup:"searchGroup",searchInput:"searchInput",searchInputGroup:"searchInputGroup",searchBtn:"searchBtn",searchSubmit:"searchSubmit",searchIcon:"searchIcon esri-icon-search",searchButtonText:"searchButtonText",
searchToggle:"searchToggle",searchToggleIcon:"searchIcon esri-icon-down-arrow",searchMenu:"searchMenu",searchMenuHeader:"menuHeader",searchClear:"searchClear",searchClearIcon:"searchIcon esri-icon-close searchClose",searchSpinner:"searchIcon esri-icon-loading-indicator searchSpinner",searchSourceName:"sourceName",suggestionsMenu:"suggestionsMenu",sourcesMenu:"sourcesMenu",activeSource:"active",hasValue:"hasValue",hasButtonMode:"hasButtonMode",hasMultipleSources:"hasMultipleSources",showSuggestions:"showSuggestions",
showSources:"showSources",showNoResults:"showNoResults",searchLoading:"searchLoading",latLonHeader:"searchLatLongHeader",searchMoreResults:"moreResults",searchMoreResultsList:"resultsList",searchMoreResultsHeader:"moreHeader",searchMoreResultsItem:"moreItem",searchMoreResultsListHeader:"popupHeader",searchShowMoreResults:"showMoreResults",searchNoResultsMenu:"noResultsMenu",searchNoResultsBody:"noResultsBody",searchNoResultsHeader:"noResultsHeader",searchNoValueIcon:"noValueIcon esri-icon-notice-triangle",
searchNoValueText:"noValueText",searchNoResultsText:"noResultsText",searchExpandContainer:"searchExpandContainer",searchAnimateContainer:"searchAnimate",searchExpanded:"searchExpanded",searchCollapsed:"searchCollapsed",searchClearFloat:"searchClearFloat"};this._allIndex="all";this._objectIdIdentifier="_objectId";this._deferreds=[];this._sourceNames=[];this.defaultSource={locator:new R("//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"),singleLineFieldName:"SingleLine",outFields:["Addr_type",
"Match_addr","StAddr","City"],name:A.widgets.Search.main.esriLocatorName,localSearchOptions:{minScale:3E5,distance:5E4},placeholder:A.widgets.Search.main.placeholder,highlightSymbol:(new Ka(F.toUrl("./Search/images/search-pointer.png"),36,36)).setOffset(9,18)};this.options={map:null,theme:"arcgisSearch",visible:!0,value:"",allPlaceholder:"",sources:[this.defaultSource],activeSourceIndex:0,suggestionDelay:350,enableSourcesMenu:!0,enableSuggestionsMenu:!0,enableInfoWindow:!0,showInfoWindowOnSelect:!0,
enableSuggestions:!0,enableButtonMode:!1,autoNavigate:!0,autoSelect:!0,addLayersFromMap:!1,zoomScale:1E3,graphicsLayer:null,enableHighlight:!0,highlightGraphic:null,enableLabel:!1,labelSymbol:(new ua).setColor(new ba([181,56,46,.9])).setFont(new na("14px",na.STYLE_NORMAL,na.VARIANT_NORMAL,na.WEIGHT_BOLD,"Arial")),labelGraphic:null,infoTemplate:new ka(A.widgets.Search.main.searchResult,'\x3cdiv class\x3d"${searchTheme}"\x3e\x3cdiv id\x3d"${searchMoreResultsId}" class\x3d"${searchMoreResults}"\x3e\x3cdiv class\x3d"${searchMoreResultsItem}"\x3e${searchResult}\x3c/div\x3e\x3cdiv\x3e${searchMoreResultsHtml}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'),
searchResults:null,suggestResults:null,selectedResult:null,magicKey:null,selectedFeatureId:null,expanded:!1,maxLength:128,maxResults:6,maxSuggestions:6,locationToAddressDistance:1500,minCharacters:3,enableSearchingAll:!0};a=v.mixin({},this.options,a);this.set(a);this._updateActiveSource();this._i18n=A;this._defaultSR=new ca(4326);this.domNode=e},startup:function(){this.inherited(arguments);this.sources||(this.sources=[]);this._mapLoaded().then(v.hitch(this,this._init))},postCreate:function(){var a=
this;this.inherited(arguments);this._moreResultsId=this.id+"_more_results";this.own(C(this.submitNode,S,v.hitch(this,this._searchButton)));this.own(C(this.sourcesBtnNode,S,v.hitch(this,this._toggleSourcesMenu)));this.own(C(this.inputNode,S,v.hitch(this,this._inputClick)));this.own(C(this.clearNode,S,v.hitch(this,this._clearButton)));this.own(C(this.formNode,"submit",v.hitch(this,function(e){e.preventDefault();this._cancelSuggest();this.search()})));this.own(C(this.inputNode,"keyup",v.hitch(this,function(e){this._inputKey(e)})));
this.own(C(this.sourcesBtnNode,"keyup",v.hitch(this,function(e){this._sourceBtnKey(e)})));this.own(C(this.suggestionsNode,"li:click, li:keyup",function(e){a._suggestionsEvent(e,this)}));this.own(C(this.sourcesNode,"li:click, li:keyup",function(e){a._sourcesEvent(e,this)}));this.own(C(this.inputNode,"input, paste",v.hitch(this,function(){this._suggestDelay()})));this.map&&this.map.infoWindow&&this.map.infoWindow.domNode&&this.enableInfoWindow&&(this.own(C(this.map.infoWindow.domNode,"#"+this._moreResultsId+
"_show:click",v.hitch(this,function(e){this._showMoreResultsClick(e)}))),this.own(C(this.map.infoWindow.domNode,"#"+this._moreResultsId+"_list li a:click",v.hitch(this,function(e){this._moreResultsClick(e)}))),this.own(C(this.map.infoWindow.domNode,"#"+this._moreResultsId+" [data-switch-coordinates]:click",v.hitch(this,function(e){this._switchCoordinatesClick(e)}))));this.value&&this._checkStatus();this._hideMenus();this._updateVisible();this._insertSources(this.sources);this._setPlaceholder(this.activeSourceIndex);
this._updateButtonMode(this.enableButtonMode);this.toggle(this.expanded)},destroy:function(){this.clear();G.empty(this.domNode);this.inherited(arguments)},clear:function(){this.clearGraphics();f.get(this.inputNode,"value")&&f.set(this.inputNode,"value","");this._changeAttrValue("value","");this.set("searchResults",null);this.set("suggestResults",null);this.set("selectedResult",null);this.set("magicKey",null);this.set("selectedFeatureId",null);c.remove(this.containerNode,this.css.hasValue);f.set(this.clearNode,
"title","");this._hideMenus();this._closePopup();this._hideLoading();this.emit("clear-search")},show:function(){w.set(this.domNode,"display","block")},hide:function(){w.set(this.domNode,"display","none")},expand:function(){this.enableButtonMode&&(c.add(this.containerNode,this.css.searchExpanded),c.remove(this.containerNode,this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!0))},collapse:function(){this.enableButtonMode&&(c.remove(this.containerNode,this.css.searchExpanded),c.add(this.containerNode,
this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!1))},toggle:function(a){this.enableButtonMode&&("undefined"===typeof a&&(a=!this.expanded),a?this.expand():this.collapse())},search:function(a){var e=new p;this._mapLoaded().then(v.hitch(this,function(){this._searchDeferred(a).then(v.hitch(this,function(l){var g=l.results;this.set("searchResults",g);0===l.numResults&&(this._noResults(l.value),this._showNoResultsMenu());this._hideLoading();this.emit("search-results",l);this._selectFirstResult(g,
l.activeSourceIndex);e.resolve(g)}),v.hitch(this,function(l){e.reject(l)}))}));return e.promise},suggest:function(a){var e=new p;this._mapLoaded().then(v.hitch(this,function(){this._suggestDeferred(a).then(v.hitch(this,function(l){if(l){var g=l.results;this.set("suggestResults",g);this._insertSuggestions(g,l.value);this.emit("suggest-results",l);e.resolve(g)}}),v.hitch(this,function(l){e.reject(l)}))}));return e.promise},select:function(a){var e=this._getDefaultSymbol(a),l=this.labelSymbol,g=this.sources,
t=this.activeSourceIndex,H=this.enableHighlight,W=this.enableLabel,ja=this.autoNavigate,da=this.showInfoWindowOnSelect,ha=this.enableInfoWindow,Q=this.infoTemplate,ia=a.feature?new Y(a.feature.toJson()):null,oa=ia?a.feature._sourceLayer:null;la(ia,oa);if(t===this._allIndex){var ra=this._getSourceIndexOfResult(a);if(null!==ra){var fa=g[ra];t=ra}}else fa=g[t];fa&&(fa.hasOwnProperty("highlightSymbol")&&(e=fa.highlightSymbol),fa.hasOwnProperty("labelSymbol")&&(l=fa.labelSymbol),fa.hasOwnProperty("enableHighlight")&&
(H=fa.enableHighlight),fa.hasOwnProperty("enableLabel")&&(W=fa.enableLabel),fa.hasOwnProperty("autoNavigate")&&(ja=fa.autoNavigate),fa.hasOwnProperty("showInfoWindowOnSelect")&&(da=fa.showInfoWindowOnSelect),fa.hasOwnProperty("enableInfoWindow")&&(ha=fa.enableInfoWindow),fa.hasOwnProperty("infoTemplate")?Q=fa.infoTemplate:fa.featureLayer&&fa.featureLayer.infoTemplate&&(Q=fa.featureLayer.infoTemplate));this._hideMenus();this._hideLoading();if(ia){g=this.highlightGraphic;var qa=this.graphicsLayer;ra=
this.labelGraphic;var Z=v.mixin({},ia.attributes,{searchTheme:this.theme,searchResult:this._searchResultHTML(a),searchMoreResults:this.css.searchMoreResults,searchMoreResultsItem:this.css.searchMoreResultsItem,searchMoreResultsId:this._moreResultsId,searchMoreResultsHtml:this._moreResultsHTML(a)}),ya=null;ha&&(ya=Q);ra?(ra.setGeometry(ia.geometry),ra.setAttributes(Z),ra.setSymbol(l),l&&"textsymbol"===l.type&&ra.symbol.setText(a.name)):(ra=new Y(ia.geometry,l,Z),la(ra,oa),l&&"textsymbol"===l.type&&
ra.symbol.setText(a.name),W&&(qa?qa.add(ra):this.map&&this.map.graphics&&this.map.graphics.add(ra)));g?(g.setGeometry(ia.geometry),g.setAttributes(Z),g.setInfoTemplate(ya),g.setSymbol(e)):(g=new Y(ia.geometry,e,Z,ya),la(g,oa),H&&(qa?qa.add(g):this.map&&this.map.graphics&&this.map.graphics.add(g)));g&&g.symbol&&"textsymbol"===g.symbol.type&&g.symbol.setText(a.name);this.map&&this.map.infoWindow&&ha&&da&&(this.map.infoWindow.setFeatures([g]),e=this._getPointFromGeometry(g.geometry),this.map.infoWindow.show(e));
this.map&&ja&&a&&a.hasOwnProperty("extent")&&"function"===typeof this.map.setExtent&&this.map.setExtent(a.extent,!0);this.set("highlightGraphic",g);this.set("labelGraphic",ra)}this.set("selectedResult",a);this.emit("select-result",{result:a,source:fa,sourceIndex:t})},focus:function(){aa.focus(this.inputNode)},blur:function(){this.inputNode.blur();aa.curNode&&aa.curNode.blur()},clearGraphics:function(){var a=this.highlightGraphic,e=this.graphicsLayer,l=this.labelGraphic;a&&(e?e.remove(a):this.map&&
this.map.graphics&&this.map.graphics.remove(a));l&&(e?e.remove(l):this.map&&this.map.graphics&&this.map.graphics.remove(l));this.set("labelGraphic",null);this.set("highlightGraphic",null)},_mapLoaded:function(){var a=new p;if(this.map)if(this.map.loaded)a.resolve();else C.once(this.map,"load",v.hitch(this,function(){a.resolve()}));else a.resolve();return a.promise},_init:function(){this._getMapLayers().then(v.hitch(this,function(){this.set("loaded",!0);this.emit("load")}))},_clearButton:function(){this.clear();
aa.focus(this.inputNode)},_error:function(a){return Error(this.declaredClass+" "+a)},_searchDeferred:function(a){var e=new p,l=this.value,g=this.activeSourceIndex;a&&a.hasOwnProperty("index")&&(g=a.index);this._showLoading();this._hideMenus();this._closePopup();this.clearGraphics();var t={magicKey:this.magicKey,text:l};a?"string"===typeof a?(t.text=a,a=this._searchQueries(t)):a="object"===typeof a&&a.hasOwnProperty("magicKey")?this._searchQueries(a):"object"===typeof a&&a.hasOwnProperty("geometry")?
this._searchQueries({geometry:a}):"object"===typeof a&&a.hasOwnProperty(this._objectIdIdentifier)?this._searchQueries(a):"object"===typeof a&&"point"===a.type?this._searchQueries({point:a}):a instanceof Array&&2===a.length?this._searchQueries({latlon:a}):this._searchQueries(t):a=this._searchQueries(t);a.always(v.hitch(this,function(H){H=this._formatResults(H,g,l);e.resolve(H)}));return e.promise},_suggestDeferred:function(a){var e=new p;this._deferreds.push(e);a||(a=this.value);var l=this.activeSourceIndex;
this._suggestQueries({text:a}).always(v.hitch(this,function(g){var t;if(g)for(var H=0;H<g.length;H++)g[H]&&(t=!0);t?(g=this._formatResults(g,l,a),e.resolve(g)):e.resolve()}));return e.promise},_getDefaultSymbol:function(a){var e;this.map&&(e=this.map.getBasemap());e||(e="topo");if(a&&a.feature&&a.feature.geometry)var l=a.feature.geometry.type;"polyline"===l?l="line":"circle"===l||"extent"===l?l="polygon":"multipoint"===l&&(l="point");if(l){if(a=Fa.getSchemes({theme:"default",basemap:e,geometryType:l}))var g=
a.primaryScheme;if(g){g.color&&g.hasOwnProperty("opacity")&&(g.color.a=g.opacity);var t=g;a=g.color;g=g.size;switch(l){case "point":var H=new Pa;H.setColor(a);H.setSize(null!==g?g:t.size);l=new Ua;l.setColor(t.outline.color);l.setWidth(t.outline.width);H.setOutline(l);break;case "line":H=new Ua;H.setColor(a);H.setWidth(null!==g?g:t.width);break;case "polygon":H=new Ya,H.setColor(a),l=new Ua,l.setColor(t.outline.color),l.setWidth(t.outline.width),H.setOutline(l)}t=H}}return t},_selectFirstResult:function(a,
e){if(this.autoSelect&&a){var l;e===this._allIndex?l=this._getFirstResult(a):a[e]&&a[e][0]&&(l=a[e][0]);l&&this.select(l)}},_getSourceIndexOfResult:function(a){var e=this.searchResults;if(e)for(var l in e)if(e[l]&&e[l].length)for(var g=0;g<e[l].length;g++)if(e[l][g]===a)return parseInt(l,10);return null},_getFirstResult:function(a){if(a)for(var e in a)if(a[e]&&a[e][0])return a[e][0];return!1},_onFocus:function(){this.map&&"function"===typeof this.map.disableKeyboardNavigation&&this.map.disableKeyboardNavigation();
this.emit("focus");this.inherited(arguments)},_onBlur:function(){this._hideMenus();this.map&&"function"===typeof this.map.enableKeyboardNavigation&&this.map.enableKeyboardNavigation();this.enableButtonMode&&this.loaded&&this.collapse();this.emit("blur");this.inherited(arguments)},_getMapLayers:function(){var a=new p;if(this.addLayersFromMap&&this.map){var e=[],l=this.map.graphicsLayerIds;if(l&&l.length){for(var g=0;g<l.length;g++){var t=this.map.getLayer(l[g]);t&&e.push(this._featureLayerLoaded(t))}ta(e).always(v.hitch(this,
function(H){for(var W,ja=this.sources,da=0;da<H.length;da++)H[da]&&H[da].loaded&&"Feature Layer"===H[da].type&&(ja.push({featureLayer:H[da],enableSuggestions:!0}),W=!0);W&&this.set("sources",ja);a.resolve()}))}else a.resolve()}else a.resolve();return a.promise},_switchCoordinatesClick:function(a){a.preventDefault();if(a=f.get(a.target,"data-switch-coordinates"))this._cancelSuggest(),this.set("value",a),this.search()},_moreResultsClick:function(a){a.preventDefault();var e=a.target;a=parseInt(f.get(e,
"data-source-index"),10);e=parseInt(f.get(e,"data-index"),10);var l=this.searchResults;l&&l[a]&&(a=l[a][e])&&this.select(a)},_showMoreResultsClick:function(a){a.preventDefault();if(a=d.byId(this._moreResultsId)){c.toggle(a,this.css.searchShowMoreResults);var e=d.byId(this._moreResultsId+"_show");e&&(c.contains(a,this.css.searchShowMoreResults)?f.set(e,"textContent",A.widgets.Search.main.hideMoreResults):f.set(e,"textContent",A.widgets.Search.main.showMoreResults))}},_featureLayerLoaded:function(a){var e=
new p;if(a.loaded)e.resolve(a);else if(a.loadError)e.reject(this._error("Layer failed to load."));else{var l=C.once(a,"load",v.hitch(this,function(){g.remove();e.resolve(a)}));var g=C.once(a,"error",v.hitch(this,function(){l.remove();e.reject(this._error("Layer could not be loaded."))}))}return e.promise},_getObjectSize:function(a){var e=0,l;for(l in a)a.hasOwnProperty(l)&&e++;return e},_sourcesEvent:function(a,e){var l=f.get(e,"data-index"),g=x("li",this.sourcesNode);e=y.indexOf(g,e);l!==this._allIndex&&
(l=parseInt(l,10));"click"===a.type||a.keyCode===z.ENTER?(this.set("activeSourceIndex",l),aa.focus(this.inputNode),this._hideSourcesMenu()):a.keyCode===z.UP_ARROW?(a.stopPropagation(),a.preventDefault(),a=e-1,0>a?aa.focus(this.sourcesBtnNode):aa.focus(g[a])):a.keyCode===z.DOWN_ARROW?(a.stopPropagation(),a.preventDefault(),a=e+1,a>=g.length?aa.focus(this.sourcesBtnNode):aa.focus(g[a])):a.keyCode===z.ESCAPE&&(this._hideSourcesMenu(),aa.focus(this.inputNode))},_suggestionsEvent:function(a,e){var l=f.get(e,
"data-source-index"),g=parseInt(f.get(e,"data-index"),10),t=x("li",this.suggestionsNode),H=this.sources;e=y.indexOf(t,e);l!==this._allIndex&&(l=parseInt(l,10));var W;this._clearQueryTimeout();"click"===a.type||a.keyCode===z.ENTER?((t=this.suggestResults)&&t[l]&&t[l][g]&&(W=t[l][g]),W&&(W.index=l,H[l].featureLayer?(l=H[l].featureLayer.objectIdField,W[this._objectIdIdentifier]=W.feature.attributes[l],this.set("value",this._getSuggestionName(W)),this.set("selectedFeatureId",W.feature.attributes[l])):
W.magicKey&&W.text&&(this.set("value",W.text),this.set("magicKey",W.magicKey)),this.search(W),aa.focus(this.inputNode))):a.keyCode===z.BACKSPACE||a.keyCode===z.DELETE?aa.focus(this.inputNode):a.keyCode===z.UP_ARROW?(a.stopPropagation(),a.preventDefault(),W=e-1,0>W?aa.focus(this.inputNode):aa.focus(t[W])):a.keyCode===z.DOWN_ARROW?(a.stopPropagation(),a.preventDefault(),W=e+1,W>=t.length?aa.focus(this.inputNode):aa.focus(t[W])):a.keyCode===z.ESCAPE&&(this._hideMenus(),aa.focus(this.inputNode))},_getResultName:function(a){var e;
a.hasOwnProperty("name")&&null!==a.name&&(e=a.name.toString());e||(e=A.widgets.Search.main.untitledResult);return e},_getSuggestionName:function(a){var e;a.hasOwnProperty("name")&&null!==a.name&&(e=a.name.toString());a=a.text||e;a||(a=A.widgets.Search.main.untitledResult);return a},_searchResultHTML:function(a){var e="";if(a.feature&&a.feature.attributes&&a.feature.attributes.Addr_type&&"LatLong"===a.feature.attributes.Addr_type){var l=a.name.split(" ");if(2===l.length){var g=l[0];var t=l[1]}t&&g?
(a=parseFloat(g),t=parseFloat(t),l=t+", "+a,e+='\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e',e+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+A.widgets.Search.main.lonlat+"\x3c/div\x3e",e=e+(a+", "+t)+'\x3c/div\x3e\x3cdiv class\x3d"'+(this.css.searchMoreResultsItem+'"\x3e'),a===t||90<a||-90>a||180<t||-180>t||(e+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+A.widgets.Search.main.reverseLonLatHeader+"\x3c/div\x3e",e+='\x3ca data-switch-coordinates\x3d"'+l+'" tabindex\x3d"0" href\x3d"#"\x3e'+
l+"\x3c/a\x3e\x3c/div\x3e")):e=a.name}else e=a.name;return e},_moreResultsHTML:function(a){var e="",l="",g=this.searchResults,t=this.sources,H=0;if(g){l+='\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e';l+='\x3ca href\x3d"#" id\x3d"'+this._moreResultsId+'_show"\x3e'+A.widgets.Search.main.showMoreResults+"\x3c/a\x3e";l=l+'\x3c/div\x3e\x3cdiv class\x3d"'+(this.css.searchMoreResultsList+'"\x3e');l+='\x3cdiv id\x3d"'+this._moreResultsId+'_list"\x3e';for(var W in g)if(g[W]){var ja=g[W].length;
if(ja){var da=1===ja&&g[W][0]===a;if(1<this._getObjectSize(g)&&!da){var ha=this._getSourceName(W);l+='\x3cdiv class\x3d"'+this.css.searchMoreResultsListHeader+'"\x3e'+ha+"\x3c/div\x3e"}if(ja&&!da){l+="\x3cul\x3e";ha=t[W].maxResults||this.maxResults;for(da=0;da<ja&&da<ha;++da)if(g[W][da]!==a){var Q=this._getResultName(g[W][da]);l+='\x3cli\x3e\x3ca tabindex\x3d"0" data-index\x3d"'+da+'" data-source-index\x3d"'+W+'" href\x3d"#"\x3e'+Q+"\x3c/a\x3e\x3c/li\x3e";H++}l+="\x3c/ul\x3e"}}}l+="\x3c/div\x3e\x3c/div\x3e"}H&&
(e+=l);return e},_validField:function(a,e){return a.getField(e)},_validFields:function(a,e){if(a&&e&&e.length){for(var l=0;l<e.length;l++)if(!this._validField(a,e[l]))return!1;return!0}return!1},_getCodedName:function(a,e){if(a&&a.length)for(var l=0,g=a.length;l<g;l++){var t=a[l];if(t.code===e)return t.name}},_getCodedValue:function(a,e,l){if(a&&a.length)for(var g=0,t=a.length;g<t;g++){var H=a[g],W=H.name,ja=e;l||(W=W.toLowerCase(),ja=ja.toLowerCase());if(W===ja)return H.code}return!1},_whereClause:function(a,
e,l,g,t){var H=null;if(a){var W="",ja=this.reHostedFS.test(e.url);ja&&this._containsNonLatinCharacter(a)&&(W="N");if(l&&l.length)for(var da=0,ha=l.length;da<ha;da++){var Q="";Q=a.replace(/'/g,"''");var ia=l[da],oa=e.getField(ia),ra=e.getDomain(ia);ra&&"codedValue"===ra.type&&(Q=this._getCodedValue(ra.codedValues,Q,g));!1!==Q&&(oa=oa.type,"esriFieldTypeString"===oa||"esriFieldTypeDate"===oa?g&&"search"===t?Q=ia+" \x3d "+W+"'"+Q+"'":(ia=ja?ia:"LOWER("+ia+")",Q=(ja?Q:Q.toLowerCase())+"%",Q=ia+" LIKE "+
W+"'"+Q+"'"):"esriFieldTypeOID"===oa||"esriFieldTypeSmallInteger"===oa||"esriFieldTypeInteger"===oa||"esriFieldTypeSingle"===oa||"esriFieldTypeDouble"===oa?(Q=parseFloat(Q),Q=isNaN(Q)?!1:ia+" \x3d "+Q):Q=ia+" \x3d "+Q,Q&&(H=H?H+" or ":"",H+=Q))}}return H},_suggest:function(a){a||(a={index:this.activeSourceIndex,text:this.value});var e=new p,l=a.index,g=this.sources[l],t=this.enableSuggestions;g.hasOwnProperty("enableSuggestions")&&(t=g.enableSuggestions);var H=0;if(a.hasOwnProperty("text")&&a.text){var W=
v.trim(a.text);H=a.text.length}a=g.minCharacters||this.minCharacters;if(t&&W&&H>=a&&this._supportsPagination(g)){var ja="";g.prefix&&(ja+=g.prefix);ja+=W;g.suffix&&(ja+=g.suffix);var da=this._defaultSR;this.map&&(da=this.map.spatialReference);t={};g.locator?(g.categories&&(t.categories=g.categories),g.locator.outSpatialReference=da,this.map&&g.localSearchOptions&&g.localSearchOptions.hasOwnProperty("distance")&&g.localSearchOptions.hasOwnProperty("minScale")&&(H=this._getScale(),!g.localSearchOptions.minScale||
H&&H<=parseFloat(g.localSearchOptions.minScale))&&(t.location=this.map.extent.getCenter(),t.distance=g.localSearchOptions.distance),t.text=ja,g.useMapExtent&&this.map&&this.map.extent&&(t.searchExtent=this.map.extent),g.searchExtent&&(t.searchExtent=g.searchExtent),t.maxSuggestions=g.maxSuggestions||this.maxSuggestions,g.sourceCountry&&(t.countryCode=g.sourceCountry),g.countryCode&&(t.countryCode=g.countryCode),g.locator.suggestLocations(t).then(v.hitch(this,function(ha){e.resolve(ha)}),v.hitch(this,
function(ha){ha||(ha=this._error("Locator suggestLocations could not be performed."));e.reject(ha)}))):g.featureLayer?this._featureLayerLoaded(g.featureLayer).then(v.hitch(this,function(){var ha=this._getDisplayField(g),Q=g.searchFields||[ha],ia=[];g.suggestionTemplate?g.suggestionTemplate.replace(/(?:\$\{([^}]+)\})/g,function(qa,Z){ia.push(Z)}):ia=[ha];-1===y.indexOf(ia,g.featureLayer.objectIdField)&&ia.push(g.featureLayer.objectIdField);ha=this._validField(g.featureLayer,ha);var oa=this._validFields(g.featureLayer,
ia),ra=this._validFields(g.featureLayer,Q);if(ha&&oa&&ra){ha=new U;g.hasOwnProperty("suggestQueryParams")&&v.mixin(ha,g.suggestQueryParams);ha.outSpatialReference=da;ha.returnGeometry=!1;ha.num=g.maxSuggestions||this.maxSuggestions;ha.outFields=ia;g.useMapExtent&&this.map&&this.map.extent&&(ha.geometry=this.map.extent);g.searchExtent&&(ha.geometry=g.searchExtent);if(Q=this._whereClause(ja,g.featureLayer,Q,g.exactMatch,"suggest")){ha.where=Q;var fa=!0}fa?g.featureLayer.queryFeatures(ha,v.hitch(this,
function(qa){var Z;(qa=qa.features)&&(Z=this._hydrateResults(qa,l,!0));e.resolve(Z)}),v.hitch(this,function(qa){qa||(qa=this._error("FeatureLayer queryFeatures errored with suggestions"));e.reject(qa)})):e.resolve()}else e.reject(this._error("Invalid FeatureLayer field"))})):e.reject(this._error("Invalid source"))}else e.resolve();return e.promise},_supportsPagination:function(a){var e;a.locator?e=!0:a.featureLayer&&a.featureLayer.advancedQueryCapabilities&&a.featureLayer.advancedQueryCapabilities.supportsPagination&&
(e=!0);return e},_suggestQueries:function(a){var e=this.sources,l=this.activeSourceIndex,g=[];if(l===this._allIndex)for(l=0;l<e.length;l++){var t=a;t.index=l;t=this._suggest(t);g.push(t)}else a.index=l,t=this._suggest(a),g.push(t);return ta(g)},_getPointFromGeometry:function(a){switch(a.type){case "extent":var e=a.getCenter();break;case "multipoint":e=a.getPoint(0);break;case "point":e=a;break;case "polygon":e=a.getCentroid();break;case "polyline":e=a.getPoint(0,0)}return e},_searchQueries:function(a){a.hasOwnProperty("index")||
(a.index=this.activeSourceIndex);var e=[];if(a.index===this._allIndex)for(var l=this.sources,g=0;g<l.length;g++){var t=a;t.index=g;t=this._search(t);e.push(t)}else a=this._search(a),e.push(a);return ta(e)},_searchButton:function(){this.enableButtonMode&&!this.expanded?(this.expand(),aa.focus(this.inputNode)):(this._cancelSuggest(),this.search())},_search:function(a){a||(a={text:this.value,magicKey:null,geometry:null,point:null,index:this.activeSourceIndex,latlon:null});this.selectedFeatureId&&(a.text=
null,a[this._objectIdIdentifier]=this.selectedFeatureId);var e,l=new p,g=a.index,t=this.sources[g],H;a.hasOwnProperty("text")&&a.text&&(H=v.trim(a.text));if(t){var W="";t.prefix&&!a.magicKey&&(W+=t.prefix);W+=H;t.suffix&&!a.magicKey&&(W+=t.suffix);var ja=this._defaultSR;this.map&&(ja=this.map.spatialReference);if(t.locator)if(a.hasOwnProperty("text")&&H){var da={};t.categories&&(da.categories=t.categories);t.locationType&&(da.locationType=t.locationType);ja&&(t.locator.outSpatialReference=ja);if(this.map&&
t.localSearchOptions&&t.localSearchOptions.hasOwnProperty("distance")&&t.localSearchOptions.hasOwnProperty("minScale")){var ha=this._getScale();if(!t.localSearchOptions.minScale||ha&&ha<=parseFloat(t.localSearchOptions.minScale))da.location=this.map.extent.getCenter(),da.distance=t.localSearchOptions.distance}da.address={};da.maxLocations=t.maxResults||this.maxResults;t.useMapExtent&&this.map&&this.map.extent&&(da.searchExtent=this.map.extent);t.searchExtent&&(da.searchExtent=t.searchExtent);t.sourceCountry&&
(da.countryCode=t.sourceCountry);t.countryCode&&(da.countryCode=t.countryCode);a.magicKey&&(da.magicKey=a.magicKey);t.singleLineFieldName?da.address[t.singleLineFieldName]=W:da.address["Single Line Input"]=W;t.outFields&&(da.outFields=t.outFields);t.locator.addressToLocations(da).then(v.hitch(this,function(Q){Q=this._hydrateResults(Q,g,!1);l.resolve(Q)}),v.hitch(this,function(Q){Q||(Q=this._error("Locator addressToLocations could not be performed"));l.reject(Q)}))}else a.geometry?(e=this._getPointFromGeometry(a.geometry.geometry))?
this._reverseGeocodePoint(g,e).then(function(Q){l.resolve(Q)},function(Q){l.reject(Q)}):l.reject(this._error("Invalid point to reverse geocode")):a.point?this._reverseGeocodePoint(g,a.point).then(function(Q){l.resolve(Q)},function(Q){l.reject(Q)}):a.latlon?(da=new Ea(a.latlon,this._defaultSR),this._reverseGeocodePoint(g,da).then(function(Q){l.resolve(Q)},function(Q){l.reject(Q)})):a.hasOwnProperty("text")&&!H?l.resolve([]):l.reject(this._error("Invalid query type for Locator"));else t.featureLayer?
this._featureLayerLoaded(t.featureLayer).then(v.hitch(this,function(){var Q=this._getDisplayField(t),ia=t.searchFields||[Q];Q=this._validField(t.featureLayer,Q);var oa=this._validFields(t.featureLayer,ia);if(Q&&oa){Q=new U;t.hasOwnProperty("searchQueryParams")&&v.mixin(Q,t.searchQueryParams);ja&&(Q.outSpatialReference=ja,oa=this.map&&this.map.getMaxResolution()||1/r.getUnitValueForSR(ja))&&(Q.maxAllowableOffset=oa);Q.returnGeometry=!0;t.outFields&&(Q.outFields=t.outFields);if(!a.hasOwnProperty(this._objectIdIdentifier)){this._supportsPagination(t)&&
(Q.num=t.maxResults||this.maxResults);t.useMapExtent&&this.map&&this.map.extent&&(Q.geometry=this.map.extent);t.searchExtent&&(Q.geometry=t.searchExtent);var ra=t.exactMatch}a.hasOwnProperty("text")&&H?(ia=this._whereClause(W,t.featureLayer,ia,ra,"search"))?(Q.where=ia,ia=!0):ia=!1:a.hasOwnProperty(this._objectIdIdentifier)?(Q.objectIds=[a[this._objectIdIdentifier]],ia=!0):a.geometry?(Q.geometry=a.geometry,ia=!0):a.point?(Q.geometry=a.point,ia=!0):a.latlon?(e=new Ea(a.latlon,this._defaultSR),Q.geometry=
e,ia=!0):(a.hasOwnProperty("text")&&!H?l.resolve([]):l.reject(this._error("Invalid query type for FeatureLayer")),ia=!1);ia?t.featureLayer.queryFeatures(Q,v.hitch(this,function(fa){fa=fa.features;var qa;fa&&(qa=this._hydrateResults(fa,g,!1));l.resolve(qa)}),v.hitch(this,function(fa){fa||(fa=this._error("FeatureLayer queryFeatures could not be performed"));l.reject(fa)})):l.resolve()}else l.reject(this._error("Invalid FeatureLayer field"))})):l.reject(this._error("Invalid source"))}else l.reject(this._error("Source is undefined"));
return l.promise},_clearQueryTimeout:function(){this._queryTimer&&clearTimeout(this._queryTimer)},_formatResults:function(a,e,l){l={activeSourceIndex:e,value:l,numResults:0,numErrors:0,errors:null,results:null};var g={},t={};if(a)if(e===this._allIndex)for(e=0;e<a.length;e++)a[e]&&(a[e]instanceof Error?(g[e]=a[e],l.numErrors++):(t[e]=a[e],l.numResults+=a[e].length));else a[0]&&(a[0]instanceof Error?(g[e]=a[0],l.numErrors++):(t[e]=a[0],l.numResults+=a[0].length));l.numErrors&&(l.errors=g);l.numResults&&
(l.results=t);return l},_reverseGeocodePoint:function(a,e){var l=new p,g=this.sources[a];if(e&&g){var t=g.locationToAddressDistance||this.locationToAddressDistance;g.locator.outSpatialReference=this._defaultSR;this.map&&(g.locator.outSpatialReference=this.map.spatialReference);g.locator.locationToAddress(e,t,v.hitch(this,function(H){H=this._hydrateResults([H],a,!1);l.resolve(H)}),v.hitch(this,function(H){H||(H=this._error("Locator locationToAddress could not be performed"));l.reject(H)}))}else l.reject(this._error("No point or source defined for reverse geocoding"));
return l.promise},_cancelDeferreds:function(){if(this._deferreds&&this._deferreds.length)for(var a=0;a<this._deferreds.length;a++)this._deferreds[a].cancel(this.declaredClass+" cancelling request");this._deferreds=[]},_sourceBtnKey:function(a){if(a){var e=x("li",this.sourcesNode);a.keyCode===z.UP_ARROW?(a.stopPropagation(),a.preventDefault(),this._showSourcesMenu(),(a=e.length)&&aa.focus(e[a-1])):a.keyCode===z.DOWN_ARROW&&(a.stopPropagation(),a.preventDefault(),this._showSourcesMenu(),e[0]&&aa.focus(e[0]))}},
_inputKey:function(a){if(a){var e=x("li",this.suggestionsNode),l=this.suggestResults;if(a.keyCode===z.TAB||a.keyCode===z.ESCAPE)this._cancelSuggest(),this._hideMenus();else if(a.keyCode===z.UP_ARROW)a.stopPropagation(),a.preventDefault(),this._cancelSuggest(),l&&this._showSuggestionsMenu(),(a=e.length)&&aa.focus(e[a-1]);else if(a.keyCode===z.DOWN_ARROW)a.stopPropagation(),a.preventDefault(),this._cancelSuggest(),l&&this._showSuggestionsMenu(),e[0]&&aa.focus(e[0]);else{if(a.ctrlKey||a.metaKey||a.keyCode===
z.copyKey||a.keyCode===z.LEFT_ARROW||a.keyCode===z.RIGHT_ARROW||a.keyCode===z.ENTER)return a;this._suggestDelay()}}},_cancelSuggest:function(){this._cancelDeferreds();this._clearQueryTimeout()},_suggestDelay:function(){this._cancelSuggest();this._changeValue();this._queryTimer=setTimeout(v.hitch(this,function(){this.suggest()}),this.suggestionDelay)},_changeValue:function(){this.set("magicKey",null);this.set("selectedFeatureId",null);this._changeAttrValue("value",this.inputNode.value);this._checkStatus()},
_inputClick:function(){this._hideSourcesMenu();this._hideNoResultsMenu()},_getSourceName:function(a){return this._sourceNames[a]},_loadSources:function(a){a=y.filter(a,function(e){return!!e.featureLayer});a=y.map(a,function(e){return this._featureLayerLoaded(e.featureLayer)},this);return ta(a)},_createSourceNameMap:function(a){return this._loadSources(a).then(v.hitch(this,function(){var e=y.map(a,function(l){return l.name||l.featureLayer&&l.featureLayer.name||A.widgets.Search.main.untitledSource});
this._preventDuplicateSourceNames(a,e);return e}))},_getDuplicateSourceNameIndexes:function(a){var e={},l=[];y.forEach(a,function(g,t){e.hasOwnProperty(g)?(-1===l.indexOf(e[g])&&l.push(e[g]),l.push(t)):a.lastIndexOf(g)!==t&&(e[g]=t)});return l},_preventDuplicateSourceNames:function(a,e){if(e&&1<e.length){var l=this._getDuplicateSourceNameIndexes(e);y.forEach(l,function(g){e[g]+=this._getFieldsString(a[g])},this)}},_getFieldsString:function(a){var e="",l=a.featureLayer;if(l){a=a.searchFields||[this._getDisplayField(a)];
for(var g=0;g<a.length;g++){e=0===g?e+": ":e+", ";var t=a[g],H=l.getFieldLabel(t);e+=H||t}}return e},_splitResult:function(a,e){e=h.escapeString(e);return a.replace(new RegExp("(^|)("+e+")(|$)","ig"),"$1|$2|$3").split("|")},_insertSuggestions:function(a,e){if(this.enableSuggestionsMenu&&this.suggestionsNode){this._hideSourcesMenu();this._hideNoResultsMenu();var l=this.sources;if(a){var g=G.create("div");for(var t in a)if(a[t]&&a[t].length){var H=this._getSourceName(t);1<l.length&&this.activeSourceIndex===
this._allIndex&&G.create("div",{className:this.css.searchMenuHeader,textContent:H},g);H=G.create("ul",{role:"menu"},g);for(var W=l[t].maxSuggestions||this.maxSuggestions,ja=0;ja<a[t].length&&ja<W;++ja){var da=G.create("li",{"data-index":ja,"data-source-index":t,role:"menuitem",tabindex:0},H),ha=this._getSuggestionName(a[t][ja]);ha=this._splitResult(ha,e);for(var Q=ha.length,ia=0;ia<Q;ia++){var oa=ha[ia];oa.toLowerCase()===e.toLowerCase()?G.create("strong",{textContent:oa},da):(oa=document.createTextNode(oa),
G.place(oa,da))}}}}g?(G.place(g,this.suggestionsNode,"only"),this._showSuggestionsMenu()):(G.empty(this.suggestionsNode),this._hideSuggestionsMenu())}},_insertSources:function(a){if(this.enableSourcesMenu&&a&&1<a.length){var e,l=this.activeSourceIndex,g=G.create("ul",{role:"menu"});if(this.enableSearchingAll){var t="";l===this._allIndex&&(t="active");G.create("li",{"data-index":this._allIndex,role:"menuitem",className:t,tabIndex:0,textContent:A.widgets.Search.main.all},g)}for(e=0;e<a.length;e++){t=
"";e===l&&(t=this.css.activeSource);var H=this._getSourceName(e);G.create("li",{"data-index":e,role:"menuitem",className:t,tabIndex:0,textContent:H},g)}c.add(this.containerNode,this.css.hasMultipleSources);G.place(g,this.sourcesNode,"only")}else c.remove(this.containerNode,this.css.hasMultipleSources),G.empty(this.sourcesNode)},_showLoading:function(){c.add(this.containerNode,this.css.searchLoading)},_hideLoading:function(){c.remove(this.containerNode,this.css.searchLoading)},_checkStatus:function(){this.value?
(c.add(this.containerNode,this.css.hasValue),f.set(this.clearNode,"title",A.widgets.Search.main.clearButtonTitle)):this.clear()},_closePopup:function(){this.enableInfoWindow&&this.map&&this.map.infoWindow&&this.map.infoWindow.hide()},_noResults:function(a){var e;a&&(e=v.trim(a));var l=G.create("div",{className:this.css.searchNoResultsBody});a&&e?(G.create("div",{className:this.css.searchNoResultsHeader,textContent:A.widgets.Search.main.noResults},l),G.create("div",{className:this.css.searchNoResultsText,
textContent:E.substitute({value:'"'+a+'"'},A.widgets.Search.main.noResultsFound)},l)):(a=G.create("div",{},l),G.create("span",{"aria-hidden":"true",className:this.css.searchNoValueIcon},a),G.create("span",{className:this.css.searchNoValueText,textContent:A.widgets.Search.main.emptyValue},a));G.place(l,this.noResultsMenuNode,"only")},_hideMenus:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();this._hideNoResultsMenu()},_hideNoResultsMenu:function(){c.remove(this.containerNode,this.css.showNoResults)},
_showNoResultsMenu:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();c.add(this.containerNode,this.css.showNoResults)},_hideSourcesMenu:function(){c.remove(this.containerNode,this.css.showSources)},_hideSuggestionsMenu:function(){c.remove(this.containerNode,this.css.showSuggestions)},_showSourcesMenu:function(){this._hideSuggestionsMenu();this._hideNoResultsMenu();c.add(this.containerNode,this.css.showSources)},_showSuggestionsMenu:function(){this._hideSourcesMenu();this._hideNoResultsMenu();
c.add(this.containerNode,this.css.showSuggestions)},_toggleSourcesMenu:function(){this._hideSuggestionsMenu();this._hideNoResultsMenu();c.toggle(this.containerNode,this.css.showSources)},_getFirstStringField:function(a){if(a&&(a=a.fields)&&a.length)for(var e=0;e<a.length;e++){var l=a[e];if("esriFieldTypeString"===l.type)return l.name}return""},_getDisplayField:function(a){return a.displayField||a.featureLayer.displayField||this._getFirstStringField(a.featureLayer)},_validLocation:function(a){return a&&
"number"===typeof a.x&&"number"===typeof a.y},_validExtent:function(a){return a&&"number"===typeof a.xmin&&"number"===typeof a.ymin&&"number"===typeof a.xmax&&"number"===typeof a.ymax},_hydrateResult:function(a,e,l){var g={},t=this._defaultSR;e=this.sources[e];this.map&&(t=this.map.spatialReference);if(a.hasOwnProperty("text")&&a.hasOwnProperty("magicKey"))return a;if(a.hasOwnProperty("geometry")){var H=new Y(a.toJson());g.feature=H;(H=g.feature.geometry)&&H.setSpatialReference(t)}else if(a.hasOwnProperty("location")&&
this._validLocation(a.location)){var W=new Ea(a.location.x,a.location.y,t);H={};a.hasOwnProperty("attributes")&&(H=a.attributes);a.hasOwnProperty("address")&&"object"===typeof a.address&&v.mixin(H,a.address);a.hasOwnProperty("score")&&(H.score=a.score);g.feature=new Y(W,null,H,null)}!g.feature&&l&&(H={},a.hasOwnProperty("attributes")&&(H=a.attributes),a.hasOwnProperty("score")&&(H.score=a.score),g.feature=new Y(null,null,H,null));if(g.feature){if(a.hasOwnProperty("extent")&&this._validExtent(a.extent))g.extent=
new sa(a.extent),g.extent.setSpatialReference(t);else if(g.feature&&g.feature.geometry)switch(g.feature.geometry.type){case "extent":g.extent=g.feature.geometry;break;case "multipoint":g.extent=k.getDenormalizedExtent(g.feature.geometry);break;case "polygon":g.extent=k.getDenormalizedExtent(g.feature.geometry);break;case "polyline":g.extent=k.getDenormalizedExtent(g.feature.geometry);break;case "point":this.map?(t=this.zoomScale,e&&e.zoomScale&&(t=e.zoomScale),this._getScale()>t?g.extent=r.getExtentForScale(this.map,
t).centerAt(g.feature.geometry):g.extent=this.map.extent.centerAt(g.feature.geometry)):g.extent=new sa({xmin:g.feature.geometry.x-.25,ymin:g.feature.geometry.y-.25,xmax:g.feature.geometry.x+.25,ymax:g.feature.geometry.y+.25,spatialReference:this._defaultSR})}else g.extent=null;g.name="";e.featureLayer?e.suggestionTemplate&&l?g.name=E.substitute(a.attributes,e.suggestionTemplate):e.searchTemplate?g.name=E.substitute(a.attributes,e.searchTemplate):(H=this._getDisplayField(e),l=e.featureLayer.getField(H),
t=e.featureLayer.getDomain(H),H&&a.hasOwnProperty("attributes")&&a.attributes.hasOwnProperty(H)&&(a=a.attributes[H],t&&"codedValue"===t.type?g.name=this._getCodedName(t.codedValues,a):l&&"esriFieldTypeDate"===l.type&&!isNaN(a)?g.name=M.format(new Date(a)):g.name=a)):a.address&&e.searchTemplate?g.name=E.substitute(a.address,e.searchTemplate):a.hasOwnProperty("name")?g.name=a.name:a.hasOwnProperty("attributes")&&"object"===typeof a.attributes&&a.attributes.LongLabel?g.name=a.attributes.LongLabel:a.hasOwnProperty("attributes")&&
"object"===typeof a.attributes&&a.attributes.Match_addr?(g.name=a.attributes.Match_addr,a.attributes.Addr_type&&"POI"===a.attributes.Addr_type&&a.attributes.StAddr&&a.attributes.City?g.name+=" - "+a.attributes.StAddr+", "+a.attributes.City:a.attributes.Addr_type&&"POI"===a.attributes.Addr_type&&a.attributes.City&&(g.name+=" - "+a.attributes.City)):a.hasOwnProperty("address")&&"string"===typeof a.address?g.name=a.address:a.hasOwnProperty("address")&&"object"===typeof a.address&&a.address.hasOwnProperty("Address")?
a.address.hasOwnProperty("Match_addr")?g.name=a.address.Match_addr:a.address.hasOwnProperty("Address")&&(g.name=a.address.Address):g.feature&&g.feature.geometry&&(g.name=g.feature.geometry.x+","+g.feature.geometry.y);e.featureLayer&&g.feature&&la(g.feature,e.featureLayer);return g}},_getScale:function(){var a;this.map&&"function"===typeof this.map.getScale&&(a=this.map.getScale());return a},_hydrateResults:function(a,e,l,g){g=[];var t=0;if(a&&a.length)for(t;t<a.length;t++){var H=this._hydrateResult(a[t],
e,l);H&&g.push(H)}return g},_containsNonLatinCharacter:function(a){for(var e=0;e<a.length;e++)if(255<a.charCodeAt(e))return!0;return!1},_setPlaceholder:function(a){var e="",l=this.sources[a];a===this._allIndex?e=this.allPlaceholder||A.widgets.Search.main.allPlaceholder:l&&l.placeholder&&(e=l.placeholder);var g=A.widgets.Search.main.all;l&&(g=this._getSourceName(a));f.set(this.sourceNameNode,"textContent",g);f.set(this.inputNode,"placeholder",e);f.set(this.inputNode,"title",e)},_updateActiveSource:function(){var a=
this.sources,e=this.activeSourceIndex,l;a&&a[e]&&(l=a[e]);l?this.set("activeSource",l):this.set("activeSource",null)},_updateVisible:function(){this.visible?this.show():this.hide()},_updateButtonMode:function(a){a?(c.toggle(this.containerNode,this.css.searchExpanded,this.expanded),c.toggle(this.containerNode,this.css.searchCollapsed,!this.expanded),c.add(this.containerNode,this.css.hasButtonMode)):(c.remove(this.containerNode,this.css.searchExpanded),c.remove(this.containerNode,this.css.searchCollapsed),
c.remove(this.containerNode,this.css.hasButtonMode))},_setDefaultActiveSourceIndex:function(a){a&&1===a.length||!this.enableSearchingAll?this.set("activeSourceIndex",0):this.set("activeSourceIndex",this._allIndex)},_setEnableSourcesMenuAttr:function(a){this._set("enableSourcesMenu",a);this._created&&this._insertSources(this.sources)},_setEnableSearchingAllAttr:function(a){this._set("enableSearchingAll",a);this._created&&(this._setDefaultActiveSourceIndex(this.sources),this._hideMenus(),this._insertSources(this.sources))},
_setSourcesAttr:function(a){this._createSourceNameMap(a).then(v.hitch(this,function(e){this._sourceNames=e;this._created&&(this._setDefaultActiveSourceIndex(a),this._hideMenus(),this._insertSources(a))}));this._set("sources",a)},_setAllPlaceholderAttr:function(a){this._set("allPlaceholder",a);this._created&&this._setPlaceholder(this.activeSourceIndex)},_setActiveSourceIndexAttr:function(a){this._set("activeSourceIndex",a);this._updateActiveSource();this._created&&(this._setPlaceholder(a),this._hideMenus(),
this._insertSources(this.sources))},_setMaxLengthAttr:function(a){this._set("maxLength",a);this._created&&f.set(this.inputNode,"maxLength",a)},_setValueAttr:function(a){this.set("magicKey",null);this.set("selectedFeatureId",null);this._set("value",a);this._created&&(f.set(this.inputNode,"value",a),this._checkStatus())},_setVisibleAttr:function(a){this._set("visible",a);this._created&&this._updateVisible()},_setEnableButtonModeAttr:function(a){this._set("enableButtonMode",a);this._created&&this._updateButtonMode(a)},
_setThemeAttr:function(a){this._created&&(c.remove(this.domNode,this.theme),c.add(this.domNode,a));this._set("theme",a)}});m("extend-esri")&&v.setObject("dijit.Search",B,T);return B})},"esri/tasks/locator":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ./Task ./AddressCandidate".split(" "),function(F,B,v,y,u,p,z,C,x,m,h){F=F(m,{declaredClass:"esri.tasks.Locator",_eventMap:{"address-to-locations-complete":["addresses"],
"addresses-to-locations-complete":["addresses"],"location-to-address-complete":["address"],"suggest-locations-complete":["suggestions"]},constructor:function(d){this._geocodeHandler=B.hitch(this,this._geocodeHandler);this._geocodeAddressesHandler=B.hitch(this,this._geocodeAddressesHandler);this._reverseGeocodeHandler=B.hitch(this,this._reverseGeocodeHandler);this.registerConnectEvents()},outSpatialReference:null,setOutSpatialReference:function(d){this.outSpatialReference=d},_geocodeHandler:function(d,
f,c,w,G){try{var M=d.candidates;f=[];var A,O=M.length,D=d.spatialReference,J;for(A=0;A<O;A++){var N=M[A];if(J=N.location)J.spatialReference=D;f[A]=new h(N)}this._successHandler([f],"onAddressToLocationsComplete",c,G)}catch(S){this._errorHandler(S,w,G)}},_geocodeAddressesHandler:function(d,f,c,w,G){try{var M=d.locations;f=[];var A,O=M.length,D=d.spatialReference,J;for(A=0;A<O;A++){if(J=M[A].location)J.spatialReference=D;f[A]=new h(M[A])}this._successHandler([f],"onAddressesToLocationsComplete",c,G)}catch(N){this._errorHandler(N,
w,G)}},addressToLocations:function(d,f,c,w,G){var M;if(d.address){w=c;c=f;f=d.outFields;G=d.searchExtent;var A=d.countryCode;var O=d.magicKey;var D=d.distance;var J=d.categories;d.location&&this.normalization&&(M=d.location.normalize());var N=d.locationType;var S=d.maxLocations;var aa=d.forStorage;d=d.address}G&&(G=G.shiftCentralMeridian());var E=this.outSpatialReference;d=this._encode(B.mixin({},this._url.query,d,{f:"json",outSR:E&&u.toJson(E.toJson()),outFields:f&&f.join(",")||null,searchExtent:G&&
u.toJson(G.toJson()),category:J&&J.join(",")||null,countryCode:A||null,magicKey:O||null,distance:D||null,location:M||null,locationType:N||null,maxLocations:S||null,forStorage:aa||null}));var ka=this._geocodeHandler,T=this._errorHandler,ca=new y(x._dfdCanceller);ca._pendingDfd=C({url:this._url.path+"/findAddressCandidates",content:d,callbackParamName:"callback",load:function(Y,ta){ka(Y,ta,c,w,ca)},error:function(Y){T(Y,w,ca)}});return ca},suggestLocations:function(d){var f=new y(x._dfdCanceller);d.hasOwnProperty("location")&&
this.normalization&&(d.location=d.location.normalize());d.searchExtent&&(d.searchExtent=d.searchExtent.shiftCentralMeridian());d=this._encode(B.mixin({},this._url.query,{f:"json",text:d.text,maxSuggestions:d.maxSuggestions,searchExtent:d.searchExtent&&u.toJson(d.searchExtent.toJson()),category:d.categories&&d.categories.join(",")||null,countryCode:d.countryCode||null,location:d.location||null,distance:d.distance||null},{f:"json"}));d=C({url:this._url.path+"/suggest",content:d,callbackParamName:"callback"});
f._pendingDfd=d;d.then(B.hitch(this,function(c){c=c.suggestions||[];this.onSuggestLocationsComplete(c);f.resolve(c)}),B.hitch(this,function(c){this._errorHandler(c);f.reject(c)}));return f},addressesToLocations:function(d,f,c){var w=this.outSpatialReference,G=[],M=d.categories,A=d.locationType,O=d.countryCode;v.forEach(d.addresses,function(S,aa){G.push({attributes:S})});d=this._encode(B.mixin({},this._url.query,{category:M&&M.join(",")||null,locationType:A||null,sourceCountry:O||null},{addresses:u.toJson({records:G})},
{f:"json",outSR:w&&u.toJson(w.toJson())}));var D=this._geocodeAddressesHandler,J=this._errorHandler,N=new y(x._dfdCanceller);N._pendingDfd=C({url:this._url.path+"/geocodeAddresses",content:d,callbackParamName:"callback",load:function(S,aa){D(S,aa,f,c,N)},error:function(S){J(S,c,N)}});return N},_reverseGeocodeHandler:function(d,f,c,w,G){try{var M=new h({address:d.address,location:d.location,score:100});this._successHandler([M],"onLocationToAddressComplete",c,G)}catch(A){this._errorHandler(A,w,G)}},
locationToAddress:function(d,f,c,w){d&&this.normalization&&(d=d.normalize());var G=this.outSpatialReference;d=this._encode(B.mixin({},this._url.query,{outSR:G&&u.toJson(G.toJson()),location:d&&u.toJson(d.toJson()),distance:f,f:"json"}));var M=this._reverseGeocodeHandler,A=this._errorHandler,O=new y(x._dfdCanceller);O._pendingDfd=C({url:this._url.path+"/reverseGeocode",content:d,callbackParamName:"callback",load:function(D,J){M(D,J,c,w,O)},error:function(D){A(D,w,O)}});return O},onSuggestLocationsComplete:function(){},
onAddressToLocationsComplete:function(){},onAddressesToLocationsComplete:function(){},onLocationToAddressComplete:function(){}});p("extend-esri")&&B.setObject("tasks.Locator",F,z);return F})},"esri/tasks/AddressCandidate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../geometry/Point"],function(F,B,v,y,u){F=F(null,{declaredClass:"esri.tasks.AddressCandidate",constructor:function(p){B.mixin(this,p);this.location=new u(this.location)}});v("extend-esri")&&B.setObject("tasks.AddressCandidate",
F,y);return F})},"esri/styles/basic":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/has","../kernel","../Color"],function(F,B,v,y,u){function p(h,d){if(h){var f={};f.color=new u(h.color);f.opacity=h.opacity||1;switch(d){case "point":f.outline={color:new u(h.outline.color),width:h.outline.width};f.size=h.size;break;case "line":f.width=h.width;break;case "polygon":f.outline={color:new u(h.outline.color),width:h.outline.width}}}return f}function z(h){if("esriGeometryPoint"===h||"esriGeometryMultipoint"===
h)h="point";else if("esriGeometryPolyline"===h)h="line";else if("esriGeometryPolygon"===h||"esriGeometryMultiPatch"===h)h="polygon";return h}var C={"default":{name:"default",label:"Default",description:"Default theme for basic visualization of features.",basemapGroups:{light:"streets gray topo terrain national-geographic oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector".split(" "),dark:["satellite","hybrid","dark-gray","dark-gray-vector","streets-night-vector"]},
pointSchemes:{light:{primary:{color:[77,77,77,1],outline:{color:[255,255,255,.25],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,.25],width:1},size:8},{color:[255,255,255,1],outline:{color:[51,51,51,.25],width:1},size:8}]},dark:{primary:{color:[255,255,255,1],outline:{color:[92,92,92,.25],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,.25],width:1},size:8},{color:[26,26,26,1],outline:{color:[178,178,178,.25],width:1},size:8}]}},lineSchemes:{light:{primary:{color:[77,
77,77,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[255,255,255,1],width:2}]},dark:{primary:{color:[255,255,255,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[26,26,26,1],width:2}]}},polygonSchemes:{light:{primary:{color:[227,139,79,1],outline:{color:[255,255,255,.25],width:1},opacity:.8},secondary:[{color:[128,128,128,1],outline:{color:[255,255,255,.25],width:1},opacity:.8},{color:[255,255,255,1],outline:{color:[128,128,128,.25],width:1},opacity:.8}]},dark:{primary:{color:[227,
139,79,1],outline:{color:[92,92,92,.25],width:1},opacity:.8},secondary:[{color:[178,178,178,1],outline:{color:[92,92,92,.25],width:1},opacity:.8},{color:[26,26,26,1],outline:{color:[128,128,128,.25],width:1},opacity:.8}]}}}},x={};(function(){var h,d,f;for(h in C){var c=C[h];var w=c.basemapGroups;var G=x[h]={basemaps:[].concat(w.light).concat(w.dark),point:{},line:{},polygon:{}};for(d in w){var M=w[d];for(f=0;f<M.length;f++){var A=M[f];c.pointSchemes&&(G.point[A]=c.pointSchemes[d]);c.lineSchemes&&
(G.line[A]=c.lineSchemes[d]);c.polygonSchemes&&(G.polygon[A]=c.polygonSchemes[d])}}}})();var m={getAvailableThemes:function(h){var d=[],f;for(f in C){var c=C[f];var w=x[f];h&&-1===F.indexOf(w.basemaps,h)||d.push({name:c.name,label:c.label,description:c.description,basemaps:w.basemaps.slice(0)})}return d},getSchemes:function(h){var d=h.theme,f=h.basemap,c=z(h.geometryType);h=x[d];var w;(h=(h=h&&h[c])&&h[f])&&(w={primaryScheme:p(h.primary,c),secondarySchemes:F.map(h.secondary,function(G){return p(G,
c)})});return w},cloneScheme:function(h){if(h){var d=B.mixin({},h);d.color&&(d.color=new u(d.color));d.outline&&(d.outline={color:d.outline.color&&new u(d.outline.color),width:d.outline.width})}return d}};v("extend-esri")&&B.setObject("styles.basic",m,y);return m})},"jimu/dijit/LayerChooserFromMapLite":function(){define("dojo/on dojo/_base/declare dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/dijit/CheckBox jimu/dijit/LayerChooserFromMap jimu/LayerStructure".split(" "),function(F,
B,v,y,u,p,z,C,x){var m=B([C],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3cdiv data-dojo-attach-point\x3d"treeSection" class\x3d"tree-section"\x3e\x3cul data-dojo-attach-point\x3d"treeUl" class\x3d"tree-ul tree-root-ul"\x3e\x3c/ul\x3e\x3c/div\x3e\x3c/div\x3e',
map:null,layerStateController:null,layerState:null,customFilter:null,onlySelectLeafLayer:!1,displayLayerTypeIcon:!0,showTables:!0,viewMode:!1,onlyShowWebMapLayers:!1,layerStructure:null,_layerDatas:null,_eventHandles:null,postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){u.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");u.addClass(this.domNode,"jimu-basic-layer-chooser-from-map-lite");this._layerDatas={};this._eventHandles=[];this.layerStructure=
this.map?x.createInstance(this.map):x.getInstance();this.layerInfosObj=this.layerStructure._layerInfos;this.layerState=this._clearLayerState(this.layerState)||{};this.layerStateController||(this.layerStateController=new m.LayerStateController);var h=this.customFilter?y.hitch(this,this.customFilter):y.hitch(this,this.filter);this.filter=C.andCombineFilters([this.basicFilter,h]);this._createTree()},_createTree:function(){if(this.onlyShowWebMapLayers){var h=this.layerStructure.getWebmapLayerNodes();
var d=this.layerStructure.getWebmapTableNodes()}else h=this.layerStructure.getLayerNodes(),d=this.layerStructure.getTableNodes();0<this._createLayerNodes(h.concat(this.showTables?d:[]),this.treeUl)&&(u.setStyle(this.errorTipSection,"display","none"),this.layerStateController.restoreState(this.layerState,this.layerStructure))},_createLayerNodes:function(h,d){var f=p.map(h,function(w){return this.filter(w._layerInfo)},this),c=0;v(f).then(y.hitch(this,function(w){p.forEach(w,function(G,M){G&&(this._createLayerNode(h[M],
d),c++)},this)}));return c},_createLayerNode:function(h,d){var f=u.create("li",{"class":"tree-node-li",id:"layerchooserlite-tree-node-li-"+h.id},d),c=u.create("div",{"class":"tree-node-div"},f);d=u.create("span",{"class":"tree-node-column-span collapse-span"},c);var w=u.create("span",{"class":"tree-node-column-span check-box-span"},c);w=u.create("div",{"class":"tree-node-column-div check-box-div"},w);var G=u.create("span",{"class":"tree-node-column-span icon-span "+(this.displayLayerTypeIcon?"display":
"")},c);var M=(M=this.layerState[h.id])?M.selected:this.layerStateController.getState(h);M=new z({checked:M},w);var A=u.create("span",{"class":"tree-node-column-span title-span",innerHTML:h.title},c),O=u.create("ul",{"class":"tree-ul tree-subnode-ul",style:"display:none; "},f);f={layerNode:h,layerNodeLi:f,layerNodeDiv:c,collapseSpan:d,iconSpan:G,checkBox:M,subLayerNodeUl:O,hasBeenOpened:!1};this._layerDatas[h.id]=f;h.isLeaf()||(u.addClass(d,"is-leaf"),u.addClass(A,"is-leaf"),h=F(d,"click",y.hitch(this,
this._onCollapse,f)),this._eventHandles.push(h),h=F(A,"click",y.hitch(this,this._onCollapse,f)),this._eventHandles.push(h),this.onlySelectLeafLayer&&(M.setStatus(!1),u.setStyle(w,"display","none")));!0===this.viewMode&&M.setStatus(!1);h=F(M.domNode,"click",y.hitch(this,this._onCheckBoxChange,f));this._eventHandles.push(h);this._setIconImage(f,!1);return f},_setIconImage:function(h,d){if(this.displayLayerTypeIcon){var f=h.layerNode,c=f.getLayerType(),w=f.getLayerObject();v({layerType:c,layerObject:w}).then(y.hitch(this,
function(G){if(G.layerType&&G.layerObject){var M={type:G.layerType,layerInfo:f._layerInfo};G=window.location.protocol+"//"+window.location.host+require.toUrl("jimu");(M=this._getIconInfo(M,d).imageName)&&u.setStyle(h.iconSpan,"background-image","url("+G+"/css/images/"+M+")")}}))}},_getCheckBoxValue:function(h){return h.getStatus()?h.getValue():!1},_clearLayerState:function(h){var d={};h&&this.layerStructure.traversal(y.hitch(this,function(f){h[f.id]&&(d[f.id]={selected:h[f.id].selected})}));return d},
_selectOrDeselectLayer:function(h,d){if(h=this._layerDatas[h])h.checkBox.setValue(d),this._onCheckBoxChange(h)},selectLayer:function(h){this._selectOrDeselectLayer(h,!0)},deselectLayer:function(h){this._selectOrDeselectLayer(h,!1)},getState:function(){var h=y.clone(this.layerState),d;for(d in this._layerDatas)this._layerDatas.hasOwnProperty(d)&&"function"!==typeof this._layerDatas[d]&&(this._getCheckBoxValue(this._layerDatas[d].checkBox)?h[d]={selected:!0}:h[d]={selected:!1});return h},restoreState:function(h){this.layerState=
this._clearLayerState(h);for(var d in this._layerDatas)if(this._layerDatas.hasOwnProperty(d)&&"function"!==typeof this._layerDatas[d]){var f=(h=this._layerDatas[d])&&h.checkBox,c=this.layerState[d];c?f.setValue(c.selected):f.setValue(this.layerStateController.getState(h.layerNode))}this.layerStateController.restoreState(this.layerState,this.layerStructure)},setViewMode:function(h){for(var d in this._layerDatas)if(this._layerDatas.hasOwnProperty(d)&&"function"!==typeof this._layerDatas[d]){var f=this._layerDatas[d];
f=f&&f.checkBox;!0===h?(this.viewMode=!0,f.setStatus(!1)):(this.viewMode=!1,f.setStatus(!0))}},getSelectedLayerNodes:function(){var h=[],d=this.getState(),f;for(f in d)if(d.hasOwnProperty(f)&&"function"!==typeof d[f]&&d[f].selected){var c=this.layerStructure.getNodeById(f);c&&h.push(c)}return h},getLoadedLayerNodes:function(){var h=[],d;for(d in this._layerDatas)if(this._layerDatas.hasOwnProperty(d)&&"function"!==typeof this._layerDatas[d]){var f=this.layerStructure.getNodeById(d);f&&h.push(f)}return h},
getLayerAssociateDomNodesById:function(h){var d=null;(h=this._layerDatas[h])&&(d={collapseIcon:h.collapseSpan,checkBox:h.checkBox.domNode,layerTypeIcon:h.iconSpan});return d},getSelectedItems:function(){var h=[];return h=p.map(this.getSelectedLayerNodes(),function(d){return{name:d.title,url:d.getUrl(),layerInfo:d._layerInfo}},this)},getAllItems:function(){return[]},_clear:function(){this._layerDatas={};p.forEach(this._eventHandles,function(h){h.remove()},this);this._eventHandles=[];u.empty(this.treeUl)},
destroy:function(){this._clear();this.map&&this.layerStructure.destroy();this.shelter&&(this.shelter.destroy(),this.shelter=null);this.inherited(arguments)},_onCollapse:function(h){var d="none"===u.getStyle(h.subLayerNodeUl,"display")?!0:!1;d?(u.setStyle(h.subLayerNodeUl,"display","block"),u.addClass(h.collapseSpan,"opened")):(u.setStyle(h.subLayerNodeUl,"display","none"),u.removeClass(h.collapseSpan,"opened"));this._setIconImage(h,d);h.hasBeenOpened||(this._createLayerNodes(h.layerNode.getSubNodes(),
h.subLayerNodeUl),h.hasBeenOpened=!0)},_onCheckBoxChange:function(h,d){this.layerStateController.setState(h.layerNode,this._getCheckBoxValue(h.checkBox));this.emit("selection-change",h.layerNode,this._getCheckBoxValue(h.checkBox));this._onTreeClick(h,d)},_onLayerInfosChanged:function(){this._createTree();this.emit("update")},_onLayerInfosIsShowInMapChanged:function(){this._createTree();this.emit("update")},_onTreeClick:function(h,d){h={name:h.layerNode.title||"",parent:null,layerInfo:h.layerNode._layerInfo,
type:null,layerClass:null,id:null,isLeaf:h.layerNode.isLeaf(),hasChildren:h.layerNode.isLeaf()?!1:!0};this.emit("tree-click",h,null,d)}});m.LayerStateController=B(null,{getState:function(h){return!0},setState:function(h,d){return this},restoreState:function(h,d){return this}});m.LayerVisibilityStateController=B(m.LayerStateController,{getState:function(h){return h.isToggledOn()},setState:function(h,d){h.toggle();return this},restoreState:function(h,d){var f={layerOptions:{}},c;for(c in h)h.hasOwnProperty(c)&&
"function"!==typeof h[c]&&(f.layerOptions[c]={visible:h[c].selected});d.restoreState(f);return this}});m.layerVisibilityStateController=new m.LayerVisibilityStateController;m.LayerLegendStateController=B(m.LayerStateController,{getState:function(h){return h.isShowLegend()}});m.layerLegendStateController=new m.LayerLegendStateController;return m})},"jimu/dijit/LayerChooserFromMap":function(){define("dojo/on dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/store/Memory dojo/Deferred dojo/store/Observable dijit/tree/ObjectStoreModel dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/utils jimu/dijit/_Tree jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator".split(" "),
function(F,B,v,y,u,p,z,C,x,m,h,d,f,c,w,G,M,A){var O=v([y,u,p,B],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_treeClass:"layer-chooser-tree",createMapResponse:null,multiple:!1,onlyShowVisible:!1,
updateWhenLayerInfosIsShowInMapChanged:!1,onlyShowWebMapLayers:!1,displayTooltipForTreeNode:!1,onlyFilterCurrentLayerWhenAddItem:!1,postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){this.inherited(arguments);f.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");this.multiple=!!this.multiple;this.shelter=new A({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this._createTree();this.basicFilter=d.hitch(this,this.basicFilter);
this.filter=O.andCombineFilters([this.basicFilter,this.filter]);this.createMapResponse&&this.setCreateMapResponse(this.createMapResponse)},basicFilter:function(D){var J=new C;this.onlyShowVisible?J.resolve(D.isShowInMap()):J.resolve(!0);return J},filter:function(D){D=new C;D.resolve(!0);return D},getSelectedItems:function(){var D=this.tree.getSelectedItems();return c.map(D,d.hitch(this,function(J){return this.getHandledItem(J)}))},getAllItems:function(){var D=this.tree.getAllItems(),J=[];c.forEach(D,
d.hitch(this,function(N){"root"!==N.id&&(N=this.getHandledItem(N),J.push(N))}));return J},getHandledItem:function(D){return{name:D.name,layerInfo:D.layerInfo}},_isLeafItem:function(D){return D.isLeaf},setCreateMapResponse:function(D){this.createMapResponse=D;M.getInstance(this.createMapResponse.map,this.createMapResponse.itemInfo).then(d.hitch(this,function(J){this.layerInfosObj=J;this.own(F(this.layerInfosObj,"layerInfosChanged",d.hitch(this,this._onLayerInfosChanged)));this.updateWhenLayerInfosIsShowInMapChanged&&
this.own(F(this.layerInfosObj,"layerInfosIsShowInMapChanged",d.hitch(this,this._onLayerInfosIsShowInMapChanged)));this._buildTree(this.layerInfosObj)}))},_onLayerInfosChanged:function(D,J){this._buildTree(this.layerInfosObj);this.emit("update")},_onLayerInfosIsShowInMapChanged:function(D){this._buildTree(this.layerInfosObj);this.emit("update")},_buildTree:function(D){this._clear();f.setStyle(this.errorTipSection,"display","block");var J=[];this.onlyShowWebMapLayers?(J=D.getLayerInfoArrayOfWebmap(),
J=J.concat(D.getTableInfoArrayOfWebmap())):(J=D.getLayerInfoArray(),J=J.concat(D.getTableInfoArray()));0!==J.length&&(f.setStyle(this.errorTipSection,"display","none"),c.forEach(J,d.hitch(this,function(N){this._addDirectLayerInfo(N)})))},_addDirectLayerInfo:function(D){D&&D.getLayerObject().then(d.hitch(this,function(){this._addItem("root",D)}),d.hitch(this,function(J){console.error(J)}))},_clear:function(){var D=this._store.query({parent:"root"});c.forEach(D,d.hitch(this,function(J){J&&"root"!==
J.id&&this._store.remove(J.id)}))},_addItem:function(D,J){var N=null,S=J.getLayerType(),aa=this.filter(J);h({layerType:S,valid:aa}).then(d.hitch(this,function(E){if(E.valid){var ka=d.hitch(this,function(ta,Ka){this._id++;N={name:J.title||"",parent:D,layerInfo:J,type:E.layerType,layerClass:J.layerObject.declaredClass,id:this._id.toString(),isLeaf:ta,hasChildren:Ka};this._store.add(N)}),T=J.getSubLayers(),ca=0===T.length,Y=!0;this.onlyFilterCurrentLayerWhenAddItem?(ca&&(Y=!1),ka(ca,Y)):ca?ka(ca,!1):
(T=c.map(T,d.hitch(this,function(ta){return this.filter(ta)})),h(T).then(d.hitch(this,function(ta){(ta=c.some(ta,function(Ka){return Ka}))&&ka(ca,ta)})))}}))},_getRootItem:function(){return{id:"root",name:"Map Root",type:"root",isLeaf:!1,hasChildren:!0}},_createTree:function(){var D=this._getRootItem();D=new z({data:[D],getChildren:function(J){return this.query({parent:J.id})}});this._store=new x(D);D=new m({store:this._store,query:{id:"root"},mayHaveChildren:d.hitch(this,this._mayHaveChildren)});
this.tree=new G({multiple:this.multiple,model:D,showRoot:!1,isLeafItem:d.hitch(this,this._isLeafItem),style:{width:"100%"},onOpen:d.hitch(this,function(J,N){"root"!==J.id&&this._onTreeOpen(J,N)}),onClick:d.hitch(this,function(J,N,S){this._onTreeClick(J,N,S);this.emit("tree-click",J,N,S)}),getIconStyle:d.hitch(this,function(J,N){var S=null;if(!J||"root"===J.id)return null;var aa={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},E=window.location.protocol+
"//"+window.location.host+require.toUrl("jimu");if(J=this._getIconInfo(J,N).imageName)aa.backgroundImage="url("+E+"/css/images/"+J+")",S=aa;return S}),getIconClass:d.hitch(this,function(J,N){return this._getIconInfo(J,N).className}),getTooltip:d.hitch(this,function(J){return this.displayTooltipForTreeNode?J.layerInfo.title:""})});f.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.shelter.domNode,"before")},_mayHaveChildren:function(D){return D.hasChildren},_getIconInfo:function(D,
J){var N="",S="";"ArcGISDynamicMapServiceLayer"===D.type||"ArcGISTiledMapServiceLayer"===D.type?J?(N="mapserver_open.png",S="mapservice-layer-icon open"):(N="mapserver_close.png",S="mapservice-layer-icon close"):"GroupLayer"===D.type?J?(N="group_layer2.png",S="group-layer-icon open"):(N="group_layer1.png",S="group-layer-icon close"):"FeatureLayer"===D.type?(D=w.getTypeByGeometryType(D.layerInfo.layerObject.geometryType),"point"===D?(N="point_layer1.png",S="point-layer-icon"):"polyline"===D?(N="line_layer1.png",
S="line-layer-icon"):"polygon"===D&&(N="polygon_layer1.png",S="polygon-layer-icon")):"Table"===D.type?(N="table.png",S="table-icon"):"ArcGISImageServiceLayer"===D.type||"ArcGISImageServiceVectorLayer"===D.type?(N="image_layer.png",S="iamge-layer-icon"):J?(N="mapserver_open.png",S="mapservice-layer-icon open"):(N="mapserver_close.png",S="mapservice-layer-icon close");return{imageName:N,className:S}},_onTreeOpen:function(D,J){if("root"!==D.id){var N=[];J=[];N=D.layerInfo.getSubLayers();D.checked||(this.shelter.show(),
J=c.map(N,d.hitch(this,function(S){return S.getLayerObject()})),h(J).then(d.hitch(this,function(){this.domNode&&(c.forEach(N,d.hitch(this,function(S){this._addItem(D.id,S)})),D.checked=!0,this.shelter.hide())}),d.hitch(this,function(S){console.error(S);this.shelter.hide()})))}},_onTreeClick:function(D,J,N){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.tree&&this.tree.destroy();this.inherited(arguments)}});O.createFilterByLayerType=function(D){d.isArrayLike(D)||
(D=[]);return function(J){var N=new C;if(0===D.length)N.resolve(!0);else{var S=[];J.traversal(function(aa){S.push(aa.getLayerType())});h(S).then(function(aa){for(var E=0;E<aa.length;E++)for(var ka=0;ka<D.length;ka++)if(aa[E]===D[ka]){N.resolve(!0);return}N.resolve(!1)},function(aa){console.error(aa);N.reject(aa)})}return N}};O.createFeaturelayerFilter=function(D,J,N,S){var aa=["point","polyline","polygon"];D&&0<D.length?(D=c.filter(D,function(E){return 0<=aa.indexOf(E)}),0===D.length&&(D=aa)):D=aa;
return function(E){var ka=E.getLayerType();E=E.getLayerObject();return h({layerType:ka,layerObject:E}).then(function(T){var ca=T.layerType;T=T.layerObject;if("ArcGISDynamicMapServiceLayer"===ca||"ArcGISTiledMapServiceLayer"===ca||"GroupLayer"===ca||"FeatureCollection"===ca)return!0;if("FeatureLayer"===ca){ca=w.getTypeByGeometryType(T.geometryType);ca=0<=c.indexOf(D,ca);var Y=O._shouldPassStatisticsCheck(S,T);return T.url?(T=w.isFeaturelayerUrlSupportQuery(T.url,T.capabilities),ca&&T&&Y):J&&ca}return"Table"===
ca?(ca=w.isFeaturelayerUrlSupportQuery(T.url,T.capabilities),T=O._shouldPassStatisticsCheck(S,T),N&&ca&&T):!1})}};O.createImageServiceLayerFilter=function(D,J){return function(N){var S=N.getLayerType();N=N.getLayerObject();return h({layerType:S,layerObject:N}).then(function(aa){var E=aa.layerType,ka=aa.layerObject;return"ArcGISImageServiceLayer"===E||"ArcGISImageServiceVectorLayer"===E?D?w.isImageServiceSupportQuery(aa.layerObject.capabilities)?J?O._shouldPassStatisticsCheck(J,ka):!0:!1:!0:!1})}};
O._shouldPassStatisticsCheck=function(D,J){return D?(D=!1,D=J.advancedQueryCapabilities?!!J.advancedQueryCapabilities.supportsStatistics:!!J.supportsStatistics):!0};O.createQueryableLayerFilter=function(D){var J=O.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0,D);D=O.createImageServiceLayerFilter(!0,D);return O.orCombineFilters([J,D])};O.andCombineFilters=function(D){return O._combineFilters(D,!0)};O.orCombineFilters=function(D){return O._combineFilters(D,!1)};O._combineFilters=function(D,
J){return function(N){var S=new C,aa=c.map(D,function(E){return E(N)});h(aa).then(function(E){var ka=!1;ka=J?c.every(E,function(T){return T}):c.some(E,function(T){return T});S.resolve(ka)},function(E){console.error(E);S.reject(E)});return S}};return O})},"dijit/tree/ObjectStoreModel":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/when ../Destroyable".split(" "),function(F,B,v,y,u,p,z){return v("dijit.tree.ObjectStoreModel",z,{store:null,labelAttr:"name",
labelType:"text",root:null,query:null,constructor:function(C){u.mixin(this,C);this.childrenCache={}},getRoot:function(C,x){if(this.root)C(this.root);else{var m=this.store.query(this.query);m.then&&this.own(m);p(m,u.hitch(this,function(h){if(1!=h.length)throw Error("dijit.tree.ObjectStoreModel: root query returned "+h.length+" items, but must return exactly one");this.root=h[0];C(this.root);m.observe&&m.observe(u.hitch(this,function(d){this.onChange(d)}),!0)}),x)}},mayHaveChildren:function(){return!0},
getChildren:function(C,x,m){var h=this.store.getIdentity(C);if(this.childrenCache[h])p(this.childrenCache[h],x,m);else{var d=this.childrenCache[h]=this.store.getChildren(C);d.then&&this.own(d);d.observe&&this.own(d.observe(u.hitch(this,function(f,c,w){this.onChange(f);c!=w&&p(d,u.hitch(this,"onChildrenChange",C))}),!0));p(d,x,m)}},isItem:function(){return!0},getIdentity:function(C){return this.store.getIdentity(C)},getLabel:function(C){return C[this.labelAttr]},newItem:function(C,x,m,h){return this.store.put(C,
{parent:x,before:h})},pasteItem:function(C,x,m,h,d,f){var c=new y;if(x===m&&!h&&!f)return c.resolve(!0),c;x&&!h?this.getChildren(x,u.hitch(this,function(w){w=[].concat(w);var G=F.indexOf(w,C);w.splice(G,1);this.onChildrenChange(x,w);c.resolve(this.store.put(C,{overwrite:!0,parent:m,oldParent:x,before:f,isCopy:!1}))})):c.resolve(this.store.put(C,{overwrite:!0,parent:m,oldParent:x,before:f,isCopy:!0}));return c},onChange:function(){},onChildrenChange:function(){},onDelete:function(){}})})},"jimu/dijit/_Tree":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_TreeNode.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/event dojo/query dojo/aspect dojo/on dojo/keys dojo/Evented dijit/registry dijit/Tree jimu/utils".split(" "),
function(F,B,v,y,u,p,z,C,x,m,h,d,f,c,w,G){var M=F([w._TreeNode,f],{templateString:y,declaredClass:"jimu._TreeNode",isLeaf:!1,groupId:"",postCreate:function(){this.inherited(arguments);p.addClass(this.domNode,"jimu-tree-node");this.isLeaf=!!this.isLeaf;this.groupId?(this.checkNode=p.toDom('\x3cinput type\x3d"radio" /\x3e'),this.checkNode.name=this.groupId):this.checkNode=p.toDom('\x3cinput type\x3d"checkbox" /\x3e');p.addClass(this.checkNode,"jimu-tree-check-node");p.place(this.checkNode,this.contentNode,
"first");this.own(h(this.checkNode,"click",u.hitch(this,this._onClick)));this.own(h(this.rowNode,"keydown",u.hitch(this,function(A,O){O.target=A;O.keyCode!==d.ENTER&&O.keyCode!==d.SPACE||this._onClick(O)},this.checkNode)));this.isLeaf?this.groupId?p.setStyle(this.checkNode,"display","none"):p.setStyle(this.checkNode,"display","inline"):p.setStyle(this.checkNode,"display","none");this.isLeaf?p.addClass(this.domNode,"jimu-tree-leaf-node"):p.addClass(this.domNode,"jimu-tree-not-leaf-node")},select:function(){this.isLeaf&&
(this.checkNode.checked=!0,p.addClass(this.domNode,"jimu-tree-selected-leaf-node"))},unselect:function(){this.isLeaf&&(this.checkNode.checked=!1,p.removeClass(this.domNode,"jimu-tree-selected-leaf-node"))},toggleSelect:function(){this.isLeaf&&(this.checkNode.checked?this.unselect():this.select())},_onClick:function(A){(A.target||A.srcElement)===this.checkNode?this.tree._onCheckNodeClick(this,this.checkNode.checked,A):this.tree._onClick(this,A)},_onChange:function(){this.isLeaf&&setTimeout(u.hitch(this,
function(){this.checkNode.checked?this.emit("tn-select",this):this.emit("tn-unselect",this)}),100)},destroy:function(){delete this.tree;this.inherited(arguments)}});return F([w,f],{declaredClass:"jimu._Tree",openOnClick:!0,multiple:!0,uniqueId:"",showRoot:!1,postMixInProperties:function(){this.inherited(arguments);this.uniqueId="tree_"+G.getRandomString()},postCreate:function(){this.inherited(arguments);p.addClass(this.domNode,"jimu-tree");this.own(m.before(this,"onClick",u.hitch(this,this._jimuBeforeClick)));
this.rootLoadingIndicator&&p.setStyle(this.rootLoadingIndicator,"display","none");this.dndController.singular=!0;p.setAttr(this.domNode,"tabindex",0)},removeItem:function(A){this.model.store.remove(A)},getAllItems:function(){var A=this.getAllTreeNodeWidgets();return z.map(A,u.hitch(this,function(O){var D=O.item;D.selected=O.checkNode.checked;return D}))},getSelectedItems:function(){var A=this.getAllTreeNodeWidgets();A=z.filter(A,u.hitch(this,function(O){return O.checkNode.checked}));return z.map(A,
u.hitch(this,function(O){return O.item}))},getFilteredItems:function(A){var O=this.getAllTreeNodeWidgets();O=z.map(O,u.hitch(this,function(D){var J=D.item;J.selected=D.checkNode.checked;return J}));return z.filter(O,u.hitch(this,function(D){return A(D)}))},getTreeNodeByItemId:function(A){for(var O=this._getAllTreeNodeDoms(),D=0;D<O.length;D++){var J=c.byNode(O[D]);if(J.item.id.toString()===A.toString())return J}return null},selectItem:function(A){(A=this.getTreeNodeByItemId(A))&&A.isLeaf&&this.selectNodeWidget(A)},
unselectItem:function(A){(A=this.getTreeNodeByItemId(A))&&A.isLeaf&&A.unselect()},getAllLeafTreeNodeWidgets:function(){var A=this.getAllTreeNodeWidgets();return z.filter(A,u.hitch(this,function(O){return O.isLeaf}))},getAllTreeNodeWidgets:function(){var A=this._getAllTreeNodeDoms();return z.map(A,u.hitch(this,function(O){return c.byNode(O)}))},isLeafItem:function(A){return A&&A.isLeaf},_getAllTreeNodeDoms:function(){return x(".dijitTreeNode",this.domNode)},_createTreeNode:function(A){A.isLeaf=this.isLeafItem(A.item);
this.multiple||(A.groupId=this.uniqueId);return new M(A)},_onTreeNodeSelect:function(A){this.emit("item-select",{item:A.item,treeNode:A})},_onTreeNodeUnselect:function(A){this.emit("item-unselect",{item:A.item,treeNode:A})},selectNodeWidget:function(A){this.multiple||this.unselectAllLeafNodeWidgets();A.select()},_jimuBeforeClick:function(A,O,D){O.isLeaf&&(p.hasClass(D.target||D.srcElement,"jimu-tree-check-node")||(this.multiple?O.toggleSelect():this.selectNodeWidget(O)));return arguments},_onCheckNodeClick:function(A,
O,D){!this.multiple&&O&&this.unselectAllLeafNodeWidgets();C.stop(D);this.focusNode(A);setTimeout(u.hitch(this,function(){O?this.selectNodeWidget(A):A.unselect();this.onClick(A.item,A,D)}),0)},unselectAllLeafNodeWidgets:function(){var A=this.getAllLeafTreeNodeWidgets();z.forEach(A,u.hitch(this,function(O){O.unselect()}))}})})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(F,B,v,y,u,p,z,C,x,m,h,d,f,c,w,G,M,A,O,D,J,N,S,aa,E,ka,T,ca,Y,ta,Ka,Pa,Ua,Ya,ua){function na(k){return G.delegate(k.promise||k,{addCallback:function(r){this.then(r)},addErrback:function(r){this.otherwise(r)}})}var Ea=y("dijit._TreeNode",[E,ka,T,ca,Y],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(k){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=k;this._set("label",k);f("dojo-bidi")&&this.applyTextDir(this.labelNode)},labelType:"text",
isExpandable:null,isExpanded:!1,state:"NotLoaded",templateString:Ka,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(k){var r=Math.max(k,0)*this.tree._nodePixelIndent+"px";m.set(this.domNode,
"backgroundPosition",r+" 0px");m.set(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",r);F.forEach(this.getChildren(),function(R){R.set("indent",k+1)});this._set("indent",k)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(k){var r=this.tree,R=r.model;r._v10Compat&&k===R.root&&(k=null);this._applyClassAndStyle(k,"icon","Icon");this._applyClassAndStyle(k,"label","Label");this._applyClassAndStyle(k,
"row","Row");this.tree._startPaint(!0)},_applyClassAndStyle:function(k,r,R){var U="_"+r+"Class";r+="Node";var ba=this[U];this[U]=this.tree["get"+R+"Class"](k,this.isExpanded);C.replace(this[r],this[U]||"",ba||"");m.set(this[r],this.tree["get"+R+"Style"](k,this.isExpanded)||{})},_updateLayout:function(){var k=this.getParent();k=!k||!k.rowNode||"none"==k.rowNode.style.display;C.toggle(this.domNode,"dijitTreeIsRoot",k);C.toggle(this.domNode,"dijitTreeIsLast",!k&&!this.getNextSibling())},_setExpando:function(k){var r=
["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];k=k?0:this.isExpandable?this.isExpanded?1:2:3;C.replace(this.expandoNode,r[k],r);this.expandoNodeText.innerHTML=["*","-","+","*"][k]},expand:function(){if(this._expandDeferred)return na(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&
this.containerNode.setAttribute("role","group");C.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var k=d.wipeIn({node:this.containerNode,duration:aa.defaultDuration}),r=this._expandDeferred=new u(function(){k.stop()});B.after(k,"onEnd",function(){r.resolve(!0)},!0);k.play();return na(r)},collapse:function(){if(this._collapseDeferred)return na(this._collapseDeferred);
this._expandDeferred&&(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");C.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var k=d.wipeOut({node:this.containerNode,duration:aa.defaultDuration}),r=this._collapseDeferred=new u(function(){k.stop()});B.after(k,"onEnd",
function(){r.resolve(!0)},!0);k.play();return na(r)},indent:0,setChildItems:function(k){var r=this.tree,R=r.model,U=[],ba=r.focusedChild,Fa=this.getChildren();F.forEach(Fa,function(la){T.prototype.removeChild.call(this,la)},this);this.defer(function(){F.forEach(Fa,function(la){if(!la._destroyed&&!la.getParent()){r.dndController.removeTreeNode(la);(function t(g){var H=R.getIdentity(g.item),W=r._itemNodesMap[H];1==W.length?delete r._itemNodesMap[H]:(H=F.indexOf(W,g),-1!=H&&W.splice(H,1));F.forEach(g.getChildren(),
t)})(la);if(r.persist){var a=F.map(la.getTreePath(),function(g){return r.model.getIdentity(g)}).join("/"),e;for(e in r._openedNodes)e.substr(0,a.length)==a&&delete r._openedNodes[e];r._saveExpandedNodes()}r.lastFocusedChild&&!z.isDescendant(r.lastFocusedChild.domNode,r.domNode)&&delete r.lastFocusedChild;ba&&!z.isDescendant(ba.domNode,r.domNode)&&r.focus();la.destroyRecursive()}})});this.state="Loaded";k&&0<k.length?(this.isExpandable=!0,F.forEach(k,function(la){var a=R.getIdentity(la),e=r._itemNodesMap[a];
if(e)for(var l=0;l<e.length;l++)if(e[l]&&!e[l].getParent()){var g=e[l];g.set("indent",this.indent+1);break}g||(g=this.tree._createTreeNode({item:la,tree:r,isExpandable:R.mayHaveChildren(la),label:r.getLabel(la),labelType:r.model&&r.model.labelType||"text",tooltip:r.getTooltip(la),ownerDocument:r.ownerDocument,dir:r.dir,lang:r.lang,textDir:r.textDir,indent:this.indent+1}),e?e.push(g):r._itemNodesMap[a]=[g]);this.addChild(g);(this.tree.autoExpand||this.tree._state(g))&&U.push(r._expandNode(g))},this),
F.forEach(this.getChildren(),function(la){la._updateLayout()})):this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);k=p(U);this.tree._startPaint(k);return na(k)},getTreePath:function(){for(var k=this,r=[];k&&k!==this.tree.rootNode;)r.unshift(k.item),k=k.getParent();r.unshift(this.tree.rootNode.item);return r},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(k){this.inherited(arguments);var r=this.getChildren();0==
r.length&&(this.isExpandable=!1,this.collapse());F.forEach(r,function(R){R._updateLayout()})},makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(k){this.labelNode.setAttribute("aria-selected",k?"true":"false");C.toggle(this.rowNode,"dijitTreeRowSelected",k)},focus:function(){N.focus(this.focusNode)}});f("dojo-bidi")&&Ea.extend({_setTextDirAttr:function(k){!k||this.textDir==k&&this._created||(this._set("textDir",k),this.applyTextDir(this.labelNode),F.forEach(this.getChildren(),
function(r){r.set("textDir",k)},this))}});var sa=y("dijit.Tree",[E,ta,ka,Y],{baseClass:"dijitTree",store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:Pa,persist:!1,autoExpand:!1,dndController:ua,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,
checkItemAcceptance:null,dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(k,r){A.publish(this.id,G.mixin({tree:this,event:k},r||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new u;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();var k=
this;this.own(M(this.containerNode,M.selector(".dijitTreeNode",O.enter),function(U){k._onNodeMouseEnter(S.byNode(this),U)}),M(this.containerNode,M.selector(".dijitTreeNode",O.leave),function(U){k._onNodeMouseLeave(S.byNode(this),U)}),M(this.containerNode,M.selector(".dijitTreeRow",J.press),function(U){k._onNodePress(S.getEnclosingWidget(this),U)}),M(this.containerNode,M.selector(".dijitTreeRow",J),function(U){k._onClick(S.getEnclosingWidget(this),U)}),M(this.containerNode,M.selector(".dijitTreeRow",
"dblclick"),function(U){k._onDblClick(S.getEnclosingWidget(this),U)}));this.model||this._store2model();this.own(B.after(this.model,"onChange",G.hitch(this,"_onItemChange"),!0),B.after(this.model,"onChildrenChange",G.hitch(this,"_onItemChildrenChange"),!0),B.after(this.model,"onDelete",G.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){G.isString(this.dndController)&&(this.dndController=G.getObject(this.dndController));for(var r={},R=0;R<this.dndParams.length;R++)this[this.dndParams[R]]&&
(r[this.dndParams[R]]=this[this.dndParams[R]]);this.dndController=new this.dndController(this,r)}this._load();this.onLoadDeferred=na(this.pendingCommandsPromise);this.onLoadDeferred.then(G.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;c.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var k={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(k.mayHaveChildren=
G.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&(k.getChildren=G.hitch(this,function(r,R,U){this.getItemChildren(this._v10Compat&&r===this.model.root?null:r,R,U)}));this.model=new Ya(k);this.showRoot=!!this.label},onLoad:function(){},_load:function(){this.model.getRoot(G.hitch(this,function(k){var r=this.rootNode=this.tree._createTreeNode({item:k,tree:this,isExpandable:!0,label:this.label||this.getLabel(k),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?
0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",!this.dndController.singular),this.rootLoadingIndicator.style.display="none"):(r.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(r.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(r.containerNode.setAttribute("aria-labelledby",
this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),r.labelNode.setAttribute("role","presentation"),r.labelNode.removeAttribute("aria-selected"),r.containerNode.setAttribute("role","tree"),r.containerNode.setAttribute("aria-expanded","true"),r.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(r.domNode);k=this.model.getIdentity(k);this._itemNodesMap[k]?this._itemNodesMap[k].push(r):this._itemNodesMap[k]=[r];r._updateLayout();
this._expandNode(r).then(G.hitch(this,function(){this._destroyed||(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),G.hitch(this,function(k){console.error(this,": error loading root: ",k)}))},getNodesByItem:function(k){if(!k)return[];k=G.isString(k)?k:this.model.getIdentity(k);return[].concat(this._itemNodesMap[k])},_setSelectedItemAttr:function(k){this.set("selectedItems",[k])},_setSelectedItemsAttr:function(k){var r=this;return this.pendingCommandsPromise=
this.pendingCommandsPromise.always(G.hitch(this,function(){var R=F.map(k,function(ba){return!ba||G.isString(ba)?ba:r.model.getIdentity(ba)}),U=[];F.forEach(R,function(ba){U=U.concat(r._itemNodesMap[ba]||[])});this.set("selectedNodes",U)}))},_setPathAttr:function(k){return k.length?na(this.set("paths",[k]).then(function(r){return r[0]})):na(this.set("paths",[]).then(function(r){return r[0]}))},_setPathsAttr:function(k){function r(U,ba){var Fa=U.shift(),la=F.filter(ba,function(a){return a.getIdentity()==
Fa})[0];if(la)return U.length?R._expandNode(la).then(function(){return r(U,la.getChildren())}):la;throw new sa.PathError("Could not expand path at "+Fa);}var R=this;return na(this.pendingCommandsPromise=this.pendingCommandsPromise.always(function(){return p(F.map(k,function(U){U=F.map(U,function(ba){return ba&&G.isObject(ba)?R.model.getIdentity(ba):ba});if(U.length)return r(U,[R.rootNode]);throw new sa.PathError("Empty path");}))}).then(function(U){R.set("selectedNodes",U);return R.paths}))},_setSelectedNodeAttr:function(k){this.set("selectedNodes",
[k])},_setSelectedNodesAttr:function(k){this.dndController.setSelection(k)},expandAll:function(){function k(R){return r._expandNode(R).then(function(){var U=F.filter(R.getChildren()||[],function(ba){return ba.isExpandable});return p(F.map(U,k))})}var r=this;return na(k(this.rootNode))},collapseAll:function(){function k(R){var U=F.filter(R.getChildren()||[],function(ba){return ba.isExpandable});U=p(F.map(U,k));return!R.isExpanded||R==r.rootNode&&!r.showRoot?U:U.then(function(){return r._collapseNode(R)})}
var r=this;return na(k(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},getLabel:function(k){return this.model.getLabel(k)},getIconClass:function(k,r){return!k||this.model.mayHaveChildren(k)?r?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(k,r){(k=this._getNext(r))&&k.isTreeNode&&this.focusNode(k)},
_onUpArrow:function(k,r){if(k=r.getPreviousSibling())for(r=k;r.isExpandable&&r.isExpanded&&r.hasChildren();)r=r.getChildren(),r=r[r.length-1];else if(k=r.getParent(),this.showRoot||k!==this.rootNode)r=k;r&&r.isTreeNode&&this.focusNode(r)},_onRightArrow:function(k,r){r.isExpandable&&!r.isExpanded?this._expandNode(r):r.hasChildren()&&(r=r.getChildren()[0])&&r.isTreeNode&&this.focusNode(r)},_onLeftArrow:function(k,r){r.isExpandable&&r.isExpanded?this._collapseNode(r):(k=r.getParent())&&k.isTreeNode&&
(this.showRoot||k!==this.rootNode)&&this.focusNode(k)},focusLastChild:function(){var k=this._getLast();k&&k.isTreeNode&&this.focusNode(k)},_getFirst:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var k=this.rootNode;k.isExpanded;){var r=k.getChildren();if(!r.length)break;k=r[r.length-1]}return k},_getNext:function(k){if(k.isExpandable&&k.isExpanded&&k.hasChildren())return k.getChildren()[0];for(;k&&k.isTreeNode;){var r=k.getNextSibling();if(r)return r;
k=k.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(k,r){return z.isDescendant(k,r.expandoNode)||z.isDescendant(k,r.expandoNodeText)},_onNodePress:function(k,r){this.focusNode(k)},__click:function(k,r,R,U){var ba=this.isExpandoNode(r.target,k);k.isExpandable&&(R||ba)?this._onExpandoClick({node:k}):(this._publish("execute",{item:k.item,node:k,evt:r}),this[U](k.item,k,r),this.focusNode(k));r.stopPropagation();r.preventDefault()},_onClick:function(k,r){this.__click(k,r,
this.openOnClick,"onClick")},_onDblClick:function(k,r){this.__click(k,r,this.openOnDblClick,"onDblClick")},_onExpandoClick:function(k){k=k.node;this.focusNode(k);k.isExpanded?this._collapseNode(k):this._expandNode(k)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(k){c.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(k)},_getRootOrFirstNode:function(){c.deprecated(this.declaredClass+
"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","","2.0");return this._getFirst()},_collapseNode:function(k){k._expandNodeDeferred&&delete k._expandNodeDeferred;if("Loading"!=k.state&&k.isExpanded){var r=k.collapse();this.onClose(k.item,k);this._state(k,!1);this._startPaint(r);return r}},_expandNode:function(k){if(k._expandNodeDeferred)return k._expandNodeDeferred;var r=this.model,R=k.item,U=this;k._loadDeferred||(k.markProcessing(),k._loadDeferred=new u,r.getChildren(R,function(ba){k.unmarkProcessing();
k.setChildItems(ba).then(function(){k._loadDeferred.resolve(ba)})},function(ba){console.error(U,": error loading "+k.label+" children: ",ba);k._loadDeferred.reject(ba)}));r=k._loadDeferred.then(G.hitch(this,function(){var ba=k.expand();this.onOpen(k.item,k);this._state(k,!0);return ba}));this._startPaint(r);return r},focusNode:function(k){for(var r=[],R=this.domNode;R&&R.tagName&&"IFRAME"!==R.tagName.toUpperCase();R=R.parentNode)r.push({domNode:R.contentWindow||R,scrollLeft:R.scrollLeft||0,scrollTop:R.scrollTop||
0});this.focusChild(k);this.defer(function(){for(var U=0,ba=r.length;U<ba;U++)r[U].domNode.scrollLeft=r[U].scrollLeft,r[U].domNode.scrollTop=r[U].scrollTop},0)},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(k){var r=this.model.getIdentity(k);if(r=this._itemNodesMap[r]){var R=this.getLabel(k),U=this.getTooltip(k);F.forEach(r,function(ba){ba.set({item:k,label:R,tooltip:U});ba._updateItemClasses(k)})}},_onItemChildrenChange:function(k,r){k=this.model.getIdentity(k);
(k=this._itemNodesMap[k])&&F.forEach(k,function(R){R.setChildItems(r)})},_onItemDelete:function(k){k=this.model.getIdentity(k);var r=this._itemNodesMap[k];r&&(F.forEach(r,function(R){this.dndController.removeTreeNode(R);var U=R.getParent();U&&U.removeChild(R);this.lastFocusedChild&&!z.isDescendant(this.lastFocusedChild.domNode,this.domNode)&&delete this.lastFocusedChild;this.focusedChild&&!z.isDescendant(this.focusedChild.domNode,this.domNode)&&this.focus();R.destroyRecursive()},this),delete this._itemNodesMap[k])},
_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var k=v(this.cookieName);k&&F.forEach(k.split(","),function(r){this._openedNodes[r]=!0},this)}},_state:function(k,r){if(!this.persist)return!1;var R=F.map(k.getTreePath(),function(U){return this.model.getIdentity(U)},this).join("/");if(1===arguments.length)return this._openedNodes[R];r?this._openedNodes[R]=!0:delete this._openedNodes[R];this._saveExpandedNodes()},_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var k=
[],r;for(r in this._openedNodes)k.push(r);v(this.cookieName,k.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!G.isString(this.dndController)&&this.dndController.destroy();this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},resize:function(k){k&&x.setMarginBox(this.domNode,k);this._nodePixelIndent=x.position(this.tree.indentDetector).w||
this._nodePixelIndent;this.expandChildrenDeferred.then(G.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},_outstandingPaintOperations:0,_startPaint:function(k){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);var r=G.hitch(this,function(){this._outstandingPaintOperations--;0>=this._outstandingPaintOperations&&!this._adjustWidthsTimer&&this._started&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});
D(k,r,r)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(k){return new Ea(k)},focus:function(){this.lastFocusedChild?this.focusNode(this.lastFocusedChild):this.focusFirstChild()}});f("dojo-bidi")&&sa.extend({_setTextDirAttr:function(k){k&&this.textDir!=k&&(this._set("textDir",
k),this.rootNode.set("textDir",k))}});sa.PathError=h("TreePathError");sa._TreeNode=Ea;return sa})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(F,B,v,y){return v("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,constructor:function(u){y.mixin(this,u);this.connects=[];u=this.store;if(!u.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");
u.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([B.after(u,"onNew",y.hitch(this,"onNewItem"),!0),B.after(u,"onDelete",y.hitch(this,"onDeleteItem"),!0),B.after(u,"onSet",y.hitch(this,"onSetItem"),!0)]))},destroy:function(){for(var u;u=this.connects.pop();)u.remove()},getRoot:function(u,p){this.root?u(this.root):this.store.fetch({query:this.query,onComplete:y.hitch(this,function(z){if(1!=z.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+z.length+
" items, but must return exactly one");this.root=z[0];u(this.root)}),onError:p})},mayHaveChildren:function(u){return F.some(this.childrenAttrs,function(p){return this.store.hasAttribute(u,p)},this)},getChildren:function(u,p,z){var C=this.store;if(C.isItemLoaded(u)){for(var x=[],m=0;m<this.childrenAttrs.length;m++){var h=C.getValues(u,this.childrenAttrs[m]);x=x.concat(h)}var d=0;this.deferItemLoadingUntilExpand||F.forEach(x,function(c){C.isItemLoaded(c)||d++});0==d?p(x):F.forEach(x,function(c,w){C.isItemLoaded(c)||
C.loadItem({item:c,onItem:function(G){x[w]=G;0==--d&&p(x)},onError:z})})}else{var f=y.hitch(this,arguments.callee);C.loadItem({item:u,onItem:function(c){f(c,p,z)},onError:z})}},isItem:function(u){return this.store.isItem(u)},fetchItemByIdentity:function(u){this.store.fetchItemByIdentity(u)},getIdentity:function(u){return this.store.getIdentity(u)},getLabel:function(u){return this.labelAttr?this.store.getValue(u,this.labelAttr):this.store.getLabel(u)},newItem:function(u,p,z){var C={parent:p,attribute:this.childrenAttrs[0]},
x;this.newItemIdAttr&&u[this.newItemIdAttr]?this.fetchItemByIdentity({identity:u[this.newItemIdAttr],scope:this,onItem:function(m){m?this.pasteItem(m,null,p,!0,z):(x=this.store.newItem(u,C))&&void 0!=z&&this.pasteItem(x,p,p,!1,z)}}):(x=this.store.newItem(u,C))&&void 0!=z&&this.pasteItem(x,p,p,!1,z)},pasteItem:function(u,p,z,C,x){var m=this.store,h=this.childrenAttrs[0];p&&F.forEach(this.childrenAttrs,function(f){if(m.containsValue(p,f,u)){if(!C){var c=F.filter(m.getValues(p,f),function(w){return w!=
u});m.setValues(p,f,c)}h=f}});if(z)if("number"==typeof x){var d=m.getValues(z,h).slice();d.splice(x,0,u);m.setValues(z,h,d)}else m.setValues(z,h,m.getValues(z,h).concat(u))},onChange:function(){},onChildrenChange:function(){},onDelete:function(){},onNewItem:function(u,p){p&&this.getChildren(p.item,y.hitch(this,function(z){this.onChildrenChange(p.item,z)}))},onDeleteItem:function(u){this.onDelete(u)},onSetItem:function(u,p){if(-1!=F.indexOf(this.childrenAttrs,p))this.getChildren(u,y.hitch(this,function(z){this.onChildrenChange(u,
z)}));else this.onChange(u)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(F,B,v,y,u){return B("dijit.tree.ForestStoreModel",u,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(p){this.root={store:this,root:!0,id:p.rootId,label:p.rootLabel,children:p.rootChildren}},mayHaveChildren:function(p){return p===this.root||this.inherited(arguments)},getChildren:function(p,z,C){p===
this.root?this.root.children?z(this.root.children):this.store.fetch({query:this.query,onComplete:y.hitch(this,function(x){this.root.children=x;z(x)}),onError:C}):this.inherited(arguments)},isItem:function(p){return p===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(p){if(p.identity==this.root.id){var z=p.scope||v.global;p.onItem&&p.onItem.call(z,this.root)}else this.inherited(arguments)},getIdentity:function(p){return p===this.root?this.root.id:this.inherited(arguments)},getLabel:function(p){return p===
this.root?this.root.label:this.inherited(arguments)},newItem:function(p,z,C){return z===this.root?(this.onNewRootItem(p),this.store.newItem(p)):this.inherited(arguments)},onNewRootItem:function(){},pasteItem:function(p,z,C,x,m){if(z===this.root&&!x)this.onLeaveRoot(p);this.inherited(arguments,[p,z===this.root?null:z,C===this.root?null:C,x,m]);if(C===this.root)this.onAddToRoot(p)},onAddToRoot:function(p){console.log(this,": item ",p," added to root")},onLeaveRoot:function(p){console.log(this,": item ",
p," removed from root")},_requeryTop:function(){var p=this.root.children||[];this.store.fetch({query:this.query,onComplete:y.hitch(this,function(z){this.root.children=z;if(p.length!=z.length||F.some(p,function(C,x){return z[x]!=C}))this.onChildrenChange(this.root,z)})})},onNewItem:function(p,z){this._requeryTop();this.inherited(arguments)},onDeleteItem:function(p){-1!=F.indexOf(this.root.children,p)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(p,z,C,x){this._requeryTop();this.inherited(arguments)}})})},
"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),function(F,B,v,y,u,p,z,C,x,m,h){return B("dijit.tree._dndSelector",h,{constructor:function(){this.selection={};this.anchor=null;this.events.push(C(this.tree.domNode,x.press,y.hitch(this,"onMouseDown")),C(this.tree.domNode,x.release,y.hitch(this,"onMouseUp")),C(this.tree.domNode,x.move,y.hitch(this,
"onMouseMove")),C(this.tree.domNode,m.press,y.hitch(this,"onClickPress")),C(this.tree.domNode,m.release,y.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var d=[],f=this.selection,c;for(c in f)d.push(f[c]);return d},selectNone:function(){this.setSelection([]);return this},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null},addTreeNode:function(d,f){this.setSelection(this.getSelectedTreeNodes().concat([d]));f&&(this.anchor=d);return d},removeTreeNode:function(d){var f=
F.filter(this.getSelectedTreeNodes(),function(c){return!p.isDescendant(c.domNode,d.domNode)});this.setSelection(f);return d},isTreeNodeSelected:function(d){return d.id&&!!this.selection[d.id]},setSelection:function(d){var f=this.getSelectedTreeNodes();F.forEach(this._setDifference(f,d),y.hitch(this,function(c){c.setSelected(!1);this.anchor==c&&delete this.anchor;delete this.selection[c.id]}));F.forEach(this._setDifference(d,f),y.hitch(this,function(c){c.setSelected(!0);this.selection[c.id]=c}));this._updateSelectionProperties()},
_setDifference:function(d,f){F.forEach(f,function(c){c.__exclude__=!0});d=F.filter(d,function(c){return!c.__exclude__});F.forEach(f,function(c){delete c.__exclude__});return d},_updateSelectionProperties:function(){var d=this.getSelectedTreeNodes(),f=[],c=[];F.forEach(d,function(w){var G=w.getTreePath();c.push(w);f.push(G)},this);d=F.map(c,function(w){return w.item});this.tree._set("paths",f);this.tree._set("path",f[0]||[]);this.tree._set("selectedNodes",c);this.tree._set("selectedNode",c[0]||null);
this.tree._set("selectedItems",d);this.tree._set("selectedItem",d[0]||null)},onClickPress:function(d){if(!(this.current&&this.current.isExpandable&&this.tree.isExpandoNode(d.target,this.current))){"mousedown"==d.type&&z.isLeft(d)&&d.preventDefault();var f="keydown"==d.type?this.tree.focusedChild:this.current;if(f){var c=u.getCopyKeyState(d),w=f.id;this.singular||d.shiftKey||!this.selection[w]?(this._doDeselect=!1,this.userSelect(f,c,d.shiftKey)):this._doDeselect=!0}}},onClickRelease:function(d){this._doDeselect&&
(this._doDeselect=!1,this.userSelect("keyup"==d.type?this.tree.focusedChild:this.current,u.getCopyKeyState(d),d.shiftKey))},onMouseMove:function(){this._doDeselect=!1},onMouseDown:function(){},onMouseUp:function(){},_compareNodes:function(d,f){if(d===f)return 0;if("sourceIndex"in document.documentElement)return d.sourceIndex-f.sourceIndex;if("compareDocumentPosition"in document.documentElement)return d.compareDocumentPosition(f)&2?1:-1;if(document.createRange){var c=doc.createRange();c.setStartBefore(d);
d=doc.createRange();d.setStartBefore(f);return c.compareBoundaryPoints(c.END_TO_END,d)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");},userSelect:function(d,f,c){if(this.singular)this.anchor==d&&f?this.selectNone():(this.setSelection([d]),this.anchor=d);else if(c&&this.anchor){f=this._compareNodes(this.anchor.rowNode,d.rowNode);c=this.anchor;0>f?f=c:(f=d,d=c);for(c=[];f!=d;)c.push(f),f=this.tree._getNext(f);c.push(d);this.setSelection(c)}else this.selection[d.id]&&
f?this.removeTreeNode(d):f?this.addTreeNode(d,!0):(this.setSelection([d]),this.anchor=d)},getItem:function(d){return{data:this.selection[d],type:["treeNode"]}},forInSelectedItems:function(d,f){f=f||v.global;for(var c in this.selection)d.call(f,this.getItem(c),c,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),function(F,B,v,y,u,p){return B("dijit.tree._dndContainer",null,{constructor:function(z,C){this.tree=
z;this.node=z.domNode;y.mixin(this,C);this.containerState="";v.add(this.node,"dojoDndContainer");this.events=[u(this.node,p.enter,y.hitch(this,"onOverEvent")),u(this.node,p.leave,y.hitch(this,"onOutEvent")),F.after(this.tree,"_onNodeMouseEnter",y.hitch(this,"onMouseOver"),!0),F.after(this.tree,"_onNodeMouseLeave",y.hitch(this,"onMouseOut"),!0),u(this.node,"dragstart, selectstart",function(x){x.preventDefault()})]},destroy:function(){for(var z;z=this.events.pop();)z.remove();this.node=this.parent=
null},onMouseOver:function(z){this.current=z},onMouseOut:function(){this.current=null},_changeState:function(z,C){var x="dojoDnd"+z;z=z.toLowerCase()+"State";v.replace(this.node,x+C,x+this[z]);this[z]=C},_addItemClass:function(z,C){v.add(z,"dojoDndItem"+C)},_removeItemClass:function(z,C){v.remove(z,"dojoDndItem"+C)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container","")}})})},"widgets/Bookmark/setting/Import":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting jimu/utils ../utils ../ItemNode dojo/text!./Import.html libs/Sortable".split(" "),
function(F,B,v,y,u,p,z,C,x,m,h,d){return F([z,p],{baseClass:"jimu-Bookmark-Import",templateString:h,bookmarks:[],_selectedBookMarksNumber:0,postCreate:function(){this.inherited(arguments);this.sortableBookMarkerNodes=d.create(this.bookMarkerContainer,{handle:".drag-masker",sort:!1,disabled:!this._init_editing,animation:100});this.bookmarks=x.readBookmarksInWebmap(this.map);this.displayBookmarks(this.bookmarks);this.bookmarks&&0===this.bookmarks.length?v.addClass(this.bookmarksInWebmap,"hide"):v.addClass(this.noBookmark,
"hide");this.own(u(this.all,"change",B.hitch(this,function(){this._selectOrUnselectAll()})))},startup:function(){this.bookmarksInSetting&&this.bookmarksInSetting.forEach(B.hitch(this,function(f){if((f=x.findBookMarkByNameAndExtent(f,this.bookmarks))&&f.bookmark)f.bookmark.itemNode.onSelected()}))},getConfig:function(){var f=[];this.bookmarks.forEach(B.hitch(this,function(c){c.itemNode&&c.itemNode.domNode&&v.hasClass(c.itemNode.domNode,"selected")&&(delete c.itemNode,c=B.clone(c),f.push(c))}));return f},
_isSelectedAll:function(){return this.bookmarks.length===this._selectedBookMarksNumber},_selectOrUnselectAll:function(){this._isSelectedAll()?(this.bookmarks.forEach(B.hitch(this,function(f){f.itemNode&&f.itemNode.domNode&&v.hasClass(f.itemNode.domNode,"selected")&&v.removeClass(f.itemNode.domNode,"selected")})),this._selectedBookMarksNumber=0):this.bookmarks.forEach(B.hitch(this,function(f){f.itemNode&&f.itemNode.domNode&&!1===v.hasClass(f.itemNode.domNode,"selected")&&(v.addClass(f.itemNode.domNode,
"selected"),this._selectedBookMarksNumber++)}))},destroy:function(){y.forEach(this.bookmarks,function(f){f.itemNode&&f.itemNode.destroy()},this);this.bookmarks=[];this.sortableBookMarkerNodes&&(this.sortableBookMarkerNodes.destroy(),this.sortableBookMarkerNodes=null);this.inherited(arguments)},displayBookmarks:function(f){f.reverse();y.forEach(f,function(c,w){w=this._createBookMarkNode(c,w);c.itemNode=w},this);f.forEach(B.hitch(this,function(c){c.itemNode&&c.itemNode.domNode&&v.place(c.itemNode.domNode,
this.bookMarkerContainer,"first")}))},_createBookMarkNode:function(f,c){var w=f.thumbnail||"undefined"!==typeof f.thumbnail&&""!==f.thumbnail?C.processUrlInWidgetConfig(f.thumbnail,this.folderUrl):this.folderUrl+"images/thumbnail_default.png";f=new m({dataId:c,img:w,label:f.displayName||f.name,display:{selectedBtn:!0,editBtn:!1,deleteBtn:!1},nls:this.nls});this.own(u(f,"click",B.hitch(this,B.partial(this._onBookmarkClick,f))));this.own(u(f,"selected",B.hitch(this,B.partial(this._onBookmarkSelected,
f))));this.own(u(f,"unselected",B.hitch(this,B.partial(this._onBookmarkUnSelected,f))));return f},_onBookmarkClick:function(f){f.onSelected()},_onBookmarkSelected:function(){this._selectedBookMarksNumber++;this._isDisableOK()},_onBookmarkUnSelected:function(){this._selectedBookMarksNumber--;this._isDisableOK()},_isDisableOK:function(){this.popup&&(0<this._selectedBookMarksNumber?this.popup.enableButton(0):this.popup.disableButton(0),x.setCheckboxWithoutEvent(this.all,this._isSelectedAll()))}})})},
"libs/Sortable":function(){!function(F){"function"==typeof define&&define.amd?define(F):"undefined"!=typeof module&&void 0!==module.exports?module.exports=F():window.Sortable=F()}(function(){function F(b,n){if(!b||!b.nodeType||1!==b.nodeType)throw"Sortable: `el` must be HTMLElement, not "+{}.toString.call(b);this.el=b;this.options=n=O({},n);b[fa]=this;var q={group:null,sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0,draggable:/[uo]l/i.test(b.nodeName)?
"\x3eli":"\x3e*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return xb(b,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(L,P){L.setData("Text",P.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,touchStartThreshold:ya(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",
fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==F.supportPointer&&("PointerEvent"in window||window.navigator&&"msPointerEnabled"in window.navigator),emptyInsertThreshold:5},K;for(K in q)K in n||(n[K]=q[K]);for(var I in yb(n),this)"_"===I.charAt(0)&&"function"==typeof this[I]&&(this[I]=this[I].bind(this));(this.nativeDraggable=!n.forceFallback&&Lb)&&(this.options.touchStartThreshold=1);n.supportPointer?v(b,"pointerdown",this._onTapStart):(v(b,"mousedown",this._onTapStart),
v(b,"touchstart",this._onTapStart));this.nativeDraggable&&(v(b,"dragover",this),v(b,"dragenter",this));ha.push(this.el);n.store&&n.store.get&&this.sort(n.store.get(this)||[])}function B(b,n,q,K){if(b){q=q||Z;do{if(null!=n&&("\x3e"===n[0]&&b.parentNode===q&&M(b,n.substring(1))||M(b,n))||K&&b===q)return b;if(b===q)break}while(b=(I=b).host&&I!==Z&&I.host.nodeType?I.host:I.parentNode)}var I;return null}function v(b,n,q){b.addEventListener(n,q,zb)}function y(b,n,q){b.removeEventListener(n,q,zb)}function u(b,
n,q){if(b&&n)if(b.classList)b.classList[q?"add":"remove"](n);else{var K=(" "+b.className+" ").replace(ra," ").replace(" "+n+" "," ");b.className=(K+(q?" "+n:"")).replace(ra," ")}}function p(b,n,q){var K=b&&b.style;if(K){if(void 0===q)return Z.defaultView&&Z.defaultView.getComputedStyle?q=Z.defaultView.getComputedStyle(b,""):b.currentStyle&&(q=b.currentStyle),void 0===n?q:q[n];n in K||-1!==n.indexOf("webkit")||(n="-webkit-"+n);K[n]=q+("string"==typeof q?"":"px")}}function z(b){var n="";do{var q=p(b,
"transform");q&&"none"!==q&&(n=q+" "+n)}while(b=b.parentNode);return window.DOMMatrix?new DOMMatrix(n):window.WebKitCSSMatrix?new WebKitCSSMatrix(n):window.CSSMatrix?new CSSMatrix(n):void 0}function C(b,n,q){if(b){b=b.getElementsByTagName(n);n=0;var K=b.length;if(q)for(;n<K;n++)q(b[n],n);return b}return[]}function x(b,n,q,K,I,L,P,X,V){var ea,ma=(b=b||n[fa]).options,pa="on"+q.charAt(0).toUpperCase()+q.substr(1);!window.CustomEvent||Ga||bb?(ea=Z.createEvent("Event")).initEvent(q,!0,!0):ea=new CustomEvent(q,
{bubbles:!0,cancelable:!0});ea.to=I||n;ea.from=L||n;ea.item=K||n;ea.clone=ca;ea.oldIndex=P;ea.newIndex=X;ea.originalEvent=V;ea.pullMode=sa?sa.lastPutMode:void 0;n&&n.dispatchEvent(ea);ma[pa]&&ma[pa].call(b,ea)}function m(b,n,q,K,I,L,P,X){var V,ea,ma=b[fa],pa=ma.options.onMove;return!window.CustomEvent||Ga||bb?(V=Z.createEvent("Event")).initEvent("move",!0,!0):V=new CustomEvent("move",{bubbles:!0,cancelable:!0}),V.to=n,V.from=b,V.dragged=q,V.draggedRect=K,V.related=I||n,V.relatedRect=L||N(n),V.willInsertAfter=
X,V.originalEvent=P,b.dispatchEvent(V),pa&&(ea=pa.call(ma,V,P)),ea}function h(b){b.draggable=!1}function d(){nb=!1}function f(b,n,q){for(var K=0,I=0,L=b.children;I<L.length;){if("none"!==L[I].style.display&&L[I]!==T&&L[I]!==E&&B(L[I],q.draggable,b,!1)){if(K===n)return L[I];K++}I++}return null}function c(b){for(b=b.lastElementChild;b&&(b===T||"none"===b.style.display);)b=b.previousElementSibling;return b||null}function w(b){return G(E)<G(b)?1:-1}function G(b,n){n=0;if(!b||!b.parentNode)return-1;for(;b&&
(b=b.previousElementSibling);)"TEMPLATE"!==b.nodeName.toUpperCase()&&b!==ca&&n++;return n}function M(b,n){if(b)try{if(b.matches)return b.matches(n);if(b.msMatchesSelector)return b.msMatchesSelector(n);if(b.webkitMatchesSelector)return b.webkitMatchesSelector(n)}catch(q){}return!1}function A(b,n){return function(){if(!cb){var q=arguments,K=this;cb=$a(function(){1===q.length?b.call(K,q[0]):b.apply(K,q);cb=void 0},n)}}}function O(b,n){if(b&&n)for(var q in n)n.hasOwnProperty(q)&&(b[q]=n[q]);return b}
function D(b){return ob&&ob.dom?ob.dom(b).cloneNode(!0):Ab?Ab(b).clone(!0)[0]:b.cloneNode(!0)}function J(b){return $a(b,0)}function N(b,n,q,K){if(b.getBoundingClientRect||b===qa){var I,L,P,X,V,ea,ma;if(ma=b!==qa&&b!==Ra()?(L=(I=b.getBoundingClientRect()).top,P=I.left,X=I.bottom,V=I.right,ea=I.height,I.width):(P=L=0,X=window.innerHeight,V=window.innerWidth,ea=window.innerHeight,window.innerWidth),K&&b!==qa&&(q=q||b.parentNode,!Ga)){do if(q&&q.getBoundingClientRect&&"none"!==p(q,"transform")){X=q.getBoundingClientRect();
L-=X.top+ya(p(q,"border-top-width"));P-=X.left+ya(p(q,"border-left-width"));X=L+I.height;V=P+I.width;break}while(q=q.parentNode)}n&&b!==qa&&(n=(b=z(q||b))&&b.a,q=b&&b.d,b&&(X=(L/=q)+(ea/=q),V=(P/=n)+(ma/=n)));return{top:L,left:P,bottom:X,right:V,width:ma,height:ea}}}function S(b,n){var q=Va(b,!0);for(b=N(b)[n];q;){var K=N(q)[n];if(!("top"===n||"left"===n?K<=b:b<=K))return q;if(q===Ra())break;q=Va(q,!1)}return!1}function aa(b){var n=0,q=0,K=Ra();if(b){do{var I=z(b),L=I.d;n+=b.scrollLeft*I.a;q+=b.scrollTop*
L}while(b!==K&&(b=b.parentNode))}return[n,q]}if("undefined"==typeof window||!window.document)return function(){throw Error("Sortable.js requires a window with a document");};var E,ka,T,ca,Y,ta,Ka,Pa,Ua,Ya,ua,na,Ea,sa,k,r,R,U,ba,Fa,la,a,e,l,g,t,H=[],W=!1,ja=!1,da=!1,ha=[],Q=!1,ia=!1,oa=[],ra=/\s+/g,fa="Sortable"+(new Date).getTime(),qa=window,Z=qa.document,ya=qa.parseInt,$a=qa.setTimeout,Ab=qa.jQuery||qa.Zepto,ob=qa.Polymer,zb={capture:!1,passive:!1},Ga=!!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\.|msie|iemobile)/i),
bb=!!navigator.userAgent.match(/Edge/i),Bb=!!navigator.userAgent.match(/firefox/i),pb=!(!navigator.userAgent.match(/safari/i)||navigator.userAgent.match(/chrome/i)||navigator.userAgent.match(/android/i)),fb=!!navigator.userAgent.match(/iP(ad|od|hone)/i),Cb=bb||Ga?"cssFloat":"float",Lb="draggable"in Z.createElement("div"),qb=function(){if(Ga)return!1;var b=Z.createElement("x");return b.style.cssText="pointer-events:auto","auto"===b.style.pointerEvents}(),nb=!1,rb=!1,Sa=Math.abs,Mb=Math.min,Nb=Math.max,
gb=[],xb=function(b,n){var q=p(b),K=ya(q.width)-ya(q.paddingLeft)-ya(q.paddingRight)-ya(q.borderLeftWidth)-ya(q.borderRightWidth),I=f(b,0,n);b=f(b,1,n);var L=I&&p(I);n=b&&p(b);var P=L&&ya(L.marginLeft)+ya(L.marginRight)+N(I).width,X=n&&ya(n.marginLeft)+ya(n.marginRight)+N(b).width;return"flex"===q.display?"column"===q.flexDirection||"column-reverse"===q.flexDirection?"vertical":"horizontal":"grid"===q.display?1>=q.gridTemplateColumns.split(" ").length?"vertical":"horizontal":I&&"none"!==L.float?(q=
"left"===L.float?"left":"right",!b||"both"!==n.clear&&n.clear!==q?"horizontal":"vertical"):I&&("block"===L.display||"flex"===L.display||"table"===L.display||"grid"===L.display||K<=P&&"none"===q[Cb]||b&&"none"===q[Cb]&&K<P+X)?"vertical":"horizontal"},Va=function(b,n){if(!b||!b.getBoundingClientRect)return Ra();var q=!1;do if(b.clientWidth<b.scrollWidth||b.clientHeight<b.scrollHeight){var K=p(b);if(b.clientWidth<b.scrollWidth&&("auto"==K.overflowX||"scroll"==K.overflowX)||b.clientHeight<b.scrollHeight&&
("auto"==K.overflowY||"scroll"==K.overflowY)){if(!b||!b.getBoundingClientRect||b===Z.body)break;if(q||n)return b;q=!0}}while(b=b.parentNode);return Ra()},Ra=function(){return Ga?Z.documentElement:Z.scrollingElement},Db=function(b,n,q){b.scrollLeft+=n;b.scrollTop+=q},sb=A(function(b,n,q,K){if(n.scroll){var I=q?q[fa]:window,L=n.scrollSensitivity,P=n.scrollSpeed,X=b.clientX,V=b.clientY,ea=Ra(),ma=!1;Ua!==q&&(hb(),Pa=n.scroll,Ya=n.scrollFn,!0===Pa&&(Pa=Va(q,!0),Ua=Pa));q=0;var pa=Pa;do{var va,La,wa,Qa,
Ha,za,Ma,Na,Aa=pa;var Ca=N(Aa);var Ta=Ca.top,db=Ca.bottom,ib=Ca.left,jb=Ca.right,Ia=Ca.width,xa=Ca.height;if(va=Aa.scrollWidth,La=Aa.scrollHeight,wa=p(Aa),Ma=Aa.scrollLeft,Na=Aa.scrollTop,za=Aa===ea?(Ha=Ia<va&&("auto"===wa.overflowX||"scroll"===wa.overflowX||"visible"===wa.overflowX),xa<La&&("auto"===wa.overflowY||"scroll"===wa.overflowY||"visible"===wa.overflowY)):(Ha=Ia<va&&("auto"===wa.overflowX||"scroll"===wa.overflowX),xa<La&&("auto"===wa.overflowY||"scroll"===wa.overflowY)),Ca=Ha&&(Sa(jb-X)<=
L&&Ma+Ia<va)-(Sa(ib-X)<=L&&!!Ma),Qa=za&&(Sa(db-V)<=L&&Na+xa<La)-(Sa(Ta-V)<=L&&!!Na),!H[q])for(Ta=0;Ta<=q;Ta++)H[Ta]||(H[Ta]={});H[q].vx==Ca&&H[q].vy==Qa&&H[q].el===Aa||(H[q].el=Aa,H[q].vx=Ca,H[q].vy=Qa,clearInterval(H[q].pid),!Aa||0==Ca&&0==Qa||(ma=!0,H[q].pid=setInterval(function(){K&&0===this.layer&&(F.active._emulateDragOver(!0),F.active._onTouchMove(ba,!0));var Ja=H[this.layer].vy?H[this.layer].vy*P:0,Da=H[this.layer].vx?H[this.layer].vx*P:0;"function"==typeof Ya&&"continue"!==Ya.call(I,Da,Ja,
b,ba,H[this.layer].el)||Db(H[this.layer].el,Da,Ja)}.bind({layer:q}),24)));q++}while(n.bubbleScroll&&pa!==ea&&(pa=Va(pa,!1)));W=ma}},30),hb=function(){H.forEach(function(b){clearInterval(b.pid)});H=[]},yb=function(b){function n(I,L){return function(P,X,V,ea){var ma=P.options.group.name&&X.options.group.name&&P.options.group.name===X.options.group.name;if(null==I&&(L||ma))return!0;if(null==I||!1===I)return!1;if(L&&"clone"===I)return I;if("function"==typeof I)return n(I(P,X,V,ea),L)(P,X,V,ea);P=(L?P:
X).options.group.name;return!0===I||"string"==typeof I&&I===P||I.join&&-1<I.indexOf(P)}}var q={},K=b.group;K&&"object"==typeof K||(K={name:K});q.name=K.name;q.checkPull=n(K.pull,!0);q.checkPut=n(K.put);q.revertClone=K.revertClone;b.group=q},Eb=function(b){E&&E.parentNode&&E.parentNode[fa]&&E.parentNode[fa]._computeIsAligned(b)},Fb=function(b,n){for(;!n[fa];)n=n.parentNode;return b===n},Gb=function(b,n,q){for(b=b.parentNode;b&&!b[fa];)b=b.parentNode;b&&b[fa][q](O(n,{artificialBubble:!0}))},Hb=function(){!qb&&
T&&p(T,"display","none")},Ib=function(){!qb&&T&&p(T,"display","")};Z.addEventListener("click",function(b){if(da)return b.preventDefault(),b.stopPropagation&&b.stopPropagation(),b.stopImmediatePropagation&&b.stopImmediatePropagation(),da=!1},!0);var cb,tb=function(b){if(b=b.touches?b.touches[0]:b,E){a:{var n=b.clientX;for(var q=b.clientY,K=0;K<ha.length;K++)if(!c(ha[K])){var I=N(ha[K]),L=ha[K][fa].options.emptyInsertThreshold,P=q>=I.top-L&&q<=I.bottom+L;if(n>=I.left-L&&n<=I.right+L&&P){n=ha[K];break a}}n=
void 0}n&&n[fa]._onDragOver({clientX:b.clientX,clientY:b.clientY,target:n,rootEl:n})}};return v(Z,"dragover",tb),v(Z,"mousemove",tb),v(Z,"touchmove",tb),F.prototype={constructor:F,_computeIsAligned:function(b){var n;if(T&&!qb?(Hb(),n=Z.elementFromPoint(b.clientX,b.clientY),Ib()):n=b.target,n=B(n,this.options.draggable,this.el,!1),!rb&&E&&E.parentNode===this.el){for(var q,K,I,L,P,X,V,ea,ma=this.el.children,pa=0;pa<ma.length;pa++)B(ma[pa],this.options.draggable,this.el,!1)&&ma[pa]!==n&&(ma[pa].sortableMouseAligned=
(q=b.clientX,K=b.clientY,I=ma[pa],L=this._getDirection(b,null),this.options,void 0,P=N(I),X="vertical"===L?P.left:P.top,V="vertical"===L?P.right:P.bottom,X<(ea="vertical"===L?q:K)&&ea<V));B(n,this.options.draggable,this.el,!0)||(la=null);rb=!0;$a(function(){rb=!1},30)}},_getDirection:function(b,n){return"function"==typeof this.options.direction?this.options.direction.call(this,b,n,E):this.options.direction},_onTapStart:function(b){if(b.cancelable){var n,q=this,K=this.el,I=this.options,L=I.preventOnFilter,
P=b.type,X=b.touches&&b.touches[0],V=(X||b).target,ea=b.target.shadowRoot&&(b.path&&b.path[0]||b.composedPath&&b.composedPath()[0])||V,ma=I.filter;if(function(pa){gb.length=0;pa=pa.getElementsByTagName("input");for(var va=pa.length;va--;){var La=pa[va];La.checked&&gb.push(La)}}(K),!(Ga&&!b.artificialBubble&&!Fb(K,V)||E||/mousedown|pointerdown/.test(P)&&0!==b.button||I.disabled||ea.isContentEditable))if(V=B(V,I.draggable,K,!1)){if(Ka!==V){if(n=G(V,I.draggable),"function"==typeof ma){if(ma.call(this,
b,V,this))return x(q,ea,"filter",V,K,K,n),void(L&&b.cancelable&&b.preventDefault())}else if(ma&&(ma=ma.split(",").some(function(pa){if(pa=B(ea,pa.trim(),K,!1))return x(q,pa,"filter",V,K,K,n),!0})))return void(L&&b.cancelable&&b.preventDefault());I.handle&&!B(ea,I.handle,K,!1)||this._prepareDragStart(b,X,V,n)}}else Ga&&Gb(K,b,"_onTapStart")}},_handleAutoScroll:function(b,n){if(E&&this.options.scroll){var q=b.clientX,K=b.clientY,I=Z.elementFromPoint(q,K),L=this;if(n||bb||Ga||pb){sb(b,L.options,I,n);
var P=Va(I,!0);!W||k&&q===r&&K===R||(k&&clearInterval(k),k=setInterval(function(){if(E){var X=Va(Z.elementFromPoint(q,K),!0);X!==P&&(P=X,hb(),sb(b,L.options,P,n))}},10),r=q,R=K)}else{if(!L.options.bubbleScroll||Va(I,!0)===Ra())return void hb();sb(b,L.options,Va(I,!1),!1)}}},_prepareDragStart:function(b,n,q,K){var I,L=this,P=L.el,X=L.options,V=P.ownerDocument;q&&!E&&q.parentNode===P&&(Y=P,ka=(E=q).parentNode,ta=E.nextSibling,Ka=q,Ea=X.group,ua=K,U={target:E,clientX:(n||b).clientX,clientY:(n||b).clientY},
this._lastX=(n||b).clientX,this._lastY=(n||b).clientY,E.style["will-change"]="all",E.style.transition="",E.style.transform="",I=function(){L._disableDelayedDragEvents();!Bb&&L.nativeDraggable&&(E.draggable=!0);L._triggerDragStart(b,n);x(L,Y,"choose",E,Y,Y,ua);u(E,X.chosenClass,!0)},X.ignore.split(",").forEach(function(ea){C(E,ea.trim(),h)}),X.supportPointer?v(V,"pointerup",L._onDrop):(v(V,"mouseup",L._onDrop),v(V,"touchend",L._onDrop),v(V,"touchcancel",L._onDrop)),Bb&&this.nativeDraggable&&(this.options.touchStartThreshold=
4,E.draggable=!0),!X.delay||this.nativeDraggable&&(bb||Ga)?I():(v(V,"mouseup",L._disableDelayedDrag),v(V,"touchend",L._disableDelayedDrag),v(V,"touchcancel",L._disableDelayedDrag),v(V,"mousemove",L._delayedDragTouchMoveHandler),v(V,"touchmove",L._delayedDragTouchMoveHandler),X.supportPointer&&v(V,"pointermove",L._delayedDragTouchMoveHandler),L._dragStartTimer=$a(I,X.delay)))},_delayedDragTouchMoveHandler:function(b){b=b.touches?b.touches[0]:b;Nb(Sa(b.clientX-this._lastX),Sa(b.clientY-this._lastY))>=
Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){E&&h(E);clearTimeout(this._dragStartTimer);this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var b=this.el.ownerDocument;y(b,"mouseup",this._disableDelayedDrag);y(b,"touchend",this._disableDelayedDrag);y(b,"touchcancel",this._disableDelayedDrag);y(b,"mousemove",this._delayedDragTouchMoveHandler);y(b,"touchmove",this._delayedDragTouchMoveHandler);
y(b,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(b,n){n=n||("touch"==b.pointerType?b:null);!this.nativeDraggable||n?this.options.supportPointer?v(Z,"pointermove",this._onTouchMove):v(Z,n?"touchmove":"mousemove",this._onTouchMove):(v(E,"dragend",this),v(Y,"dragstart",this._onDragStart));try{Z.selection?J(function(){Z.selection.empty()}):window.getSelection().removeAllRanges()}catch(q){}},_dragStarted:function(b,n){if(ja=!1,Y&&E){this.nativeDraggable&&(v(Z,"dragover",
this._handleAutoScroll),v(Z,"dragover",Eb));var q=this.options;!b&&u(E,q.dragClass,!1);u(E,q.ghostClass,!0);p(E,"transform","");F.active=this;b&&this._appendGhost();x(this,Y,"start",E,Y,Y,ua,void 0,n)}else this._nulling()},_emulateDragOver:function(b){if(ba&&(this._lastX!==ba.clientX||this._lastY!==ba.clientY||b)){this._lastX=ba.clientX;this._lastY=ba.clientY;Hb();for(var n=b=Z.elementFromPoint(ba.clientX,ba.clientY);b&&b.shadowRoot;)n=b=b.shadowRoot.elementFromPoint(ba.clientX,ba.clientY);if(n){do{if(n[fa]&&
n[fa]._onDragOver({clientX:ba.clientX,clientY:ba.clientY,target:b,rootEl:n})&&!this.options.dragoverBubble)break;b=n}while(n=n.parentNode)}E.parentNode[fa]._computeIsAligned(ba);Ib()}},_onTouchMove:function(b,n){if(U){var q=this.options,K=q.fallbackTolerance,I=q.fallbackOffset;q=b.touches?b.touches[0]:b;var L=T&&z(T),P=T&&L&&L.a;L=T&&L&&L.d;var X=fb&&g&&aa(g);P=(q.clientX-U.clientX+I.x)/(P||1)+(X?X[0]-oa[0]:0)/(P||1);I=(q.clientY-U.clientY+I.y)/(L||1)+(X?X[1]-oa[1]:0)/(L||1);I=b.touches?"translate3d("+
P+"px,"+I+"px,0)":"translate("+P+"px,"+I+"px)";if(!F.active&&!ja){if(K&&Mb(Sa(q.clientX-this._lastX),Sa(q.clientY-this._lastY))<K)return;this._onDragStart(b,!0)}!n&&this._handleAutoScroll(q,!0);Fa=!0;ba=q;p(T,"webkitTransform",I);p(T,"mozTransform",I);p(T,"msTransform",I);p(T,"transform",I);b.cancelable&&b.preventDefault()}},_appendGhost:function(){if(!T){var b=this.options.fallbackOnBody?Z.body:Y,n=N(E,!0,b,!fb),q=(p(E),this.options);if(fb){for(g=b;"static"===p(g,"position")&&"none"===p(g,"transform")&&
g!==Z;)g=g.parentNode;if(g!==Z){var K=N(g,!0);n.top-=K.top;n.left-=K.left}g!==Z.body&&g!==Z.documentElement?(g===Z&&(g=Ra()),n.top+=g.scrollTop,n.left+=g.scrollLeft):g=Ra();oa=aa(g)}u(T=E.cloneNode(!0),q.ghostClass,!1);u(T,q.fallbackClass,!0);u(T,q.dragClass,!0);p(T,"box-sizing","border-box");p(T,"margin",0);p(T,"top",n.top);p(T,"left",n.left);p(T,"width",n.width);p(T,"height",n.height);p(T,"opacity","0.8");p(T,"position",fb?"absolute":"fixed");p(T,"zIndex","100000");p(T,"pointerEvents","none");b.appendChild(T)}},
_onDragStart:function(b,n){var q=this,K=b.dataTransfer,I=q.options;(ca=D(E)).draggable=!1;ca.style["will-change"]="";this._hideClone();u(ca,q.options.chosenClass,!1);q._cloneId=J(function(){q.options.removeCloneOnHide||Y.insertBefore(ca,E);x(q,Y,"clone",E)});!n&&u(E,I.dragClass,!0);n?(da=!0,q._loopId=setInterval(q._emulateDragOver,50)):(y(Z,"mouseup",q._onDrop),y(Z,"touchend",q._onDrop),y(Z,"touchcancel",q._onDrop),K&&(K.effectAllowed="move",I.setData&&I.setData.call(q,K,E)),v(Z,"drop",q),p(E,"transform",
"translateZ(0)"));ja=!0;q._dragStartId=J(q._dragStarted.bind(q,n,b));v(Z,"selectstart",q);pb&&p(Z.body,"user-select","none")},_onDragOver:function(b){function n(Ba){return Ba&&(ma?ea._hideClone():ea._showClone(va),ea&&(u(E,sa?sa.options.ghostClass:ea.options.ghostClass,!1),u(E,X.ghostClass,!0)),sa!==va&&va!==F.active?sa=va:va===F.active&&(sa=null),K&&va._animate(K,E),P&&wa&&va._animate(wa,P)),(P===E&&!E.animated||P===L&&!P.animated)&&(la=null),X.dragoverBubble||b.rootEl||P===Z||(va._handleAutoScroll(b),
E.parentNode[fa]._computeIsAligned(b)),!X.dragoverBubble&&b.stopPropagation&&b.stopPropagation(),!0}function q(){x(va,Y,"change",P,L,Y,ua,G(E,X.draggable),b)}var K,I,L=this.el,P=b.target,X=this.options,V=X.group,ea=F.active,ma=Ea===V,pa=X.sort,va=this;if(!nb&&(!Ga||b.rootEl||b.artificialBubble||Fb(L,P))){if(void 0!==b.preventDefault&&b.cancelable&&b.preventDefault(),Fa=!0,P=B(P,X.draggable,L,!0),B(b.target,null,E,!0)||P.animated)return n(!1);if(P!==E&&(da=!1),ea&&!X.disabled&&(ma?pa||(I=!Y.contains(E)):
sa===this||(this.lastPutMode=Ea.checkPull(this,ea,E,b))&&V.checkPut(this,ea,E,b))){V=this._getDirection(b,P);if(K=N(E),I)return this._hideClone(),ka=Y,ta?Y.insertBefore(E,ta):Y.appendChild(E),n(!0);if((I=c(L))&&(Ia=b,xa=V,Ja=N(c(L)),Da="vertical"===xa?Ia.clientY:Ia.clientX,Wa="vertical"===xa?Ia.clientX:Ia.clientY,Za="vertical"===xa?Ja.bottom:Ja.right,ub="vertical"===xa?Ja.left:Ja.top,kb="vertical"===xa?Ja.right:Ja.bottom,!("vertical"===xa?kb+10<Wa||Wa<=kb&&Za<Da&&ub<=Wa:Za<Da&&ub<Wa||Da<=Za&&kb+10<
Wa)||I.animated)){if(P&&P!==E&&P.parentNode===L){var La;Da=0;Wa=P.sortableMouseAligned;Za=E.parentNode!==L;Ia="vertical"===V?"top":"left";Ja=(xa=S(P,"top")||S(E,"top"))?xa.scrollTop:void 0;if(la!==P&&(e=null,La=N(P)[Ia],Q=!1),Ha=P,za=V,Ma=(Qa=E)===E&&t||N(Qa),Na=Ha===E&&t||N(Ha),Aa="vertical"===za?Ma.left:Ma.top,Ca="vertical"===za?Ma.right:Ma.bottom,Ta="vertical"===za?Ma.width:Ma.height,db="vertical"===za?Na.left:Na.top,ib="vertical"===za?Na.right:Na.bottom,jb="vertical"===za?Na.width:Na.height,e=
(Aa===db||Ca===ib||Aa+Ta/2===db+jb/2)&&Wa||Za||xa||X.invertSwap||"insert"===e||"swap"===e?("swap"!==e&&(ia=X.invertSwap||Za),Da=function(Ba,Jb,ab,vb,lb,Kb,Ob){var Oa=N(Jb);Ba="vertical"===ab?Ba.clientY:Ba.clientX;var Xa="vertical"===ab?Oa.height:Oa.width,eb="vertical"===ab?Oa.top:Oa.left;Oa="vertical"===ab?Oa.bottom:Oa.right;var mb=N(E),wb=!1;if(!Kb)if(Ob&&l<Xa*vb)if(!Q&&(1===a?eb+Xa*lb/2<Ba:Ba<Oa-Xa*lb/2)&&(Q=!0),Q)wb=!0;else{if("vertical"===ab?mb.top:mb.left,"vertical"===ab?mb.bottom:mb.right,1===
a?Ba<eb+l:Oa-l<Ba)return-1*a}else if(eb+Xa*(1-vb)/2<Ba&&Ba<Oa-Xa*(1-vb)/2)return w(Jb);return(wb=wb||Kb)&&(Ba<eb+Xa*lb/2||Oa-Xa*lb/2<Ba)?eb+Xa/2<Ba?1:-1:0}(b,P,V,X.swapThreshold,null==X.invertedSwapThreshold?X.swapThreshold:X.invertedSwapThreshold,ia,la===P),"swap"):(Da=w(P),"insert"),0===Da)return n(!1);t=null;a=Da;var wa=N(la=P);Qa=P.nextElementSibling;Ha=!1;za=m(Y,L,E,K,P,wa,b,Ha=1===Da);if(!1!==za)return 1!==za&&-1!==za||(Ha=1===za),nb=!0,$a(d,30),ma?ea._hideClone():ea._showClone(this),Ha&&!Qa?
L.appendChild(E):P.parentNode.insertBefore(E,Ha?Qa:P),xa&&Db(xa,0,Ja-xa.scrollTop),ka=E.parentNode,void 0===La||ia||(l=Sa(La-N(P)[Ia])),q(),n(!0)}}else if(I&&L===b.target&&(P=I),P&&(wa=N(P)),ma?ea._hideClone():ea._showClone(this),!1!==m(Y,L,E,K,P,wa,b,!!P))return L.appendChild(E),ka=L,t=null,q(),n(!0);if(L.contains(E))return n(!1)}var Qa,Ha,za,Ma,Na,Aa,Ca,Ta,db,ib,jb,Ia,xa,Ja,Da,Wa,Za,ub,kb;return Ga&&!b.rootEl&&Gb(L,b,"_onDragOver"),!1}},_animate:function(b,n){var q=this.options.animation;if(q){var K=
N(n);if(n===E&&(t=K),1===b.nodeType&&(b=N(b)),b.left+b.width/2!==K.left+K.width/2||b.top+b.height/2!==K.top+K.height/2){var I=z(this.el),L=I&&I.a;I=I&&I.d;p(n,"transition","none");p(n,"transform","translate3d("+(b.left-K.left)/(L||1)+"px,"+(b.top-K.top)/(I||1)+"px,0)");n.offsetWidth;p(n,"transition","transform "+q+"ms"+(this.options.easing?" "+this.options.easing:""));p(n,"transform","translate3d(0,0,0)")}"number"==typeof n.animated&&clearTimeout(n.animated);n.animated=$a(function(){p(n,"transition",
"");p(n,"transform","");n.animated=!1},q)}},_offUpEvents:function(){var b=this.el.ownerDocument;y(Z,"touchmove",this._onTouchMove);y(Z,"pointermove",this._onTouchMove);y(b,"mouseup",this._onDrop);y(b,"touchend",this._onDrop);y(b,"pointerup",this._onDrop);y(b,"touchcancel",this._onDrop);y(Z,"selectstart",this)},_onDrop:function(b){var n=this.el,q=this.options;Q=ia=W=ja=!1;clearInterval(this._loopId);clearInterval(k);hb();clearTimeout(cb);cb=void 0;clearTimeout(this._dragStartTimer);clearTimeout(this._cloneId);
clearTimeout(this._dragStartId);y(Z,"mousemove",this._onTouchMove);this.nativeDraggable&&(y(Z,"drop",this),y(n,"dragstart",this._onDragStart),y(Z,"dragover",this._handleAutoScroll),y(Z,"dragover",Eb));pb&&p(Z.body,"user-select","");this._offUpEvents();b&&(Fa&&(b.cancelable&&b.preventDefault(),!q.dropBubble&&b.stopPropagation()),T&&T.parentNode&&T.parentNode.removeChild(T),(Y===ka||sa&&"clone"!==sa.lastPutMode)&&ca&&ca.parentNode&&ca.parentNode.removeChild(ca),E&&(this.nativeDraggable&&y(E,"dragend",
this),h(E),E.style["will-change"]="",u(E,sa?sa.options.ghostClass:this.options.ghostClass,!1),u(E,this.options.chosenClass,!1),x(this,Y,"unchoose",E,ka,Y,ua,null,b),Y!==ka?(0<=(na=G(E,q.draggable))&&(x(null,ka,"add",E,ka,Y,ua,na,b),x(this,Y,"remove",E,ka,Y,ua,na,b),x(null,ka,"sort",E,ka,Y,ua,na,b),x(this,Y,"sort",E,ka,Y,ua,na,b)),sa&&sa.save()):E.nextSibling!==ta&&0<=(na=G(E,q.draggable))&&(x(this,Y,"update",E,ka,Y,ua,na,b),x(this,Y,"sort",E,ka,Y,ua,na,b)),F.active&&(null!=na&&-1!==na||(na=ua),x(this,
Y,"end",E,ka,Y,ua,na,b),this.save())));this._nulling()},_nulling:function(){Y=E=ka=T=ta=ca=Ka=Pa=Ua=H.length=k=r=R=U=ba=Fa=na=ua=la=a=t=sa=Ea=F.active=null;gb.forEach(function(b){b.checked=!0});gb.length=0},handleEvent:function(b){switch(b.type){case "drop":case "dragend":this._onDrop(b);break;case "dragenter":case "dragover":E&&(this._onDragOver(b),b.dataTransfer&&(b.dataTransfer.dropEffect="move"),b.cancelable&&b.preventDefault());break;case "selectstart":b.preventDefault()}},toArray:function(){for(var b,
n=[],q=this.el.children,K=0,I=q.length,L=this.options;K<I;K++)if(B(b=q[K],L.draggable,this.el,!1)){var P=n,X=P.push,V;if(!(V=b.getAttribute(L.dataIdAttr))){b=b.tagName+b.className+b.src+b.href+b.textContent;V=b.length;for(var ea=0;V--;)ea+=b.charCodeAt(V);V=ea.toString(36)}X.call(P,V)}return n},sort:function(b){var n={},q=this.el;this.toArray().forEach(function(K,I){I=q.children[I];B(I,this.options.draggable,q,!1)&&(n[K]=I)},this);b.forEach(function(K){n[K]&&(q.removeChild(n[K]),q.appendChild(n[K]))})},
save:function(){var b=this.options.store;b&&b.set&&b.set(this)},closest:function(b,n){return B(b,n||this.options.draggable,this.el,!1)},option:function(b,n){var q=this.options;if(void 0===n)return q[b];q[b]=n;"group"===b&&yb(q)},destroy:function(){var b=this.el;b[fa]=null;y(b,"mousedown",this._onTapStart);y(b,"touchstart",this._onTapStart);y(b,"pointerdown",this._onTapStart);this.nativeDraggable&&(y(b,"dragover",this),y(b,"dragenter",this));Array.prototype.forEach.call(b.querySelectorAll("[draggable]"),
function(n){n.removeAttribute("draggable")});this._onDrop();ha.splice(ha.indexOf(this.el),1);this.el=b=null},_hideClone:function(){ca.cloneHidden||(p(ca,"display","none"),ca.cloneHidden=!0,ca.parentNode&&this.options.removeCloneOnHide&&ca.parentNode.removeChild(ca))},_showClone:function(b){"clone"===b.lastPutMode?ca.cloneHidden&&(Y.contains(E)&&!this.options.group.revertClone?Y.insertBefore(ca,E):ta?Y.insertBefore(ca,ta):Y.appendChild(ca),this.options.group.revertClone&&this._animate(E,ca),p(ca,"display",
""),ca.cloneHidden=!1):this._hideClone()}},v(Z,"touchmove",function(b){(F.active||ja)&&b.cancelable&&b.preventDefault()}),F.utils={on:v,off:y,css:p,find:C,is:function(b,n){return!!B(b,n,b,!1)},extend:O,throttle:A,closest:B,toggleClass:u,clone:D,index:G,nextTick:J,cancelNextTick:function(b){return clearTimeout(b)},detectDirection:xb,getChild:f},F.create=function(b,n){return new F(b,n)},F.version="1.8.4",F})},"widgets/Bookmark/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html",
"dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Bookmark/ItemNode.html":'\x3cdiv class\x3d"jimu-img-node jimu-float-leading clearFix" data-id\x3d"" tabindex\x3d"0" aria-label\x3d"" role\x3d"button"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"nodeBox" class\x3d"node-box verticalCenter no-user-select"\x3e\r\n\t\t\x3cimg data-dojo-attach-point\x3d"thumbnail" class\x3d"thumbnail" src\x3d""\x3e\r\n\t\x3c/div\x3e\r\n\r\n\t\x3cdiv data-dojo-attach-point\x3d"nodeLabel" data-dojo-type\x3d"dijit/form/ValidationTextBox" required\x3d"true" data-dojo-props\x3d"trim:true"\x3e\x3c/div\x3e\r\n\r\n\t\x3cdiv data-dojo-attach-point\x3d"changeImgBtn" class\x3d"change-img-btn oper-btns no-user-select hide" tabindex\x3d"0" role\x3d"button"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"editBtn" class\x3d"edit-btn oper-btns no-user-select" tabindex\x3d"0" role\x3d"button"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"renameBtn" class\x3d"rename-btn oper-btns no-user-select" tabindex\x3d"0" role\x3d"button"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"deleteBtn" class\x3d"delete-btn oper-btns no-user-select" tabindex\x3d"0" role\x3d"button"\x3e\x3c/div\x3e\r\n\r\n\t\x3cdiv data-dojo-attach-point\x3d"dragMasker" class\x3d"drag-masker" tabindex\x3d"-1"\x3e\x3c/div\x3e\x3c!--for different browsers drag behavior--\x3e\r\n\r\n\t\x3cdiv data-dojo-attach-point\x3d"layerInfosIcon" class\x3d"layer-info-icon icons no-user-select hide"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"selectedBtn" class\x3d"selected-btn oper-btns no-user-select hide"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Bookmark/setting/Layout.html":'\x3cdiv class\x3d"layout"\x3e\r\n  \x3cdiv class\x3d"title"\x3e${nls.displayBookmarksAs}\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"content verticalCenter"\x3e\r\n    \x3cdiv type\x3d"checkbox" checked\x3d"false" class\x3d"checkbox"\r\n      data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"layoutCards_checkBox"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"label verticalCenter" data-dojo-attach-point\x3d"layoutCards" title\x3d"${nls.cardsTips}"\x3e\r\n      \x3cdiv class\x3d"layout-btns"\x3e\r\n        \x3cdiv class\x3d"cards"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      ${nls.cards}\r\n      \x3cdiv data-dojo-attach-point\x3d"cardsDefaultSetting" class\x3d"default-setting transparent"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"cards_makeAsDefault" class\x3d"set-default hide" title\x3d"${nls.makeAsDefault}"\x3e${nls.makeAsDefault}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"cards_default" class\x3d"default hide" title\x3d"${nls.default}"\x3e${nls.default}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv type\x3d"checkbox" checked\x3d"false" class\x3d"checkbox"\r\n      data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"layoutList_checkBox"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"label verticalCenter" data-dojo-attach-point\x3d"layoutList" title\x3d"${nls.listTips}"\x3e\r\n      \x3cdiv class\x3d"layout-btns"\x3e\r\n        \x3cdiv class\x3d"list"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      ${nls.list}\r\n      \x3cdiv data-dojo-attach-point\x3d"listDefaultSetting" class\x3d"default-setting transparent"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"list_makeAsDefault" class\x3d"set-default hide" title\x3d"${nls.makeAsDefault}"\x3e${nls.makeAsDefault}\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"list_default" class\x3d"default hide" title\x3d"${nls.default}"\x3e${nls.default}\x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/Search/templates/Search.html":'\x3cdiv role\x3d"presentation" class\x3d"${theme}"\x3e\r\n  \x3cdiv role\x3d"presentation" class\x3d"${css.searchGroup}" data-dojo-attach-point\x3d"containerNode"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"expandNode" class\x3d"${css.searchExpandContainer}"\x3e\r\n      \x3cdiv class\x3d"${css.searchAnimateContainer}"\x3e\r\n        \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchIn}" id\x3d"${id}_menu_button" class\x3d"${css.searchBtn} ${css.searchToggle}" tabindex\x3d"0" data-dojo-attach-point\x3d"sourcesBtnNode"\x3e\r\n          \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchToggleIcon}"\x3e\x3c/span\x3e\x3cspan class\x3d"${css.searchSourceName}" data-dojo-attach-point\x3d"sourceNameNode"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"${css.searchInputGroup}"\x3e\r\n          \x3cform data-dojo-attach-point\x3d"formNode"\x3e\r\n            \x3cinput maxlength\x3d"${maxLength}" autocomplete\x3d"off" type\x3d"text" tabindex\x3d"0" class\x3d"${css.searchInput}" value\x3d"${value}" aria-haspopup\x3d"true" id\x3d"${id}_input" data-dojo-attach-point\x3d"inputNode" role\x3d"textbox"\x3e\r\n          \x3c/form\x3e\r\n          \x3cdiv role\x3d"button" class\x3d"${css.searchClear}" tabindex\x3d"0" data-dojo-attach-point\x3d"clearNode"\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchClearIcon}"\x3e\x3c/span\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchSpinner}"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"suggestionsNode" class\x3d"${css.searchMenu} ${css.suggestionsMenu}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchButtonTitle}" class\x3d"${css.searchBtn} ${css.searchSubmit}" tabindex\x3d"0" data-dojo-attach-point\x3d"submitNode"\x3e\r\n      \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchIcon}"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"${css.searchButtonText}"\x3e${_i18n.widgets.Search.main.searchButtonTitle}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"sourcesNode" class\x3d"${css.searchMenu} ${css.sourcesMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"noResultsMenuNode" class\x3d"${css.searchMenu} ${css.searchNoResultsMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.searchClearFloat}"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"contentNode" class\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem" tabindex\x3d"-1" aria-selected\x3d"false"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/Bookmark/setting/Edit.html":'\x3cdiv class\x3d"edit-page jimu-widget-bookmark"\x3e\r\n  \x3cdiv class\x3d"info"\x3e\r\n    \x3cdiv class\x3d"image"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"imageChooserBase"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"text"\x3e\r\n      \x3cdiv class\x3d"lebel"\x3e\r\n        \x3cspan\x3e${nls.title}\x3c/span\x3e\x3cspan class\x3d"start"\x3e*\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"displayName" required\x3d"true" placeHolder\x3d${nls.title} data-dojo-props\x3d\'style:{width:"100%"}\' class\x3d"title"/\x3e\r\n      \x3cdiv class\x3d"tips"\x3e(${nls.thumbnailHint})\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"options"\x3e\r\n    \x3cdiv class\x3d"tips"\x3e${nls.extent}\x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"extent-chooser" data-dojo-attach-point\x3d"extentChooserNode"\x3e\x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"itmes btns"\x3e\r\n      \x3cdiv class\x3d"" data-dojo-attach-point\x3d"saveLayers"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"layerChooserContainer" class\x3d"layer-chooser-container"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"layerChooser"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Bookmark/setting/Import.html":'\x3cdiv class\x3d"import jimu-widget-bookmark"\x3e\r\n  \x3cdiv class\x3d"import-tips"\x3e${nls.importFromWeb}\x3c/div\x3e\r\n\r\n  \x3cdiv data-dojo-attach-point\x3d"bookmarksInWebmap" class\x3d"bookmarks-in-webmap"\x3e\r\n    \x3cdiv class\x3d"select-all-cb"\x3e\r\n      \x3cdiv type\x3d"checkbox" checked\x3d"false" id\x3d"all" data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"all"\x3e\x3c/div\x3e\r\n      \x3clabel class\x3d"all-label" for\x3d"all"\x3e${nls.selectAll}\x3c/label\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"bookMarkerContainer" class\x3d"bookmarker-container editing"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv data-dojo-attach-point\x3d"noBookmark" class\x3d"no-bookmark"\x3e${nls.noBookmarkInWebMap}\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Bookmark/setting/Sync.html":'\x3cdiv class\x3d"sync"\x3e\r\n  \x3cdiv class\x3d"sync-setting-item"\x3e\r\n    \x3cdiv class\x3d"check" data-dojo-attach-point\x3d"isSyncWebmapNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"marks-table-div web-map" data-dojo-attach-point\x3d"webMapBookMarkerContainer"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"sync-setting-item"\x3e\r\n    \x3cdiv class\x3d"check" data-dojo-attach-point\x3d"isSyncCustomNode"\x3e\x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"customBtns" class\x3d"verticalCenter"\x3e\r\n      \x3c!--\x3cdiv class\x3d"custom-btns" data-dojo-attach-point\x3d"importBtn"\x3e${nls.import}\x3c/div\x3e--\x3e\r\n      \x3cdiv class\x3d"custom-btns create" data-dojo-attach-point\x3d"createNewBtn"\x3e${nls.create}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"marks-table-div custom editing" data-dojo-attach-point\x3d"custombookMarkerContainer"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Bookmark/setting/Setting.html":'\x3cdiv class\x3d"jimu-widget-bookmark"\x3e\r\n  \x3cdiv class\x3d"layout" data-dojo-attach-point\x3d"layoutContainer"\x3e\x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"editable"\x3e\r\n    \x3c!--\x3cdiv class\x3d"title"\x3e${nls.bookmark}\x3c/div\x3e--\x3e\r\n    \x3cdiv class\x3d"check" data-dojo-attach-point\x3d"isEditableNode"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"editable"\x3e\r\n    \x3cdiv class\x3d"check save-layer" data-dojo-attach-point\x3d"isSaveLayers"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"" data-dojo-attach-point\x3d"syncContainer"\x3e\x3c/div\x3e\r\n  \x3c!--\r\n    \x3cdiv class\x3d\'bookmark-add jimu-float-leading jimu-leading-margin2\' data-dojo-attach-event\x3d"onclick: onAddBookmarkClick"\x3e\r\n      \x3cdiv class\x3d"add_mark_image"\x3e\x3c/div\x3e\u200b\r\n      \x3cdiv title\x3d"${nls.add}" class\x3d"add_mark_text"\x3e${nls.add}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    --\x3e\r\n\x3c/div\x3e',
"url:widgets/Bookmark/setting/css/style.css":'.jimu-img-node{font-size: 12px; position: relative; float: left; color: #666; overflow: hidden;}.jimu-img-node .node-box{position: relative; border-radius: 4px; overflow: hidden;}.jimu-img-node img{width: 100%; height: 100%; cursor: pointer;}.jimu-img-node .node-label{height: 30px; text-align: center; overflow: hidden; text-overflow: ellipsis;}.jimu-widget-bookmark .jimu-img-node .dijitTextBoxDisabled{opacity: 1;}.jimu-widget-bookmark .jimu-img-node .dijitTextBox .dijitInputInner {color: #000; opacity: 0.9;}.jimu-widget-bookmark .no-user-select{user-select: none; -moz-user-select: none; -webkit-user-select: none; -ms-user-select: none;}.jimu-widget-bookmark .hide {display: none !important;}.jimu-widget-bookmark .clearFix {*overflow: hidden; *zoom: 1;}.jimu-widget-bookmark .clearFix:after {display: table; content: ""; width: 0; clear: both;}.jimu-widget-bookmark .verticalCenter{display: flex; align-items: center;}.jimu-widget-bookmark .jimu-img-node .node-box{margin: 0 auto; width: 100px; height: 60px;}.jimu-widget-bookmark .cards .jimu-img-node .drag-masker{width: 100px; height: 60px;}.jimu-widget-bookmark .jimu-img-node .dijitTextBox {border: none; width: 100%; background-color: transparent;}.jimu-widget-bookmark .jimu-img-node .dijitTextBoxDisabled,.jimu-widget-bookmark .jimu-img-node .dijitTextBox .dijitInputField{background-color: transparent; width: 100%; overflow: hidden;}.jimu-widget-bookmark .jimu-img-node .dijitTextBox .dijitInputInner{white-space: nowrap; text-overflow: ellipsis; text-align: center;}.jimu-widget-bookmark .jimu-img-node .dijitTextBoxFocused.dijitFocused{border:none !important; box-shadow: none; background-image: none;}.jimu-widget-bookmark .jimu-img-node .dijitTextBoxFocused.dijitValidationTextBoxFocused{background-image: none;}.jimu-widget-bookmark .jimu-img-node .dijitTextBoxFocused.dijitFocused .dijitInputInner{box-shadow: none; background: rgba(36, 181, 204, 0.2) !important;}.jimu-img-node .oper-btns{display: none; position: absolute; z-index: 10;}.jimu-img-node .icons{position: absolute; width: 20px; height: 20px; z-index: 10; background-color: #FFF;}.list .jimu-img-node .icons{display: none;}.editing .jimu-img-node .thumbnail{}.jimu-img-node .drag-masker{position: absolute; z-index: 5; top: 0; width: 100%; height: 60px; cursor: pointer;}.jimu-img-node .drag-masker:hover{background-color: transparent}.editing .jimu-img-node .oper-btns{width:20px; height:20px; cursor: pointer; background-color: rgba(0,0,0,0.5);}.editing .jimu-img-node .oper-btns:hover{background-color: rgba(0,0,0,0.7);}.editing .jimu-img-node .selected-btn{background: url("../../images/btns/unselected.svg") no-repeat; left:0; top:0;}.editing .jimu-img-node.selected .selected-btn{background: url("../../images/btns/selected.svg") no-repeat;}.jimu-widget-bookmark:not(.mobile) .editing .jimu-img-node .delete-btn{cursor: pointer; top:0;}.jimu-rtl .jimu-widget-bookmark:not(.mobile) .jimu-img-node .delete-btn{right: auto;}.jimu-widget-bookmark:not(.mobile) .editing .jimu-img-node .delete-btn::before{position: absolute; background-image: url("../../images/btns/x.svg"); background-size: 100%; background-repeat: no-repeat; width: 10px; height: 10px; content: ""; left: 50%; top: 50%; transform: translate(-50%, -50%);}.editing .jimu-img-node .edit-btn{right: 0; bottom: 30px;}.jimu-rtl .jimu-img-node .edit-btn{right: auto; left: 0;}.editing .jimu-img-node .edit-btn::before{position: absolute; display: block; background-image: url("images/btns/edit.svg"); background-size: 100%; background-repeat: no-repeat; width: 10px; height: 10px; content: ""; left: 50%; top: 50%; transform: translate(-50%, -50%);}.jimu-widget-bookmark:not(.mobile) .editing .jimu-img-node .rename-btn{display: none; top: 0px; left: 0px;}.jimu-widget-bookmark:not(.mobile) .editing .jimu-img-node .rename-btn::before{position: absolute; display: block; background-image: url("images/btns/edit.svg"); background-size: 100%; background-repeat: no-repeat; width: 10px; height: 10px; content: ""; left: 50%; top: 50%; transform: translate(-50%, -50%);}.editing .jimu-img-node .change-img-btn{right: calc((100% - 100px)/2); bottom: 30px;}.jimu-rtl .jimu-img-node .change-img-btn{right: auto; left: calc((100% - 100px)/2);}.editing .jimu-img-node .change-img-btn::before{position: absolute; background-image: url("../../images/btns/change.svg"); background-size: 100%; background-repeat: no-repeat; width: 10px; height: 10px; content: ""; left: 50%; top: 50%; transform: translate(-50%, -50%);}.jimu-img-node .layer-info-icon{left: calc((100% - 100px)/2); bottom: 30px;}.jimu-rtl .jimu-img-node .layer-info-icon{right: auto; right: calc((100% - 100px)/2);}.jimu-img-node .layer-info-icon::before{position: absolute; background-image: url("../../images/btns/layer_infos.svg"); background-size: 100%; background-repeat: no-repeat; width: 10px; height: 10px; content: ""; left: 50%; top: 50%; transform: translate(-50%, -50%);}.jimu-widget-bookmark .header {display: flex; align-items: center; justify-content: space-between; height: 30px; margin: 2px; margin-bottom: 15px;}.jimu-widget-bookmark .header .editable-btns,.jimu-widget-bookmark .header .common-fun-btns,.jimu-widget-bookmark .header .edit-btns,.jimu-widget-bookmark .header .common-fun-btns .display-mode{display: flex; align-items: center;}.jimu-widget-bookmark .header .common-fun-btns .display-mode {margin: 0 5px;}.jimu-widget-bookmark .header .two-modes .list{background: url("../../images/btns/list.svg") no-repeat;}.jimu-widget-bookmark .header .two-modes .list:hover{background: url("../../images/btns/list_selected.svg") no-repeat;}.jimu-widget-bookmark .header .two-modes .cards{background: url("../../images/btns/cards.svg") no-repeat;}.jimu-widget-bookmark .header .two-modes .cards:hover{background: url("../../images/btns/cards_selected.svg") no-repeat;}.jimu-widget-bookmark .adding .header .add{background: url("../../images/btns/add_selected.svg") no-repeat;}.jimu-widget-bookmark .header .edit{background: url("../../images/btns/edit.svg") no-repeat;}.jimu-widget-bookmark .editing .header .edit{background: url("../../images/btns/edit_selected.svg") no-repeat;}.jimu-widget-bookmark .header .sync-btn{background: url("../../images/btns/sync.svg") no-repeat;}.jimu-widget-bookmark .header .sync-btn.marked{background: url("../../images/btns/sync.svg") no-repeat; background-color: red;}.jimu-widget-bookmark .header .back-to-init{background: url("../../images/btns/backtoinit.svg") no-repeat;}.jimu-widget-bookmark .header .back-to-init.marked{background: url("../../images/btns/backtoinit_selected.svg") no-repeat;}.jimu-widget-bookmark .header .rename{background: url("../../images/btns/rename_selected.svg") no-repeat;}.jimu-widget-bookmark .header .rename.disable{background: url("../../images/btns/rename.svg") no-repeat;}.jimu-widget-bookmark .header .delete{background: url("../../images/btns/delete_selected.svg") no-repeat;}.jimu-widget-bookmark .header .delete.disable{background: url("../../images/btns/delete.svg") no-repeat;}.jimu-widget-bookmark .header .edit-btns{display: none;}.jimu-widget-bookmark .editing .header .edit-btns{display: flex;}.jimu-widget-bookmark .header .common-fun-btns{display: flex;}.jimu-widget-bookmark .editing .header .common-fun-btns{display: none;}.bookmark-notice-popup{font-family: "Avenir Medium"; font-size: 12px;}.bookmark-notice-popup .tips{color: #000000; letter-spacing: 0;}.bookmark-notice-popup .check-box{position: absolute; bottom: 20px;}.bookmark-notice-popup .check-box .jimu-checkbox .label{font-size: 12px; color: #353535; letter-spacing: 0.3px;}.DartTheme .jimu-widget-bookmark .dijitTextBox{border: none !important;}.DartTheme .jimu-widget-bookmark .jimu-img-node .dijitTextBox .dijitInputInner {color: #FFF !important;}.jimu-widget-bookmark-setting {height: 100%;}.jimu-widget-bookmark-setting .layout,.jimu-widget-bookmark-setting .editable{margin-bottom: 15px;}.jimu-widget-bookmark-setting .editable .tips{font-family: "Avenir Light"; font-size: 12px; color: #898989;}.jimu-widget-bookmark-setting .layout .title,.jimu-widget-bookmark-setting .editable .title{margin-bottom: 15px; font-size: 14px; color: #000000;}.jimu-widget-bookmark-setting .editable .save-layer{margin-left: 20px;}.jimu-rtl .jimu-widget-bookmark-setting .editable .save-layer{margin-right: 20px; margin-left: 0;}.jimu-widget-bookmark-setting .layout .content{}.jimu-widget-bookmark-setting .layout .label{margin-right: 40px; cursor: pointer;}.jimu-rtl .jimu-widget-bookmark-setting .layout .label{margin-left: 40px; margin-right: 0;}.jimu-widget-bookmark-setting .transparent{visibility: hidden;}.jimu-widget-bookmark-setting .default-setting{display: flex; align-items: center; justify-content: center; min-width: 100px; height: 20px; margin: 0 5px; cursor: pointer; background-color: #F3F3F3; font-size: 12px; text-align: center;}.jimu-widget-bookmark-setting .default-setting .default{color: #9B9B9B; padding: 2px 6px; cursor: default;}.jimu-widget-bookmark-setting .default-setting .set-default {width: 100%; height: 100%; padding: 0 10px; display: flex; align-items: center; justify-content: center; background-color: #24B5CC; color: #ffffff; cursor: pointer;}.jimu-widget-bookmark-setting .layout .content .checkbox{}.jimu-widget-bookmark-setting .layout .layout-btns{width:30px; height:30px; font-size: 14px; border: 1px solid #E2E2E2; margin:0 10px;}.jimu-widget-bookmark-setting .layout .layout-btns .cards{width: 16px; height: 16px; margin: 6px; background: url(../../images/btns/cards.svg) no-repeat;}.jimu-widget-bookmark-setting .layout .layout-btns .list{width: 16px; height: 16px; margin: 6px; background: url(../../images/btns/list.svg) no-repeat;}.jimu-widget-bookmark-setting .sync .check{margin-bottom: 15px;}.jimu-widget-bookmark-setting .sync label{font-family: "Avenir Medium"; font-size: 12px; color: #000000; letter-spacing: 0.3px;}.jimu-widget-bookmark-setting .sync .custom-btns{font-size: 14px; border: 1px solid #D6D6D6; height: 30px; width: 80px; text-align: center; line-height: 30px; cursor: pointer;}.jimu-widget-bookmark-setting .sync .custom-btns:hover{color: #FFF; background-color: #24B5CC;}.jimu-widget-bookmark-setting .sync .custom-btns.create{margin: 0 20px; margin-bottom: 15px;}.jimu-widget-bookmark-setting .bookmark-list{height: 100%; width: 100%; overflow: auto;}.jimu-widget-bookmark-setting .marks-table-div{width: 100%; height: 100%; overflow-x:hidden; overflow-y:auto; margin: 0 10px;}.jimu-widget-bookmark-setting .marks-table-div.editing{margin-top: 0;}.jimu-widget-bookmark-setting .bookmark-add{position:relative; width:100px; height:60px; padding:3px; text-align:center; color:#999999; font-size:10px; border:1px dotted gray; -webkit-border-radius:5px; -moz-border-radius:5px; -o-border-radius:5px; -ms-border-radius:5px; border-radius:5px; background-size:cover; margin-top: 5px; margin-left: 20px\\9;}.jimu-widget-bookmark-setting .bookmark-add .add_mark_image{display: block; position: absolute; left: 43px; top: 5px; width:14px; height:14px; background-position:center center; background-image:url(images/add_mark.png);}.jimu-widget-bookmark-setting .bookmark-add .add_mark_text{display: block; position: absolute; top: 25px; width: 100%; font-size: 12px; white-space: normal; height: 30px; width: 94px; overflow: hidden; text-overflow: ellipsis;}.jimu-widget-bookmark-setting .bookmark-add:hover{cursor: pointer;}.jimu-widget-bookmark-setting .mark-item-div{position:relative; width:100px; height: 90px; font-size: 10px; margin-top: 5px;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg{position:relative; width:100%; height:60px; line-height:28px; text-align:center; color:#999999; font-size:13px;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-thumbnail{width:100%; height:100%;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg.selected .mark-item-thumbnail{-webkit-box-sizing:content-box; -moz-box-sizing:content-box; -ms-box-sizing:content-box; -o-box-sizing:content-box; box-sizing:content-box;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-detail-icon,.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-delete-icon{display: none; position:absolute; width:20px; height:20px; background-color:rgba(0, 0, 0, 0.3); -webkit-border-radius:3px; -moz-border-radius:3px; -o-border-radius:3px; -ms-border-radius:3px; border-radius:3px; cursor:pointer;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-detail-icon{right:2px; bottom:2px; background-repeat:no-repeat; background-position:center center; background-image:url(images/edit_mark.png);}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-detail-icon:hover,.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-delete-icon:hover{background-color:rgba(0, 0, 0, 0.6);}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg:hover .mark-item-detail-icon,.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg:hover .mark-item-delete-icon{display: block;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-delete-icon{right:2px; top:2px; background-repeat:no-repeat; background-position:center center; background-image:url(images/delete_mark.png);}.jimu-widget-bookmark-setting .mark-item-div .mark-item-title-wapper{width:100%; text-align:center; color:#333333; font-size:12px; margin-bottom: 25px; overflow: hidden; height: 2.7em; line-height: 16px; padding: 0 5px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical;}.jimu-Bookmark-Edit{height: 100%; overflow-y: auto;}.jimu-Bookmark-Edit .setting-table {margin: 5px 20px; border-spacing: 10px; border-collapse: separate;}.jimu-Bookmark-Edit .setting-table .img-chooser{width: 100px; height: 60px;}.jimu-Bookmark-Edit .input-table \x3e tbody \x3e tr \x3e .first{width:auto; text-align: left; padding-right:15px; white-space: nowrap; max-width: 108px; overflow: hidden; text-overflow: ellipsis;}.jimu-Bookmark-Edit .input-table \x3e tbody \x3e tr \x3e .second{width:660px;}.jimu-rtl .jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-delete-icon{right:auto; left: 2px;}.jimu-rtl .jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-detail-icon{right:auto; left: 2px;}.jimu-rtl .jimu-widget-bookmark-setting .bookmark-add{margin-left: auto; margin-right: 20px\\9;}.bookmark-extent-chooser .map{position: relative;}.jimu-widget-bookmark.import {min-height: 300px;}.jimu-widget-bookmark.import .import-tips{font-family: "Avenir Medium"; font-size: 14px; color: #161616;}.jimu-widget-bookmark.import .select-all-cb {margin: 10px 0; display: flex; align-items: center;}.jimu-widget-bookmark.import .all-label {font-size: 12px; color: #000000; letter-spacing: 0.3px; padding: 0 10px;}.jimu-widget-bookmark.import .bookmarker-container{overflow: auto;}.jimu-widget-bookmark.import .no-bookmark{font-size: 12px; color: #000000; letter-spacing: 0.3px; display: flex; min-height: 300px; align-items: center; justify-content: center;}.bookmark-extent-chooser .arcgisSearch{position: absolute; z-index: 1001; right: 5px; top: 5px;}.jimu-rtl .bookmark-extent-chooser .arcgisSearch{right: auto; left: 5px;}.jimu-widget-bookmark-setting .jimu-img-node,.import .jimu-img-node{width: 120px;}.jimu-widget-bookmark-setting .web-map .jimu-img-node .drag-masker{cursor: pointer;}.jimu-widget-bookmark-setting .custom .jimu-img-node .drag-masker{cursor: move;}.jimu-widget-bookmark-setting .jimu-img-node .drag-masker{left: 50%; transform: translate(-50%, 0%);}.jimu-widget-bookmark-setting .jimu-img-node .thumbnail{max-width: 100px; max-height: 60px;}.jimu-widget-bookmark-setting .editing .jimu-img-node .oper-btns{display: none;}.jimu-widget-bookmark-setting .editing .jimu-img-node:hover .oper-btns{display: flex; justify-content: center; align-items: center;}.jimu-widget-bookmark-setting .jimu-img-node .delete-btn{right:calc((100% - 100px)/2); top:0;}.jimu-rtl .jimu-widget-bookmark-setting .jimu-img-node .delete-btn{right: auto; left: calc((100% - 100px)/2);}.jimu-widget-bookmark-setting .jimu-img-node .edit-btn{right: calc((100% - 100px)/2); bottom: 31px;}.jimu-rtl .jimu-widget-bookmark-setting .jimu-img-node .edit-btn{right: auto; left: calc((100% - 100px)/2);}.jimu-widget-bookmark.edit-page {}.jimu-widget-bookmark.edit-page .info{display: flex;}.jimu-widget-bookmark.edit-page .info .image{width: 135px; height: 90px;}.jimu-widget-bookmark.edit-page .info .text{width:400px; margin-left: 10px;}.jimu-rtl .jimu-widget-bookmark.edit-page .info .text{margin-left: auto; margin-right: 10px;}.jimu-widget-bookmark.edit-page .info .text .lebel{font-family: "Avenir Medium"; font-size: 14px; color: #161616;}.jimu-widget-bookmark.edit-page .info .text .start{color: red; padding: 0 10px;}.jimu-widget-bookmark.edit-page .info .text .tips{font-size: 12px; color: #999999;}.jimu-widget-bookmark.edit-page .info .title{margin: 10px 0;}.jimu-widget-bookmark.edit-page .image .jimu-image-chooser{width: 135px; height: 80px;}.jimu-widget-bookmark.edit-page .jimu-image-chooser .hint .display-image{top: auto; left: auto; transform: none; width: 100% !important; height: 100% !important;}.jimu-widget-bookmark.edit-page .options{margin: 20px 0;}.jimu-widget-bookmark.edit-page .options .tips{margin-bottom: 10px;}.jimu-widget-bookmark.edit-page .options .itmes{display: flex; align-items: center; margin-top: 10px; margin-bottom: 10px;}.jimu-widget-bookmark.edit-page .options .itmes.btns{justify-content: space-between;}.jimu-widget-bookmark.edit-page .options .extent-chooser{height: 300px;}.jimu-widget-bookmark.edit-page .options .layer-chooser-container{max-height: 150px; overflow-y: scroll; border: 1px solid #d9dde0;}.jimu-widget-bookmark.edit-page .options .layer-chooser-container .jimu-basic-layer-chooser-from-map-lite {min-height: 24px;}.jimu-widget-bookmark.edit-page .options .layer-chooser-container .jimu-basic-layer-chooser-from-map-lite .tree-root-ul{border:none; -webkit-margin-before: 0; -webkit-margin-after: 0;}.layers-chooser-container .meun-box {position: absolute; z-index: 500; background-color: #fff; border: 1px solid #24B5CC; box-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.50);}.layers-chooser-container .label {font-family: Avenir-Medium; font-size: 12px; color: #898989; letter-spacing: 0.33px;}.layers-chooser-container .label.enable {color: #FFF; background-color: #24B5CC;}.layers-chooser-container .selected {background-color: greenyellow;}',
"*now":function(F){F(['dojo/i18n!*preload*widgets/Bookmark/setting/nls/Setting*["ar","bg","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sk","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare jimu/BaseWidgetSetting dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/on ../utils ./Layout ./Sync jimu/dijit/CheckBox".split(" "),function(F,B,v,y,u,p,z,C,x){return F([B,v],{baseClass:"jimu-widget-bookmark-setting",startup:function(){this.inherited(arguments);this.layout=new z({nls:this.nls,config:this.config},this.layoutContainer);this.layout.startup();"undefined"===typeof this.config.editable&&(this.config.editable=!1);this.isEditableCheckBox=new x({label:this.nls.editable},
this.isEditableNode);this.isEditableCheckBox.startup();this.own(u(this.isEditableCheckBox,"change",y.hitch(this,"_onEditableChange")));this.isSaveLayersCheckBox=new x({label:this.nls.savelayers,checked:!1},this.isSaveLayers);this.isSaveLayersCheckBox.startup();this.sync=new C({nls:this.nls,folderUrl:this.folderUrl,appConfig:this.appConfig,map:this.map,config:this.config},this.syncContainer);this.sync.startup();this.setConfig(this.config)},_onEditableChange:function(m){m?this.isSaveLayersCheckBox.setStatus(!0):
(this.isSaveLayersCheckBox.setValue(!1),this.isSaveLayersCheckBox.setStatus(!1))},setConfig:function(m){this.config=m;this.updateConfigs();this.layout.setConfig(this.config);this.isEditableCheckBox.setValue(m.editable);this.isSaveLayersCheckBox.setValue(m.isSaveLayerVisibility);this._onEditableChange(m.editable);this.sync.setConfig(this.config)},getConfig:function(){var m=this.sync.getConfig();this.config.syncMode=m.syncMode;this.config.layout=this.layout.getConfig();this.config.editable=this.isEditableCheckBox.checked;
this.config.isSaveLayerVisibility=this.isSaveLayersCheckBox.checked;this.config.bookmarks2D=p.stringifyBookmarks(m.bookmarks);this.completeUpdateConfig();return this.config},destroy:function(){this.layout&&this.layout.destroy&&this.layout.destroy();this.sync&&this.layout.destroy&&this.sync.destroy();this.inherited(arguments)},updateConfigs:function(){p.isConfigBefore5_3(this.config)&&p.setDefaultConfigForUpdate(this.config);p.updateBookmarks(this.config.bookmarks2D)},completeUpdateConfig:function(){p.completeUpdateConfig(this.config)}})});